!function i(r,a,o){function s(e,t){if(!a[e]){if(!r[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(l)return l(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=a[e]={exports:{}},r[e][0].call(n.exports,function(t){return s(r[e][1][t]||t)},n,n.exports,i,r,a,o)}return a[e].exports}for(var l="function"==typeof require&&require,t=0;t<o.length;t++)s(o[t]);return s}({1:[function(t,e,n){"use strict";e.exports=function(t,e){var n=new Array(arguments.length-1),a=0,i=2,o=!0;for(;i<arguments.length;)n[a++]=arguments[i++];return new Promise(function(i,r){n[a]=function(t){if(o)if(o=!1,t)r(t);else{for(var e=new Array(arguments.length-1),n=0;n<e.length;)e[n++]=arguments[n];i.apply(null,e)}};try{t.apply(e||null,n)}catch(t){o&&(o=!1,r(t))}})}},{}],2:[function(t,e,n){"use strict";n.length=function(t){var e=t.length;if(!e)return 0;for(var n=0;1<--e%4&&"="===t.charAt(e);)++n;return Math.ceil(3*t.length)/4-n};for(var u=new Array(64),l=new Array(123),i=0;i<64;)l[u[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;n.encode=function(t,e,n){for(var i,r=null,a=[],o=0,s=0;e<n;){var l=t[e++];switch(s){case 0:a[o++]=u[l>>2],i=(3&l)<<4,s=1;break;case 1:a[o++]=u[i|l>>4],i=(15&l)<<2,s=2;break;case 2:a[o++]=u[i|l>>6],a[o++]=u[63&l],s=0}8191<o&&((r=r||[]).push(String.fromCharCode.apply(String,a)),o=0)}return s&&(a[o++]=u[i],a[o++]=61,1===s&&(a[o++]=61)),r?(o&&r.push(String.fromCharCode.apply(String,a.slice(0,o))),r.join("")):String.fromCharCode.apply(String,a.slice(0,o))};var c="invalid encoding";n.decode=function(t,e,n){for(var i,r=n,a=0,o=0;o<t.length;){var s=t.charCodeAt(o++);if(61===s&&1<a)break;if(void 0===(s=l[s]))throw Error(c);switch(a){case 0:i=s,a=1;break;case 1:e[n++]=i<<2|(48&s)>>4,i=s,a=2;break;case 2:e[n++]=(15&i)<<4|(60&s)>>2,i=s,a=3;break;case 3:e[n++]=(3&i)<<6|s,a=0}}if(1===a)throw Error(c);return n-r},n.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},{}],3:[function(t,e,n){"use strict";function h(e,n){"string"==typeof e&&(n=e,e=void 0);var l=[];function u(t){if("string"!=typeof t){var e=c();if(h.verbose&&console.log("codegen: "+e),e="return "+e,t){for(var n=Object.keys(t),i=new Array(n.length+1),r=new Array(n.length),a=0;a<n.length;)i[a]=n[a],r[a]=t[n[a++]];return i[a]=e,Function.apply(null,i).apply(null,r)}return Function(e)()}for(var o=new Array(arguments.length-1),s=0;s<o.length;)o[s]=arguments[++s];if(s=0,t=t.replace(/%([%dfijs])/g,function(t,e){var n=o[s++];switch(e){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"}),s!==o.length)throw Error("parameter count mismatch");return l.push(t),u}function c(t){return"function "+(t||n||"")+"("+(e&&e.join(",")||"")+"){\n  "+l.join("\n  ")+"\n}"}return u.toString=c,u}(e.exports=h).verbose=!1},{}],4:[function(t,e,n){"use strict";function i(){this._listeners={}}(e.exports=i).prototype.on=function(t,e,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:n||this}),this},i.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===e?n.splice(i,1):++i;return this},i.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<e.length;)e[i].fn.apply(e[i++].ctx,n)}return this}},{}],5:[function(t,e,n){"use strict";e.exports=s;var a=t("@protobufjs/aspromise"),o=t("@protobufjs/inquire")("fs");function s(n,i,r){return i="function"==typeof i?(r=i,{}):i||{},r?!i.xhr&&o&&o.readFile?o.readFile(n,function(t,e){return t&&"undefined"!=typeof XMLHttpRequest?s.xhr(n,i,r):t?r(t):r(null,i.binary?e:e.toString("utf8"))}):s.xhr(n,i,r):a(s,this,n,i)}s.xhr=function(t,n,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(0!==r.status&&200!==r.status)return i(Error("status "+r.status));if(n.binary){if(!(t=r.response))for(var t=[],e=0;e<r.responseText.length;++e)t.push(255&r.responseText.charCodeAt(e));return i(null,"undefined"!=typeof Uint8Array?new Uint8Array(t):t)}return i(null,r.responseText)}},n.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",t),r.send()}},{"@protobufjs/aspromise":1,"@protobufjs/inquire":7}],6:[function(t,e,n){"use strict";function i(t){function e(t,e,n,i){var r=e<0?1:0;0===(e=r?-e:e)?t(0<1/e?0:2147483648,n,i):isNaN(e)?t(2143289344,n,i):t(34028234663852886e22<e?(r<<31|2139095040)>>>0:e<11754943508222875e-54?(r<<31|Math.round(e/1401298464324817e-60))>>>0:(r<<31|(r=Math.floor(Math.log(e)/Math.LN2))+127<<23|8388607&Math.round(e*Math.pow(2,-r)*8388608))>>>0,n,i)}function n(t,e,n){t=t(e,n),e=2*(t>>31)+1,n=t>>>23&255,t&=8388607;return 255==n?t?NaN:1/0*e:0==n?1401298464324817e-60*e*t:e*Math.pow(2,n-150)*(8388608+t)}function i(t,e,n){s[0]=t,e[n]=l[0],e[n+1]=l[1],e[n+2]=l[2],e[n+3]=l[3]}function r(t,e,n){s[0]=t,e[n]=l[3],e[n+1]=l[2],e[n+2]=l[1],e[n+3]=l[0]}function a(t,e){return l[0]=t[e],l[1]=t[e+1],l[2]=t[e+2],l[3]=t[e+3],s[0]}function o(t,e){return l[3]=t[e],l[2]=t[e+1],l[1]=t[e+2],l[0]=t[e+3],s[0]}var s,l,u,c,h;function f(t,e,n,i,r,a){var o,s,l=i<0?1:0;0===(i=l?-i:i)?(t(0,r,a+e),t(0<1/i?0:2147483648,r,a+n)):isNaN(i)?(t(0,r,a+e),t(2146959360,r,a+n)):17976931348623157e292<i?(t(0,r,a+e),t((l<<31|2146435072)>>>0,r,a+n)):i<22250738585072014e-324?(t((o=i/5e-324)>>>0,r,a+e),t((l<<31|o/4294967296)>>>0,r,a+n)):(1024===(s=Math.floor(Math.log(i)/Math.LN2))&&(s=1023),t(4503599627370496*(o=i*Math.pow(2,-s))>>>0,r,a+e),t((l<<31|s+1023<<20|1048576*o&1048575)>>>0,r,a+n))}function d(t,e,n,i,r){e=t(i,r+e),i=t(i,r+n),r=2*(i>>31)+1,n=i>>>20&2047,e=4294967296*(1048575&i)+e;return 2047==n?e?NaN:1/0*r:0==n?5e-324*r*e:r*Math.pow(2,n-1075)*(e+4503599627370496)}function p(t,e,n){u[0]=t,e[n]=c[0],e[n+1]=c[1],e[n+2]=c[2],e[n+3]=c[3],e[n+4]=c[4],e[n+5]=c[5],e[n+6]=c[6],e[n+7]=c[7]}function g(t,e,n){u[0]=t,e[n]=c[7],e[n+1]=c[6],e[n+2]=c[5],e[n+3]=c[4],e[n+4]=c[3],e[n+5]=c[2],e[n+6]=c[1],e[n+7]=c[0]}function m(t,e){return c[0]=t[e],c[1]=t[e+1],c[2]=t[e+2],c[3]=t[e+3],c[4]=t[e+4],c[5]=t[e+5],c[6]=t[e+6],c[7]=t[e+7],u[0]}function v(t,e){return c[7]=t[e],c[6]=t[e+1],c[5]=t[e+2],c[4]=t[e+3],c[3]=t[e+4],c[2]=t[e+5],c[1]=t[e+6],c[0]=t[e+7],u[0]}return"undefined"!=typeof Float32Array?(s=new Float32Array([-0]),l=new Uint8Array(s.buffer),h=128===l[3],t.writeFloatLE=h?i:r,t.writeFloatBE=h?r:i,t.readFloatLE=h?a:o,t.readFloatBE=h?o:a):(t.writeFloatLE=e.bind(null,y),t.writeFloatBE=e.bind(null,b),t.readFloatLE=n.bind(null,_),t.readFloatBE=n.bind(null,x)),"undefined"!=typeof Float64Array?(u=new Float64Array([-0]),c=new Uint8Array(u.buffer),h=128===c[7],t.writeDoubleLE=h?p:g,t.writeDoubleBE=h?g:p,t.readDoubleLE=h?m:v,t.readDoubleBE=h?v:m):(t.writeDoubleLE=f.bind(null,y,0,4),t.writeDoubleBE=f.bind(null,b,4,0),t.readDoubleLE=d.bind(null,_,0,4),t.readDoubleBE=d.bind(null,x,4,0)),t}function y(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}function b(t,e,n){e[n]=t>>>24,e[n+1]=t>>>16&255,e[n+2]=t>>>8&255,e[n+3]=255&t}function _(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function x(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}e.exports=i(i)},{}],7:[function(require,module,exports){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},{}],8:[function(t,e,n){"use strict";var n=n,r=n.isAbsolute=function(t){return/^(?:\/|\w+:)/.test(t)},i=n.normalize=function(t){var e=(t=t.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=r(t),t="";n&&(t=e.shift()+"/");for(var i=0;i<e.length;)".."===e[i]?0<i&&".."!==e[i-1]?e.splice(--i,2):n?e.splice(i,1):++i:"."===e[i]?e.splice(i,1):++i;return t+e.join("/")};n.resolve=function(t,e,n){return n||(e=i(e)),!r(e)&&(t=(t=!n?i(t):t).replace(/(?:\/|^)[^/]+$/,"")).length?i(t+"/"+e):e}},{}],9:[function(t,e,n){"use strict";e.exports=function(e,n,t){var i=t||8192,r=i>>>1,a=null,o=i;return function(t){if(t<1||r<t)return e(t);i<o+t&&(a=e(i),o=0);t=n.call(a,o,o+=t);return 7&o&&(o=1+(7|o)),t}}},{}],10:[function(t,e,n){"use strict";n.length=function(t){for(var e,n=0,i=0;i<t.length;++i)(e=t.charCodeAt(i))<128?n+=1:e<2048?n+=2:55296==(64512&e)&&56320==(64512&t.charCodeAt(i+1))?(++i,n+=4):n+=3;return n},n.read=function(t,e,n){if(n-e<1)return"";for(var i,r=null,a=[],o=0;e<n;)(i=t[e++])<128?a[o++]=i:191<i&&i<224?a[o++]=(31&i)<<6|63&t[e++]:239<i&&i<365?(i=((7&i)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,a[o++]=55296+(i>>10),a[o++]=56320+(1023&i)):a[o++]=(15&i)<<12|(63&t[e++])<<6|63&t[e++],8191<o&&((r=r||[]).push(String.fromCharCode.apply(String,a)),o=0);return r?(o&&r.push(String.fromCharCode.apply(String,a.slice(0,o))),r.join("")):String.fromCharCode.apply(String,a.slice(0,o))},n.write=function(t,e,n){for(var i,r,a=n,o=0;o<t.length;++o)(i=t.charCodeAt(o))<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(55296==(64512&i)&&56320==(64512&(r=t.charCodeAt(o+1)))?(++o,e[n++]=(i=65536+((1023&i)<<10)+(1023&r))>>18|240,e[n++]=i>>12&63|128):e[n++]=i>>12|224,e[n++]=i>>6&63|128),e[n++]=63&i|128);return n-a}},{}],11:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";function s(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}function e(a){var n;return 1===a.length&&(n=a,a=function(t,e){return s(n(t),e)}),{left:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;a(t[r],e)<0?n=1+r:i=r}return n},right:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;0<a(t[r],e)?i=r:n=1+r}return n}}}var n=e(s),g=n.right,i=n.left;function c(t,e){return[t,e]}function u(t){return null===t?NaN:+t}function r(t,e){var n,i,r=t.length,a=0,o=-1,s=0,l=0;if(null==e)for(;++o<r;)isNaN(n=u(t[o]))||(l+=(i=n-s)*(n-(s+=i/++a)));else for(;++o<r;)isNaN(n=u(e(t[o],o,t)))||(l+=(i=n-s)*(n-(s+=i/++a)));if(1<a)return l/(a-1)}function a(t,e){e=r(t,e);return e&&Math.sqrt(e)}function o(t,e){var n,i,r,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n<=n)for(i=r=n;++o<a;)null!=(n=t[o])&&(n<i&&(i=n),r<n&&(r=n))}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n<=n)for(i=r=n;++o<a;)null!=(n=e(t[o],o,t))&&(n<i&&(i=n),r<n&&(r=n));return[i,r]}var n=Array.prototype,l=n.slice,h=n.map;function m(t){return function(){return t}}function v(t){return t}function y(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(r);++i<r;)a[i]=t+i*n;return a}var f=Math.sqrt(50),d=Math.sqrt(10),p=Math.sqrt(2);function b(t,e,n){t=(e-t)/Math.max(0,n),n=Math.floor(Math.log(t)/Math.LN10),t/=Math.pow(10,n);return 0<=n?(f<=t?10:d<=t?5:p<=t?2:1)*Math.pow(10,n):-Math.pow(10,-n)/(f<=t?10:d<=t?5:p<=t?2:1)}function _(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),n=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),i=i/n;return f<=i?n*=10:d<=i?n*=5:p<=i&&(n*=2),e<t?-n:n}function x(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function w(t,e,n){if(null==n&&(n=u),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(1<=e)return+n(t[r-1],r-1,t);var i=(r-1)*e,r=Math.floor(i),e=+n(t[r],r,t);return e+(+n(t[r+1],r+1,t)-e)*(i-r)}}function C(t,e){var n,i,r=t.length,a=-1;if(null==e){for(;++a<r;)if(null!=(n=t[a])&&n<=n)for(i=n;++a<r;)null!=(n=t[a])&&n<i&&(i=n)}else for(;++a<r;)if(null!=(n=e(t[a],a,t))&&n<=n)for(i=n;++a<r;)null!=(n=e(t[a],a,t))&&n<i&&(i=n);return i}function S(t){if(!(r=t.length))return[];for(var e=-1,n=C(t,M),i=new Array(n);++e<n;)for(var r,a=-1,o=i[e]=new Array(r);++a<r;)o[a]=t[a][e];return i}function M(t){return t.length}t.bisect=g,t.bisectRight=g,t.bisectLeft=i,t.ascending=s,t.bisector=e,t.cross=function(t,e,n){var i,r,a,o,s=t.length,l=e.length,u=new Array(s*l);for(null==n&&(n=c),i=a=0;i<s;++i)for(o=t[i],r=0;r<l;++r,++a)u[a]=n(o,e[r]);return u},t.descending=function(t,e){return e<t?-1:t<e?1:t<=e?0:NaN},t.deviation=a,t.extent=o,t.histogram=function(){var f=v,d=o,p=x;function e(t){for(var e,n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=f(t[r],r,t);var a=d(i),o=a[0],s=a[1],l=p(i,o,s);Array.isArray(l)||(l=_(o,s,l),l=y(Math.ceil(o/l)*l,s,l));for(var u=l.length;l[0]<=o;)l.shift(),--u;for(;l[u-1]>s;)l.pop(),--u;var c,h=new Array(u+1);for(r=0;r<=u;++r)(c=h[r]=[]).x0=0<r?l[r-1]:o,c.x1=r<u?l[r]:s;for(r=0;r<n;++r)o<=(e=i[r])&&e<=s&&h[g(l,e,0,u)].push(t[r]);return h}return e.value=function(t){return arguments.length?(f="function"==typeof t?t:m(t),e):f},e.domain=function(t){return arguments.length?(d="function"==typeof t?t:m([t[0],t[1]]),e):d},e.thresholds=function(t){return arguments.length?(p="function"==typeof t?t:Array.isArray(t)?m(l.call(t)):m(t),e):p},e},t.thresholdFreedmanDiaconis=function(t,e,n){return t=h.call(t,u).sort(s),Math.ceil((n-e)/(2*(w(t,.75)-w(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,e,n){return Math.ceil((n-e)/(3.5*a(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=x,t.max=function(t,e){var n,i,r=t.length,a=-1;if(null==e){for(;++a<r;)if(null!=(n=t[a])&&n<=n)for(i=n;++a<r;)null!=(n=t[a])&&i<n&&(i=n)}else for(;++a<r;)if(null!=(n=e(t[a],a,t))&&n<=n)for(i=n;++a<r;)null!=(n=e(t[a],a,t))&&i<n&&(i=n);return i},t.mean=function(t,e){var n,i=t.length,r=i,a=-1,o=0;if(null==e)for(;++a<i;)isNaN(n=u(t[a]))?--r:o+=n;else for(;++a<i;)isNaN(n=u(e(t[a],a,t)))?--r:o+=n;if(r)return o/r},t.median=function(t,e){var n,i=t.length,r=-1,a=[];if(null==e)for(;++r<i;)isNaN(n=u(t[r]))||a.push(n);else for(;++r<i;)isNaN(n=u(e(t[r],r,t)))||a.push(n);return w(a.sort(s),.5)},t.merge=function(t){for(var e,n,i,r=t.length,a=-1,o=0;++a<r;)o+=t[a].length;for(n=new Array(o);0<=--r;)for(e=(i=t[r]).length;0<=--e;)n[--o]=i[e];return n},t.min=C,t.pairs=function(t,e){null==e&&(e=c);for(var n=0,i=t.length-1,r=t[0],a=new Array(i<0?0:i);n<i;)a[n]=e(r,r=t[++n]);return a},t.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},t.quantile=w,t.range=y,t.scan=function(t,e){if(n=t.length){var n,i,r=0,a=0,o=t[a];for(null==e&&(e=s);++r<n;)(e(i=t[r],o)<0||0!==e(o,o))&&(o=i,a=r);return 0===e(o,o)?a:void 0}},t.shuffle=function(t,e,n){for(var i,r,a=(null==n?t.length:n)-(e=null==e?0:+e);a;)r=Math.random()*a--|0,i=t[a+e],t[a+e]=t[r+e],t[r+e]=i;return t},t.sum=function(t,e){var n,i=t.length,r=-1,a=0;if(null==e)for(;++r<i;)(n=+t[r])&&(a+=n);else for(;++r<i;)(n=+e(t[r],r,t))&&(a+=n);return a},t.ticks=function(t,e,n){var i,r,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&0<n)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(o=b(t,e,n))||!isFinite(o))return[];if(0<o)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(r=Math.ceil(e-t+1));++s<r;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(r=Math.ceil(t-e+1));++s<r;)a[s]=(t-s)/o;return i&&a.reverse(),a},t.tickIncrement=b,t.tickStep=_,t.transpose=S,t.variance=r,t.zip=function(){return S(arguments)},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(i.d3=i.d3||{})},{}],12:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";var n=Array.prototype.slice;function S(t){return t}var M=1,k=2,L=3,T=4,D=1e-6;function i(t){return"translate("+(t+.5)+",0)"}function r(t){return"translate(0,"+(t+.5)+")"}function A(e){return function(t){return+e(t)}}function B(e){var n=Math.max(0,e.bandwidth()-1)/2;return e.round()&&(n=Math.round(n)),function(t){return+e(t)+n}}function P(){return!this.__axis}function e(d,p){var g=[],m=null,v=null,y=6,b=6,_=3,x=d===M||d===T?-1:1,w=d===T||d===k?"x":"y",C=d===M||d===L?i:r;function e(t){var e=null==m?p.ticks?p.ticks.apply(p,g):p.domain():m,n=null==v?p.tickFormat?p.tickFormat.apply(p,g):S:v,i=Math.max(y,0)+_,r=p.range(),a=+r[0]+.5,o=+r[r.length-1]+.5,s=(p.bandwidth?B:A)(p.copy()),l=t.selection?t.selection():t,u=l.selectAll(".domain").data([null]),c=(f=l.selectAll(".tick").data(e,p).order()).exit(),h=f.enter().append("g").attr("class","tick"),r=f.select("line"),e=f.select("text"),u=u.merge(u.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),f=f.merge(h),r=r.merge(h.append("line").attr("stroke","currentColor").attr(w+"2",x*y)),e=e.merge(h.append("text").attr("fill","currentColor").attr(w,x*i).attr("dy",d===M?"0em":d===L?"0.71em":"0.32em"));t!==l&&(u=u.transition(t),f=f.transition(t),r=r.transition(t),e=e.transition(t),c=c.transition(t).attr("opacity",D).attr("transform",function(t){return isFinite(t=s(t))?C(t):this.getAttribute("transform")}),h.attr("opacity",D).attr("transform",function(t){var e=this.parentNode.__axis;return C(e&&isFinite(e=e(t))?e:s(t))})),c.remove(),u.attr("d",d===T||d==k?b?"M"+x*b+","+a+"H0.5V"+o+"H"+x*b:"M0.5,"+a+"V"+o:b?"M"+a+","+x*b+"V0.5H"+o+"V"+x*b:"M"+a+",0.5H"+o),f.attr("opacity",1).attr("transform",function(t){return C(s(t))}),r.attr(w+"2",x*y),e.attr(w,x*i).text(n),l.filter(P).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",d===k?"start":d===T?"end":"middle"),l.each(function(){this.__axis=s})}return e.scale=function(t){return arguments.length?(p=t,e):p},e.ticks=function(){return g=n.call(arguments),e},e.tickArguments=function(t){return arguments.length?(g=null==t?[]:n.call(t),e):g.slice()},e.tickValues=function(t){return arguments.length?(m=null==t?null:n.call(t),e):m&&m.slice()},e.tickFormat=function(t){return arguments.length?(v=t,e):v},e.tickSize=function(t){return arguments.length?(y=b=+t,e):y},e.tickSizeInner=function(t){return arguments.length?(y=+t,e):y},e.tickSizeOuter=function(t){return arguments.length?(b=+t,e):b},e.tickPadding=function(t){return arguments.length?(_=+t,e):_},e}t.axisTop=function(t){return e(M,t)},t.axisRight=function(t){return e(k,t)},t.axisBottom=function(t){return e(L,t)},t.axisLeft=function(t){return e(T,t)},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(i.d3=i.d3||{})},{}],13:[function(t,e,n){var i,r;i=this,r=function(t,h,q,f,G,U){"use strict";function d(t){return function(){return t}}function p(t,e,n){this.target=t,this.type=e,this.selection=n}function $(){G.event.stopImmediatePropagation()}function K(){G.event.preventDefault(),G.event.stopImmediatePropagation()}var Y={name:"drag"},V={name:"space"},X={name:"handle"},J={name:"center"};function e(t){return[+t[0],+t[1]]}function g(t){return[e(t[0]),e(t[1])]}var Z={name:"x",handles:["w","e"].map(m),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Q={name:"y",handles:["n","s"].map(m),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},n={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(m),input:function(t){return null==t?null:g(t)},output:function(t){return t}},tt={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},et={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},nt={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},it={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},rt={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function m(t){return{type:t}}function v(){return!G.event.ctrlKey&&!G.event.button}function y(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function b(){return navigator.maxTouchPoints||"ontouchstart"in this}function at(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function i(j){var N,e=y,R=v,n=b,W=!0,i=h.dispatch("start","brush","end"),r=6;function a(t){var e=t.property("__brush",c).selectAll(".overlay").data([m("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",tt.overlay).merge(e).each(function(){var t=at(this).extent;G.select(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([m("selection")]).enter().append("rect").attr("class","selection").attr("cursor",tt.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");e=t.selectAll(".handle").data(j.handles,function(t){return t.type});e.exit().remove(),e.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return tt[t.type]}),t.each(H).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",s).filter(n).on("touchstart.brush",s).on("touchmove.brush",l).on("touchend.brush touchcancel.brush",u).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function H(){var t=G.select(this),e=at(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-r/2:e[0][0]-r/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-r/2:e[0][1]-r/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+r:r}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+r:r})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function z(t,e,n){return!n&&t.__brush.emitter||new o(t,e)}function o(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function s(){var e,n,i,r,a,o,t,s,l,u,c,h,f,d,p,g,m,v,y,b,_,x,w,C,S,M,k,L,T,D,A,B,P,E;function O(){var t=w(e);!b||_||x||(Math.abs(t[0]-S[0])>Math.abs(t[1]-S[1])?x=!0:_=!0),S=t,y=!0,K(),I()}function I(){var t;switch(m=S[0]-C[0],v=S[1]-C[1],i){case V:case Y:r&&(m=Math.max(l-u,Math.min(f-d,m)),L=u+m,D=d+m),a&&(v=Math.max(c-h,Math.min(p-g,v)),T=h+v,A=g+v);break;case X:r<0?(m=Math.max(l-u,Math.min(f-u,m)),L=u+m,D=d):0<r&&(m=Math.max(l-d,Math.min(f-d,m)),L=u,D=d+m),a<0?(v=Math.max(c-h,Math.min(p-h,v)),T=h+v,A=g):0<a&&(v=Math.max(c-g,Math.min(p-g,v)),T=h,A=g+v);break;case J:r&&(L=Math.max(l,Math.min(f,u-m*r)),D=Math.max(l,Math.min(f,d+m*r))),a&&(T=Math.max(c,Math.min(p,h-v*a)),A=Math.max(c,Math.min(p,g+v*a)))}D<L&&(r*=-1,t=u,u=d,d=t,t=L,L=D,D=t,n in et&&P.attr("cursor",tt[n=et[n]])),A<T&&(a*=-1,t=h,h=g,g=t,t=T,T=A,A=t,n in nt&&P.attr("cursor",tt[n=nt[n]])),o.selection&&(s=o.selection),_&&(L=s[0][0],D=s[1][0]),x&&(T=s[0][1],A=s[1][1]),s[0][0]===L&&s[0][1]===T&&s[1][0]===D&&s[1][1]===A||(o.selection=[[L,T],[D,A]],H.call(e),M.brush())}function F(){if($(),G.event.touches){if(G.event.touches.length)return;N&&clearTimeout(N),N=setTimeout(function(){N=null},500)}else q.dragEnable(G.event.view,y),E.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);var t;B.attr("pointer-events","all"),P.attr("cursor",tt.overlay),o.selection&&(s=o.selection),(t=s)[0][0]!==t[1][0]&&t[0][1]!==t[1][1]||(o.selection=null,H.call(e)),M.end()}N&&!G.event.touches||R.apply(this,arguments)&&(n=G.event.target.__data__.type,i="selection"===(W&&G.event.metaKey?n="overlay":n)?Y:W&&G.event.altKey?J:X,r=j===Q?null:it[n],a=j===Z?null:rt[n],t=(o=at(e=this)).extent,s=o.selection,l=t[0][0],c=t[0][1],f=t[1][0],p=t[1][1],v=m=0,b=r&&a&&W&&G.event.shiftKey,w=G.event.touches?(k=G.event.changedTouches[0].identifier,function(t){return G.touch(t,G.event.touches,k)}):G.mouse,C=w(e),S=C,M=z(e,arguments,!0).beforestart(),"overlay"===n?(s&&(y=!0),o.selection=s=[[u=j===Q?l:C[0],h=j===Z?c:C[1]],[d=j===Q?f:u,g=j===Z?p:h]]):(u=s[0][0],h=s[0][1],d=s[1][0],g=s[1][1]),L=u,T=h,D=d,A=g,B=G.select(e).attr("pointer-events","none"),P=B.selectAll(".overlay").attr("cursor",tt[n]),G.event.touches?(M.moved=O,M.ended=F):(E=G.select(G.event.view).on("mousemove.brush",O,!0).on("mouseup.brush",F,!0),W&&E.on("keydown.brush",function(){switch(G.event.keyCode){case 16:b=r&&a;break;case 18:i===X&&(r&&(d=D-m*r,u=L+m*r),a&&(g=A-v*a,h=T+v*a),i=J,I());break;case 32:i!==X&&i!==J||(r<0?d=D-m:0<r&&(u=L-m),a<0?g=A-v:0<a&&(h=T-v),i=V,P.attr("cursor",tt.selection),I());break;default:return}K()},!0).on("keyup.brush",function(){switch(G.event.keyCode){case 16:b&&(_=x=b=!1,I());break;case 18:i===J&&(r<0?d=D:0<r&&(u=L),a<0?g=A:0<a&&(h=T),i=X,I());break;case 32:i===V&&(i=G.event.altKey?(r&&(d=D-m*r,u=L+m*r),a&&(g=A-v*a,h=T+v*a),J):(r<0?d=D:0<r&&(u=L),a<0?g=A:0<a&&(h=T),X),P.attr("cursor",tt[n]),I());break;default:return}K()},!0),q.dragDisable(G.event.view)),$(),U.interrupt(e),H.call(e),M.start())}function l(){z(this,arguments).moved()}function u(){z(this,arguments).ended()}function c(){var t=this.__brush||{selection:null};return t.extent=g(e.apply(this,arguments)),t.dim=j,t}return a.move=function(t,s){t.selection?t.on("start.brush",function(){z(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){z(this,arguments).end()}).tween("brush",function(){var e=this,n=e.__brush,i=z(e,arguments),t=n.selection,r=j.input("function"==typeof s?s.apply(this,arguments):s,n.extent),a=f.interpolate(t,r);function o(t){n.selection=1===t&&null===r?null:a(t),H.call(e),i.brush()}return null!==t&&null!==r?o:o(1)}):t.each(function(){var t=this,e=arguments,n=t.__brush,i=j.input("function"==typeof s?s.apply(t,e):s,n.extent),e=z(t,e).beforestart();U.interrupt(t),n.selection=null===i?null:i,H.call(t),e.start().brush().end()})},a.clear=function(t){a.move(t,null)},o.prototype={beforestart:function(){return 1==++this.active&&((this.state.emitter=this).starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){G.customEvent(new p(a,t,j.output(this.state.selection)),i.apply,i,[t,this.that,this.args])}},a.extent=function(t){return arguments.length?(e="function"==typeof t?t:d(g(t)),a):e},a.filter=function(t){return arguments.length?(R="function"==typeof t?t:d(!!t),a):R},a.touchable=function(t){return arguments.length?(n="function"==typeof t?t:d(!!t),a):n},a.handleSize=function(t){return arguments.length?(r=+t,a):r},a.keyModifiers=function(t){return arguments.length?(W=!!t,a):W},a.on=function(){var t=i.on.apply(i,arguments);return t===i?a:t},a}t.brush=function(){return i(n)},t.brushSelection=function(t){return(t=t.__brush)?t.dim.output(t.selection):null},t.brushX=function(){return i(Z)},t.brushY=function(){return i(Q)},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-dispatch"),t("d3-drag"),t("d3-interpolate"),t("d3-selection"),t("d3-transition")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-drag","d3-interpolate","d3-selection","d3-transition"],r):r((i=i||self).d3=i.d3||{},i.d3,i.d3,i.d3,i.d3,i.d3)},{"d3-dispatch":18,"d3-drag":19,"d3-interpolate":27,"d3-selection":34,"d3-transition":39}],14:[function(t,e,n){var i,r;i=this,r=function(t,M,g){"use strict";var m=Math.cos,v=Math.sin,e=Math.PI,y=e/2,k=2*e,L=Math.max;var b=Array.prototype.slice;function n(t){return function(){return t}}function i(t){return t.source}function r(t){return t.target}function a(t){return t.radius}function o(t){return t.startAngle}function s(t){return t.endAngle}t.chord=function(){var x=0,w=null,C=null,S=null;function e(i){for(var t,e,n,r,a=i.length,o=[],s=M.range(a),l=[],u=[],c=u.groups=new Array(a),h=new Array(a*a),f=0,d=-1;++d<a;){for(t=0,r=-1;++r<a;)t+=i[d][r];o.push(t),l.push(M.range(a)),f+=t}for(w&&s.sort(function(t,e){return w(o[t],o[e])}),C&&l.forEach(function(t,n){t.sort(function(t,e){return C(i[n][t],i[n][e])})}),n=(f=L(0,k-x*a)/f)?x:k/a,t=0,d=-1;++d<a;){for(e=t,r=-1;++r<a;){var p=s[d],g=l[p][r],m=i[p][g],v=t,y=t+=m*f;h[g*a+p]={index:p,subindex:g,startAngle:v,endAngle:y,value:m}}c[p]={index:p,startAngle:e,endAngle:t,value:o[p]},t+=n}for(d=-1;++d<a;)for(r=d-1;++r<a;){var b=h[r*a+d],_=h[d*a+r];(b.value||_.value)&&u.push(b.value<_.value?{source:_,target:b}:{source:b,target:_})}return S?u.sort(S):u}return e.padAngle=function(t){return arguments.length?(x=L(0,t),e):x},e.sortGroups=function(t){return arguments.length?(w=t,e):w},e.sortSubgroups=function(t){return arguments.length?(C=t,e):C},e.sortChords=function(t){return arguments.length?(null==t?S=null:(S=function(t,e){return n(t.source.value+t.target.value,e.source.value+e.target.value)})._=n=t,e):S&&S._;var n},e},t.ribbon=function(){var u=i,c=r,h=a,f=o,d=s,p=null;function e(){var t,e=b.call(arguments),n=u.apply(this,e),i=c.apply(this,e),r=+h.apply(this,(e[0]=n,e)),a=f.apply(this,e)-y,o=d.apply(this,e)-y,s=r*m(a),l=r*v(a),n=+h.apply(this,(e[0]=i,e)),i=f.apply(this,e)-y,e=d.apply(this,e)-y;if((p=p||(t=g.path())).moveTo(s,l),p.arc(0,0,r,a,o),a==i&&o==e||(p.quadraticCurveTo(0,0,n*m(i),n*v(i)),p.arc(0,0,n,i,e)),p.quadraticCurveTo(0,0,s,l),p.closePath(),t)return p=null,t+""||null}return e.radius=function(t){return arguments.length?(h="function"==typeof t?t:n(+t),e):h},e.startAngle=function(t){return arguments.length?(f="function"==typeof t?t:n(+t),e):f},e.endAngle=function(t){return arguments.length?(d="function"==typeof t?t:n(+t),e):d},e.source=function(t){return arguments.length?(u=t,e):u},e.target=function(t){return arguments.length?(c=t,e):c},e.context=function(t){return arguments.length?(p=null==t?null:t,e):p},e},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-array"),t("d3-path")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-path"],r):r(i.d3=i.d3||{},i.d3,i.d3)},{"d3-array":11,"d3-path":28}],15:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";var n="$";function s(){}function m(t,e){var n=new s;if(t instanceof s)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var i,r=-1,a=t.length;if(null==e)for(;++r<a;)n.set(r,t[r]);else for(;++r<a;)n.set(e(i=t[r],r,t),i)}else if(t)for(var o in t)n.set(o,t[o]);return n}function i(){return{}}function r(t,e,n){t[e]=n}function a(){return m()}function l(t,e,n){t.set(e,n)}function o(){}s.prototype=m.prototype={constructor:s,has:function(t){return n+t in this},get:function(t){return this[n+t]},set:function(t,e){return this[n+t]=e,this},remove:function(t){t=n+t;return t in this&&delete this[t]},clear:function(){for(var t in this)t[0]===n&&delete this[t]},keys:function(){var t,e=[];for(t in this)t[0]===n&&e.push(t.slice(1));return e},values:function(){var t,e=[];for(t in this)t[0]===n&&e.push(this[t]);return e},entries:function(){var t,e=[];for(t in this)t[0]===n&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var t,e=0;for(t in this)t[0]===n&&++e;return e},empty:function(){for(var t in this)if(t[0]===n)return!1;return!0},each:function(t){for(var e in this)e[0]===n&&t(this[e],e.slice(1),this)}};var e=m.prototype;function u(t,e){var n=new o;if(t instanceof o)t.each(function(t){n.add(t)});else if(t){var i=-1,r=t.length;if(null==e)for(;++i<r;)n.add(t[i]);else for(;++i<r;)n.add(e(t[i],i,t))}return n}o.prototype=u.prototype={constructor:o,has:e.has,add:function(t){return this[n+(t+="")]=t,this},remove:e.remove,clear:e.clear,values:e.keys,size:e.size,empty:e.empty,each:e.each},t.nest=function(){var f,d,e,p=[],o=[];function g(t,n,i,r){if(n>=p.length)return null!=f&&t.sort(f),null!=d?d(t):t;for(var e,a,o,s=-1,l=t.length,u=p[n++],c=m(),h=i();++s<l;)(o=c.get(e=u(a=t[s])+""))?o.push(a):c.set(e,[a]);return c.each(function(t,e){r(h,e,g(t,n,i,r))}),h}return e={object:function(t){return g(t,0,i,r)},map:function(t){return g(t,0,a,l)},entries:function(t){return function n(t,i){if(++i>p.length)return t;var r,a=o[i-1];return null!=d&&i>=p.length?r=t.entries():(r=[],t.each(function(t,e){r.push({key:e,values:n(t,i)})})),null!=a?r.sort(function(t,e){return a(t.key,e.key)}):r}(g(t,0,a,l),0)},key:function(t){return p.push(t),e},sortKeys:function(t){return o[p.length-1]=t,e},sortValues:function(t){return f=t,e},rollup:function(t){return d=t,e}}},t.set=u,t.map=m,t.keys=function(t){var e,n=[];for(e in t)n.push(e);return n},t.values=function(t){var e,n=[];for(e in t)n.push(t[e]);return n},t.entries=function(t){var e,n=[];for(e in t)n.push({key:e,value:t[e]});return n},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(i.d3=i.d3||{})},{}],16:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";function e(t,e,n){(t.prototype=e.prototype=n).constructor=t}function n(t,e){var n,i=Object.create(t.prototype);for(n in e)i[n]=e[n];return i}function u(){}var i=1/.7,r="\\s*([+-]?\\d+)\\s*",a="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",o="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",s=/^#([0-9a-f]{3,8})$/,l=new RegExp("^rgb\\("+[r,r,r]+"\\)$"),c=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),h=new RegExp("^rgba\\("+[r,r,r,a]+"\\)$"),f=new RegExp("^rgba\\("+[o,o,o,a]+"\\)$"),d=new RegExp("^hsl\\("+[a,o,o]+"\\)$"),p=new RegExp("^hsla\\("+[a,o,o,a]+"\\)$"),g={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function m(){return this.rgb().formatHex()}function v(){return this.rgb().formatRgb()}function y(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=s.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?b(e):3===n?new C(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?new C(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?new C(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=l.exec(t))?new C(e[1],e[2],e[3],1):(e=c.exec(t))?new C(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=h.exec(t))?_(e[1],e[2],e[3],e[4]):(e=f.exec(t))?_(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=d.exec(t))?L(e[1],e[2]/100,e[3]/100,1):(e=p.exec(t))?L(e[1],e[2]/100,e[3]/100,e[4]):g.hasOwnProperty(t)?b(g[t]):"transparent"===t?new C(NaN,NaN,NaN,0):null}function b(t){return new C(t>>16&255,t>>8&255,255&t,1)}function _(t,e,n,i){return new C(t=i<=0?e=n=NaN:t,e,n,i)}function x(t){return(t=t instanceof u?t:y(t))?new C((t=t.rgb()).r,t.g,t.b,t.opacity):new C}function w(t,e,n,i){return 1===arguments.length?x(t):new C(t,e,n,null==i?1:i)}function C(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function S(){return"#"+k(this.r)+k(this.g)+k(this.b)}function M(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function k(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function L(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||1<=n?t=e=NaN:e<=0&&(t=NaN),new A(t,e,n,i)}function T(t){if(t instanceof A)return new A(t.h,t.s,t.l,t.opacity);if(!(t=!(t instanceof u)?y(t):t))return new A;if(t instanceof A)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,l=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=0<l&&l<1?0:o,new A(o,s,l,t.opacity)}function D(t,e,n,i){return 1===arguments.length?T(t):new A(t,e,n,null==i?1:i)}function A(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function B(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}e(u,y,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:m,formatHex:m,formatHsl:function(){return T(this).formatHsl()},formatRgb:v,toString:v}),e(C,w,n(u,{brighter:function(t){return t=null==t?i:Math.pow(i,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S,formatHex:S,formatRgb:M,toString:M})),e(A,D,n(u,{brighter:function(t){return t=null==t?i:Math.pow(i,t),new A(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new A(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,e=n+(n<.5?n:1-n)*e,n=2*n-e;return new C(B(240<=t?t-240:120+t,n,e),B(t,n,e),B(t<120?240+t:t-120,n,e),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var P=Math.PI/180,E=180/Math.PI,O=.96422,I=1,F=.82521,j=4/29,N=6/29,R=3*N*N,W=N*N*N;function H(t){if(t instanceof q)return new q(t.l,t.a,t.b,t.opacity);if(t instanceof X)return J(t);var e,n,i=K((t=!(t instanceof C)?x(t):t).r),r=K(t.g),a=K(t.b),o=G((.2225045*i+.7168786*r+.0606169*a)/I);return i===r&&r===a?e=n=o:(e=G((.4360747*i+.3850649*r+.1430804*a)/O),n=G((.0139322*i+.0971045*r+.7141733*a)/F)),new q(116*o-16,500*(e-o),200*(o-n),t.opacity)}function z(t,e,n,i){return 1===arguments.length?H(t):new q(t,e,n,null==i?1:i)}function q(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function G(t){return W<t?Math.pow(t,1/3):t/R+j}function U(t){return N<t?t*t*t:R*(t-j)}function $(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function K(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Y(t){if(t instanceof X)return new X(t.h,t.c,t.l,t.opacity);if(0===(t=!(t instanceof q)?H(t):t).a&&0===t.b)return new X(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*E;return new X(e<0?360+e:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function V(t,e,n,i){return 1===arguments.length?Y(t):new X(t,e,n,null==i?1:i)}function X(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function J(t){if(isNaN(t.h))return new q(t.l,0,0,t.opacity);var e=t.h*P;return new q(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}e(q,z,n(u,{brighter:function(t){return new q(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new q(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new C($(3.1338561*(e=O*U(e))-1.6168667*(t=I*U(t))-.4906146*(n=F*U(n))),$(-.9787684*e+1.9161415*t+.033454*n),$(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),e(X,V,n(u,{brighter:function(t){return new X(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new X(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return J(this).rgb()}}));var Z=1.78277,Q=-.29227,tt=-.90649,et=1.97294,nt=et*tt,it=et*Z,rt=Z*Q- -.14861*tt;function at(t,e,n,i){return 1===arguments.length?function(t){if(t instanceof ot)return new ot(t.h,t.s,t.l,t.opacity);var e=(t=!(t instanceof C)?x(t):t).r/255,n=t.g/255,i=t.b/255,r=(rt*i+nt*e-it*n)/(rt+nt-it),i=(et*(n-r)-Q*(e=i-r))/tt,n=Math.sqrt(i*i+e*e)/(et*r*(1-r));return new ot((e=n?Math.atan2(i,e)*E-120:NaN)<0?e+360:e,n,r,t.opacity)}(t):new ot(t,e,n,null==i?1:i)}function ot(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}e(ot,at,n(u,{brighter:function(t){return t=null==t?i:Math.pow(i,t),new ot(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ot(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*P,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),t=Math.sin(t);return new C(255*(e+n*(-.14861*i+Z*t)),255*(e+n*(Q*i+tt*t)),255*(e+et*i*n),this.opacity)}})),t.color=y,t.cubehelix=at,t.gray=function(t,e){return new q(t,0,0,null==e?1:e)},t.hcl=V,t.hsl=D,t.lab=z,t.lch=function(t,e,n,i){return 1===arguments.length?Y(t):new X(n,e,t,null==i?1:i)},t.rgb=w,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],17:[function(t,e,n){var i,r;i=this,r=function(t,y){"use strict";var b=Array.prototype.slice;function s(t,e){return t-e}function _(t){return function(){return t}}function l(t,e){for(var n,i=-1,r=e.length;++i<r;)if(n=function(t,e){for(var n=e[0],i=e[1],r=-1,a=0,o=t.length,s=o-1;a<o;s=a++){var l=t[a],u=l[0],c=l[1],h=t[s],f=h[0],d=h[1];if(function(t,e,n){return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&function(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}(t[t=+(t[0]===e[0])],n[t],e[t])}(l,h,e))return 0;i<c!=i<d&&n<(f-u)*(i-c)/(d-c)+u&&(r=-r)}return r}(t,e[i]))return n;return 0}function i(){}var g=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function x(){var f=1,d=1,r=y.thresholdSturges,a=e;function n(e){var t,n,i=r(e);return(i=Array.isArray(i)?i.slice().sort(s):(t=(n=y.extent(e))[0],n=n[1],i=y.tickStep(t,n,i),y.range(Math.floor(t/i)*i,Math.floor(n/i)*i,i))).map(function(t){return o(e,t)})}function o(e,n){var r=[],i=[];return function(t,e,o){var s,l,n,i,r,a,u=new Array,c=new Array;s=l=-1,i=t[0]>=e,g[i<<1].forEach(h);for(;++s<f-1;)n=i,i=t[s+1]>=e,g[n|i<<1].forEach(h);g[i<<0].forEach(h);for(;++l<d-1;){for(s=-1,i=t[l*f+f]>=e,r=t[l*f]>=e,g[i<<1|r<<2].forEach(h);++s<f-1;)n=i,i=t[l*f+f+s+1]>=e,a=r,r=t[l*f+s+1]>=e,g[n|i<<1|r<<2|a<<3].forEach(h);g[i|r<<3].forEach(h)}s=-1,r=t[l*f]>=e,g[r<<2].forEach(h);for(;++s<f-1;)a=r,r=t[l*f+s+1]>=e,g[r<<2|a<<3].forEach(h);function h(t){var e,n=[t[0][0]+s,t[0][1]+l],i=[t[1][0]+s,t[1][1]+l],r=p(n),a=p(i);(t=c[r])?(e=u[a])?(delete c[t.end],delete u[e.start],t===e?(t.ring.push(i),o(t.ring)):u[t.start]=c[e.end]={start:t.start,end:e.end,ring:t.ring.concat(e.ring)}):(delete c[t.end],t.ring.push(i),c[t.end=a]=t):(t=u[a])?(e=c[r])?(delete u[t.start],delete c[e.end],t===e?(t.ring.push(i),o(t.ring)):u[e.start]=c[t.end]={start:e.start,end:t.end,ring:e.ring.concat(t.ring)}):(delete u[t.start],t.ring.unshift(n),u[t.start=r]=t):u[r]=c[a]={start:r,end:a,ring:[n,i]}}g[r<<3].forEach(h)}(e,n,function(t){a(t,e,n),0<function(t){for(var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return i}(t)?r.push([t]):i.push(t)}),i.forEach(function(t){for(var e,n=0,i=r.length;n<i;++n)if(-1!==l((e=r[n])[0],t))return void e.push(t)}),{type:"MultiPolygon",value:n,coordinates:r}}function p(t){return 2*t[0]+t[1]*(f+1)*4}function e(t,s,l){t.forEach(function(t){var e,n=t[0],i=t[1],r=0|n,a=0|i,o=s[a*f+r];0<n&&n<f&&r===n&&(e=s[a*f+r-1],t[0]=n+(l-e)/(o-e)-.5),0<i&&i<d&&a===i&&(e=s[(a-1)*f+r],t[1]=i+(l-e)/(o-e)-.5)})}return n.contour=o,n.size=function(t){if(!arguments.length)return[f,d];var e=Math.ceil(t[0]),t=Math.ceil(t[1]);if(!(0<e&&0<t))throw new Error("invalid size");return f=e,d=t,n},n.thresholds=function(t){return arguments.length?(r="function"==typeof t?t:Array.isArray(t)?_(b.call(t)):_(t),n):r},n.smooth=function(t){return arguments.length?(a=t?e:i,n):a===e},n}function w(t,e,n){for(var i=t.width,r=t.height,a=1+(n<<1),o=0;o<r;++o)for(var s=0,l=0;s<i+n;++s)s<i&&(l+=t.data[s+o*i]),n<=s&&(a<=s&&(l-=t.data[s-a+o*i]),e.data[s-n+o*i]=l/Math.min(s+1,i-1+a-s,a))}function C(t,e,n){for(var i=t.width,r=t.height,a=1+(n<<1),o=0;o<i;++o)for(var s=0,l=0;s<r+n;++s)s<r&&(l+=t.data[o+s*i]),n<=s&&(a<=s&&(l-=t.data[o+(s-a)*i]),e.data[o+(s-n)*i]=l/Math.min(s+1,r-1+a-s,a))}function S(t){return t[0]}function M(t){return t[1]}function k(){return 1}t.contours=x,t.contourDensity=function(){var o=S,s=M,l=k,n=960,i=500,r=20,u=2,c=3*r,h=n+2*c>>u,f=i+2*c>>u,d=_(20);function e(t){var a=new Float32Array(h*f),e=new Float32Array(h*f);t.forEach(function(t,e,n){var i=+o(t,e,n)+c>>u,r=+s(t,e,n)+c>>u,n=+l(t,e,n);0<=i&&i<h&&0<=r&&r<f&&(a[i+r*h]+=n)}),w({width:h,height:f,data:a},{width:h,height:f,data:e},r>>u),C({width:h,height:f,data:e},{width:h,height:f,data:a},r>>u),w({width:h,height:f,data:a},{width:h,height:f,data:e},r>>u),C({width:h,height:f,data:e},{width:h,height:f,data:a},r>>u),w({width:h,height:f,data:a},{width:h,height:f,data:e},r>>u),C({width:h,height:f,data:e},{width:h,height:f,data:a},r>>u);t=d(a);return Array.isArray(t)||(e=y.max(a),t=y.tickStep(0,e,t),(t=y.range(0,Math.floor(e/t)*t,t)).shift()),x().thresholds(t).size([h,f])(a).map(p)}function p(t){return t.value*=Math.pow(2,-2*u),t.coordinates.forEach(a),t}function a(t){t.forEach(g)}function g(t){t.forEach(m)}function m(t){t[0]=t[0]*Math.pow(2,u)-c,t[1]=t[1]*Math.pow(2,u)-c}function v(){return h=n+2*(c=3*r)>>u,f=i+2*c>>u,e}return e.x=function(t){return arguments.length?(o="function"==typeof t?t:_(+t),e):o},e.y=function(t){return arguments.length?(s="function"==typeof t?t:_(+t),e):s},e.weight=function(t){return arguments.length?(l="function"==typeof t?t:_(+t),e):l},e.size=function(t){if(!arguments.length)return[n,i];var e=Math.ceil(t[0]),t=Math.ceil(t[1]);if(!(0<=e||0<=e))throw new Error("invalid size");return n=e,i=t,v()},e.cellSize=function(t){if(!arguments.length)return 1<<u;if(!(1<=(t=+t)))throw new Error("invalid cell size");return u=Math.floor(Math.log(t)/Math.LN2),v()},e.thresholds=function(t){return arguments.length?(d="function"==typeof t?t:Array.isArray(t)?_(b.call(t)):_(t),e):d},e.bandwidth=function(t){if(!arguments.length)return Math.sqrt(r*(r+1));if(!(0<=(t=+t)))throw new Error("invalid bandwidth");return r=Math.round((Math.sqrt(4*t*t+1)-1)/2),v()},e},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-array")):"function"==typeof define&&define.amd?define(["exports","d3-array"],r):r(i.d3=i.d3||{},i.d3)},{"d3-array":11}],18:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";var a={value:function(){}};function e(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new r(i)}function r(t){this._=t}function l(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=a,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}r.prototype=e.prototype={constructor:r,on:function(t,e){var n,i,r=this._,a=(i=r,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=a[o]).type)r[n]=l(r[n],t.name,e);else if(null==e)for(n in r)r[n]=l(r[n],t.name,null);return this}for(;++o<s;)if((n=(t=a[o]).type)&&(n=function(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}(r[n],t.name)))return n},copy:function(){var t,e={},n=this._;for(t in n)e[t]=n[t].slice();return new r(e)},call:function(t,e){if(0<(n=arguments.length-2))for(var n,i,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(i=this._[t]).length;a<n;++a)i[a].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}},t.dispatch=e,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],19:[function(t,e,n){var i,r;i=this,r=function(t,x,w){"use strict";function C(){w.event.stopImmediatePropagation()}function S(){w.event.preventDefault(),w.event.stopImmediatePropagation()}function M(t){var e=t.document.documentElement,t=w.select(t).on("dragstart.drag",S,!0);"onselectstart"in e?t.on("selectstart.drag",S,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function k(t,e){var n=t.document.documentElement,i=w.select(t).on("dragstart.drag",null);e&&(i.on("click.drag",S,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function L(t){return function(){return t}}function T(t,e,n,i,r,a,o,s,l,u){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=r,this.x=a,this.y=o,this.dx=s,this.dy=l,this._=u}function D(){return!w.event.ctrlKey&&!w.event.button}function A(){return this.parentNode}function B(t){return null==t?{x:w.event.x,y:w.event.y}:t}function P(){return navigator.maxTouchPoints||"ontouchstart"in this}T.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t},t.drag=function(){var n,i,r,a,o=D,s=A,e=B,l=P,p={},g=x.dispatch("start","drag","end"),m=0,u=0;function v(t){t.on("mousedown.drag",c).filter(l).on("touchstart.drag",d).on("touchmove.drag",y).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var t;a||!o.apply(this,arguments)||(t=_("mouse",s.apply(this,arguments),w.mouse,this,arguments))&&(w.select(w.event.view).on("mousemove.drag",h,!0).on("mouseup.drag",f,!0),M(w.event.view),C(),r=!1,n=w.event.clientX,i=w.event.clientY,t("start"))}function h(){var t,e;S(),r||(t=w.event.clientX-n,e=w.event.clientY-i,r=u<t*t+e*e),p.mouse("drag")}function f(){w.select(w.event.view).on("mousemove.drag mouseup.drag",null),k(w.event.view,r),S(),p.mouse("end")}function d(){if(o.apply(this,arguments))for(var t,e=w.event.changedTouches,n=s.apply(this,arguments),i=e.length,r=0;r<i;++r)(t=_(e[r].identifier,n,w.touch,this,arguments))&&(C(),t("start"))}function y(){for(var t,e=w.event.changedTouches,n=e.length,i=0;i<n;++i)(t=p[e[i].identifier])&&(S(),t("drag"))}function b(){var t,e,n=w.event.changedTouches,i=n.length;for(a&&clearTimeout(a),a=setTimeout(function(){a=null},500),t=0;t<i;++t)(e=p[n[t].identifier])&&(C(),e("end"))}function _(r,a,o,s,l){var u,c,h,f=o(a,r),d=g.copy();if(w.customEvent(new T(v,"beforestart",u,r,m,f[0],f[1],0,0,d),function(){return null!=(w.event.subject=u=e.apply(s,l))&&(c=u.x-f[0]||0,h=u.y-f[1]||0,!0)}))return function t(e){var n,i=f;switch(e){case"start":p[r]=t,n=m++;break;case"end":delete p[r],--m;case"drag":f=o(a,r),n=m}w.customEvent(new T(v,e,u,r,n,f[0]+c,f[1]+h,f[0]-i[0],f[1]-i[1],d),d.apply,d,[e,s,l])}}return v.filter=function(t){return arguments.length?(o="function"==typeof t?t:L(!!t),v):o},v.container=function(t){return arguments.length?(s="function"==typeof t?t:L(t),v):s},v.subject=function(t){return arguments.length?(e="function"==typeof t?t:L(t),v):e},v.touchable=function(t){return arguments.length?(l="function"==typeof t?t:L(!!t),v):l},v.on=function(){var t=g.on.apply(g,arguments);return t===g?v:t},v.clickDistance=function(t){return arguments.length?(u=(t=+t)*t,v):Math.sqrt(u)},v},t.dragDisable=M,t.dragEnable=k,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-dispatch"),t("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-selection"],r):r((i=i||self).d3=i.d3||{},i.d3,i.d3)},{"d3-dispatch":18,"d3-selection":34}],20:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";var f={},d={};function l(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function s(t){var n=Object.create(null),i=[];return t.forEach(function(t){for(var e in t)e in n||i.push(n[e]=e)}),i}function o(t,e){var n=t+"",t=n.length;return t<e?new Array(e-t+1).join(0)+n:n}function u(t){var e,n=t.getUTCHours(),i=t.getUTCMinutes(),r=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+o(-e,6):9999<e?"+"+o(e,6):o(e,4))+"-"+o(t.getUTCMonth()+1,2)+"-"+o(t.getUTCDate(),2)+(a?"T"+o(n,2)+":"+o(i,2)+":"+o(r,2)+"."+o(a,3)+"Z":r?"T"+o(n,2)+":"+o(i,2)+":"+o(r,2)+"Z":i||n?"T"+o(n,2)+":"+o(i,2)+"Z":"")}function e(i){var e=new RegExp('["'+i+"\n\r]"),h=i.charCodeAt(0);function n(i,t){var e,n=[],r=i.length,a=0,o=0,s=r<=0,l=!1;function u(){if(s)return d;if(l)return l=!1,f;var t,e,n=a;if(34===i.charCodeAt(n)){for(;a++<r&&34!==i.charCodeAt(a)||34===i.charCodeAt(++a););return(t=a)>=r?s=!0:10===(e=i.charCodeAt(a++))?l=!0:13===e&&(l=!0,10===i.charCodeAt(a)&&++a),i.slice(n+1,t-1).replace(/""/g,'"')}for(;a<r;){if(10===(e=i.charCodeAt(t=a++)))l=!0;else if(13===e)l=!0,10===i.charCodeAt(a)&&++a;else if(e!==h)continue;return i.slice(n,t)}return s=!0,i.slice(n,r)}for(10===i.charCodeAt(r-1)&&--r,13===i.charCodeAt(r-1)&&--r;(e=u())!==d;){for(var c=[];e!==f&&e!==d;)c.push(e),e=u();t&&null==(c=t(c,o++))||n.push(c)}return n}function r(t,n){return t.map(function(e){return n.map(function(t){return o(e[t])}).join(i)})}function a(t){return t.map(o).join(i)}function o(t){return null==t?"":t instanceof Date?u(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,a){var o,s;return(t=n(t,function(t,e){return o?o(t,e-1):(s=t,void(o=a?(i=a,r=l(n=t),function(t,e){return i(r(t),e,n)}):l(t)));var n,i,r})).columns=s||[],t},parseRows:n,format:function(t,e){return[(e=null==e?s(t):e).map(o).join(i)].concat(r(t,e)).join("\n")},formatBody:function(t,e){return r(t,e=null==e?s(t):e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}var n=e(","),i=n.parse,r=n.parseRows,a=n.format,c=n.formatBody,h=n.formatRows,p=n.formatRow,g=n.formatValue,m=e("\t"),v=m.parse,y=m.parseRows,b=m.format,_=m.formatBody,x=m.formatRows,n=m.formatRow,m=m.formatValue;var w=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();t.autoType=function(t){for(var e in t){var n,i,r=t[e].trim();if(r)if("true"===r)r=!0;else if("false"===r)r=!1;else if("NaN"===r)r=NaN;else if(isNaN(n=+r)){if(!(i=r.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;w&&i[4]&&!i[7]&&(r=r.replace(/-/g,"/").replace(/T/," ")),r=new Date(r)}else r=n;else r=null;t[e]=r}return t},t.csvFormat=a,t.csvFormatBody=c,t.csvFormatRow=p,t.csvFormatRows=h,t.csvFormatValue=g,t.csvParse=i,t.csvParseRows=r,t.dsvFormat=e,t.tsvFormat=b,t.tsvFormatBody=_,t.tsvFormatRow=n,t.tsvFormatRows=x,t.tsvFormatValue=m,t.tsvParse=v,t.tsvParseRows=y,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],21:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";function e(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function n(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var i=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),r=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),a=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),o=Math.PI,s=o/2;function l(t){return(1-Math.cos(o*t))/2}function u(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function c(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var h=4/11,f=6/11,d=8/11,p=.75,g=9/11,m=10/11,v=.9375,y=21/22,b=63/64,_=1/h/h;function x(t){return(t=+t)<h?_*t*t:t<d?_*(t-=f)*t+p:t<m?_*(t-=g)*t+v:_*(t-=y)*t+b}var w=1.70158,C=function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(w),S=function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(w),M=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(w),k=2*Math.PI,L=function e(n,i){var r=Math.asin(1/(n=Math.max(1,n)))*(i/=k);function t(t){return n*Math.pow(2,10*--t)*Math.sin((r-t)/i)}return t.amplitude=function(t){return e(t,i*k)},t.period=function(t){return e(n,t)},t}(1,.3),T=function e(n,i){var r=Math.asin(1/(n=Math.max(1,n)))*(i/=k);function t(t){return 1-n*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/i)}return t.amplitude=function(t){return e(t,i*k)},t.period=function(t){return e(n,t)},t}(1,.3),w=function e(n,i){var r=Math.asin(1/(n=Math.max(1,n)))*(i/=k);function t(t){return((t=2*t-1)<0?n*Math.pow(2,10*t)*Math.sin((r-t)/i):2-n*Math.pow(2,-10*t)*Math.sin((r+t)/i))/2}return t.amplitude=function(t){return e(t,i*k)},t.period=function(t){return e(n,t)},t}(1,.3);t.easeBack=M,t.easeBackIn=C,t.easeBackInOut=M,t.easeBackOut=S,t.easeBounce=x,t.easeBounceIn=function(t){return 1-x(1-t)},t.easeBounceInOut=function(t){return((t*=2)<=1?1-x(1-t):x(t-1)+1)/2},t.easeBounceOut=x,t.easeCircle=c,t.easeCircleIn=function(t){return 1-Math.sqrt(1-t*t)},t.easeCircleInOut=c,t.easeCircleOut=function(t){return Math.sqrt(1- --t*t)},t.easeCubic=n,t.easeCubicIn=function(t){return t*t*t},t.easeCubicInOut=n,t.easeCubicOut=function(t){return--t*t*t+1},t.easeElastic=T,t.easeElasticIn=L,t.easeElasticInOut=w,t.easeElasticOut=T,t.easeExp=u,t.easeExpIn=function(t){return Math.pow(2,10*t-10)},t.easeExpInOut=u,t.easeExpOut=function(t){return 1-Math.pow(2,-10*t)},t.easeLinear=function(t){return+t},t.easePoly=a,t.easePolyIn=i,t.easePolyInOut=a,t.easePolyOut=r,t.easeQuad=e,t.easeQuadIn=function(t){return t*t},t.easeQuadInOut=e,t.easeQuadOut=function(t){return t*(2-t)},t.easeSin=l,t.easeSinIn=function(t){return 1-Math.cos(t*s)},t.easeSinInOut=l,t.easeSinOut=function(t){return Math.sin(t*s)},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],22:[function(t,e,n){var i,r;i=this,r=function(t,a){"use strict";function n(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function i(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function r(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function o(t,e){return fetch(t,e).then(r)}function e(i){return function(t,e,n){return 2===arguments.length&&"function"==typeof e&&(n=e,e=void 0),o(t,e).then(function(t){return i(t,n)})}}var s=e(a.csvParse),l=e(a.tsvParse);function u(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.json()}function c(n){return function(t,e){return o(t,e).then(function(t){return(new DOMParser).parseFromString(t,n)})}}var h=c("application/xml"),f=c("text/html"),d=c("image/svg+xml");t.blob=function(t,e){return fetch(t,e).then(n)},t.buffer=function(t,e){return fetch(t,e).then(i)},t.dsv=function(t,e,n,i){3===arguments.length&&"function"==typeof n&&(i=n,n=void 0);var r=a.dsvFormat(t);return o(e,n).then(function(t){return r.parse(t,i)})},t.csv=s,t.tsv=l,t.image=function(r,a){return new Promise(function(t,e){var n,i=new Image;for(n in a)i[n]=a[n];i.onerror=e,i.onload=function(){t(i)},i.src=r})},t.json=function(t,e){return fetch(t,e).then(u)},t.text=o,t.xml=h,t.html=f,t.svg=d,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-dsv")):"function"==typeof define&&define.amd?define(["exports","d3-dsv"],r):r(i.d3=i.d3||{},i.d3)},{"d3-dsv":20}],23:[function(t,e,n){var i,r;i=this,r=function(t,g,m,p,v){"use strict";function y(t){return function(){return t}}function b(){return 1e-6*(Math.random()-.5)}function _(t){return t.x+t.vx}function x(t){return t.y+t.vy}function w(t){return t.index}function C(t,e){t=t.get(e);if(!t)throw new Error("missing: "+e);return t}function s(t){return t.x}function S(t){return t.y}var M=Math.PI*(3-Math.sqrt(5));t.forceCenter=function(a,o){var s;function e(){for(var t,e=s.length,n=0,i=0,r=0;r<e;++r)n+=(t=s[r]).x,i+=t.y;for(n=n/e-a,i=i/e-o,r=0;r<e;++r)(t=s[r]).x-=n,t.y-=i}return null==a&&(a=0),null==o&&(o=0),e.initialize=function(t){s=t},e.x=function(t){return arguments.length?(a=+t,e):a},e.y=function(t){return arguments.length?(o=+t,e):o},e},t.forceCollide=function(i){var a,o,f=1,d=1;function e(){for(var t,e,s,l,u,c,h,n=a.length,i=0;i<d;++i)for(e=g.quadtree(a,_,x).visitAfter(p),t=0;t<n;++t)s=a[t],c=o[s.index],h=c*c,l=s.x+s.vx,u=s.y+s.vy,e.visit(r);function r(t,e,n,i,r){var a=t.data,o=t.r,t=c+o;if(!a)return l+t<e||i<l-t||u+t<n||r<u-t;a.index>s.index&&((r=(i=l-a.x-a.vx)*i+(n=u-a.y-a.vy)*n)<t*t&&(0===i&&(r+=(i=b())*i),0===n&&(r+=(n=b())*n),r=(t-(r=Math.sqrt(r)))/r*f,s.vx+=(i*=r)*(t=(o*=o)/(h+o)),s.vy+=(n*=r)*t,a.vx-=i*(t=1-t),a.vy-=n*t))}}function p(t){if(t.data)return t.r=o[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function n(){if(a){var t,e,n=a.length;for(o=new Array(n),t=0;t<n;++t)e=a[t],o[e.index]=+i(e,t,a)}}return"function"!=typeof i&&(i=y(null==i?1:+i)),e.initialize=function(t){a=t,n()},e.iterations=function(t){return arguments.length?(d=+t,e):d},e.strength=function(t){return arguments.length?(f=+t,e):f},e.radius=function(t){return arguments.length?(i="function"==typeof t?t:y(+t),n(),e):i},e},t.forceLink=function(u){var c,h,a,o,f,s=w,n=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},i=y(30),d=1;function e(t){for(var e=0,n=u.length;e<d;++e)for(var i,r,a,o,s,l=0;l<n;++l)i=(s=u[l]).source,a=(r=s.target).x+r.vx-i.x-i.vx||b(),o=r.y+r.vy-i.y-i.vy||b(),a*=s=((s=Math.sqrt(a*a+o*o))-h[l])/s*t*c[l],o*=s,r.vx-=a*(s=f[l]),r.vy-=o*s,i.vx+=a*(s=1-s),i.vy+=o*s}function r(){if(a){var t,e=a.length,n=u.length,i=m.map(a,s),r=0;for(o=new Array(e);r<n;++r)(t=u[r]).index=r,"object"!=typeof t.source&&(t.source=C(i,t.source)),"object"!=typeof t.target&&(t.target=C(i,t.target)),o[t.source.index]=(o[t.source.index]||0)+1,o[t.target.index]=(o[t.target.index]||0)+1;for(r=0,f=new Array(n);r<n;++r)t=u[r],f[r]=o[t.source.index]/(o[t.source.index]+o[t.target.index]);c=new Array(n),l(),h=new Array(n),p()}}function l(){if(a)for(var t=0,e=u.length;t<e;++t)c[t]=+n(u[t],t,u)}function p(){if(a)for(var t=0,e=u.length;t<e;++t)h[t]=+i(u[t],t,u)}return null==u&&(u=[]),e.initialize=function(t){a=t,r()},e.links=function(t){return arguments.length?(u=t,r(),e):u},e.id=function(t){return arguments.length?(s=t,e):s},e.iterations=function(t){return arguments.length?(d=+t,e):d},e.strength=function(t){return arguments.length?(n="function"==typeof t?t:y(+t),l(),e):n},e.distance=function(t){return arguments.length?(i="function"==typeof t?t:y(+t),p(),e):i},e},t.forceManyBody=function(){var r,l,u,c,i=y(-30),h=1,f=1/0,d=.81;function e(t){var e,n=r.length,i=g.quadtree(r,s,S).visitAfter(a);for(u=t,e=0;e<n;++e)l=r[e],i.visit(o)}function n(){if(r){var t,e,n=r.length;for(c=new Array(n),t=0;t<n;++t)e=r[t],c[e.index]=+i(e,t,r)}}function a(t){var e,n,i,r,a,o=0,s=0;if(t.length){for(i=r=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(o+=e.value,s+=n,i+=n*e.x,r+=n*e.y);t.x=i/s,t.y=r/s}else for((e=t).x=e.data.x,e.y=e.data.y;o+=c[e.data.index],e=e.next;);t.value=o}function o(t,e,n,i){if(!t.value)return!0;var r=t.x-l.x,a=t.y-l.y,o=i-e,s=r*r+a*a;if(o*o/d<s)return s<f&&(0===r&&(s+=(r=b())*r),0===a&&(s+=(a=b())*a),s<h&&(s=Math.sqrt(h*s)),l.vx+=r*t.value*u/s,l.vy+=a*t.value*u/s),!0;if(!(t.length||f<=s))for(t.data===l&&!t.next||(0===r&&(s+=(r=b())*r),0===a&&(s+=(a=b())*a),s<h&&(s=Math.sqrt(h*s)));t.data!==l&&(o=c[t.data.index]*u/s,l.vx+=r*o,l.vy+=a*o),t=t.next;);}return e.initialize=function(t){r=t,n()},e.strength=function(t){return arguments.length?(i="function"==typeof t?t:y(+t),n(),e):i},e.distanceMin=function(t){return arguments.length?(h=t*t,e):Math.sqrt(h)},e.distanceMax=function(t){return arguments.length?(f=t*t,e):Math.sqrt(f)},e.theta=function(t){return arguments.length?(d=t*t,e):Math.sqrt(d)},e},t.forceRadial=function(n,s,l){var u,c,h,i=y(.1);function e(t){for(var e=0,n=u.length;e<n;++e){var i=u[e],r=i.x-s||1e-6,a=i.y-l||1e-6,o=Math.sqrt(r*r+a*a),o=(h[e]-o)*c[e]*t/o;i.vx+=r*o,i.vy+=a*o}}function r(){if(u){var t,e=u.length;for(c=new Array(e),h=new Array(e),t=0;t<e;++t)h[t]=+n(u[t],t,u),c[t]=isNaN(h[t])?0:+i(u[t],t,u)}}return"function"!=typeof n&&(n=y(+n)),null==s&&(s=0),null==l&&(l=0),e.initialize=function(t){u=t,r()},e.strength=function(t){return arguments.length?(i="function"==typeof t?t:y(+t),r(),e):i},e.radius=function(t){return arguments.length?(n="function"==typeof t?t:y(+t),r(),e):n},e.x=function(t){return arguments.length?(s=+t,e):s},e.y=function(t){return arguments.length?(l=+t,e):l},e},t.forceSimulation=function(l){var a,o=1,e=.001,s=1-Math.pow(e,1/300),u=0,c=.6,h=m.map(),t=v.timer(i),n=p.dispatch("tick","end");function i(){r(),n.call("tick",a),o<e&&(t.stop(),n.call("end",a))}function r(t){var e,n,i=l.length;void 0===t&&(t=1);for(var r=0;r<t;++r)for(o+=(u-o)*s,h.each(function(t){t(o)}),e=0;e<i;++e)null==(n=l[e]).fx?n.x+=n.vx*=c:(n.x=n.fx,n.vx=0),null==n.fy?n.y+=n.vy*=c:(n.y=n.fy,n.vy=0);return a}function f(){for(var t,e,n,i=0,r=l.length;i<r;++i)(n=l[i]).index=i,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),(isNaN(n.x)||isNaN(n.y))&&(t=10*Math.sqrt(i),e=i*M,n.x=t*Math.cos(e),n.y=t*Math.sin(e)),(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}function d(t){return t.initialize&&t.initialize(l),t}return null==l&&(l=[]),f(),a={tick:r,restart:function(){return t.restart(i),a},stop:function(){return t.stop(),a},nodes:function(t){return arguments.length?(l=t,f(),h.each(d),a):l},alpha:function(t){return arguments.length?(o=+t,a):o},alphaMin:function(t){return arguments.length?(e=+t,a):e},alphaDecay:function(t){return arguments.length?(s=+t,a):+s},alphaTarget:function(t){return arguments.length?(u=+t,a):u},velocityDecay:function(t){return arguments.length?(c=1-t,a):1-c},force:function(t,e){return 1<arguments.length?(null==e?h.remove(t):h.set(t,d(e)),a):h.get(t)},find:function(t,e,n){var i,r,a,o=0,s=l.length;for(null==n?n=1/0:n*=n,o=0;o<s;++o)(i=(i=t-(r=l[o]).x)*i+(i=e-r.y)*i)<n&&(a=r,n=i);return a},on:function(t,e){return 1<arguments.length?(n.on(t,e),a):n.on(t)}}},t.forceX=function(n){var r,a,o,i=y(.1);function e(t){for(var e,n=0,i=r.length;n<i;++n)(e=r[n]).vx+=(o[n]-e.x)*a[n]*t}function s(){if(r){var t,e=r.length;for(a=new Array(e),o=new Array(e),t=0;t<e;++t)a[t]=isNaN(o[t]=+n(r[t],t,r))?0:+i(r[t],t,r)}}return"function"!=typeof n&&(n=y(null==n?0:+n)),e.initialize=function(t){r=t,s()},e.strength=function(t){return arguments.length?(i="function"==typeof t?t:y(+t),s(),e):i},e.x=function(t){return arguments.length?(n="function"==typeof t?t:y(+t),s(),e):n},e},t.forceY=function(n){var r,a,o,i=y(.1);function e(t){for(var e,n=0,i=r.length;n<i;++n)(e=r[n]).vy+=(o[n]-e.y)*a[n]*t}function s(){if(r){var t,e=r.length;for(a=new Array(e),o=new Array(e),t=0;t<e;++t)a[t]=isNaN(o[t]=+n(r[t],t,r))?0:+i(r[t],t,r)}}return"function"!=typeof n&&(n=y(null==n?0:+n)),e.initialize=function(t){r=t,s()},e.strength=function(t){return arguments.length?(i="function"==typeof t?t:y(+t),s(),e):i},e.y=function(t){return arguments.length?(n="function"==typeof t?t:y(+t),s(),e):n},e},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-quadtree"),t("d3-collection"),t("d3-dispatch"),t("d3-timer")):"function"==typeof define&&define.amd?define(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],r):r(i.d3=i.d3||{},i.d3,i.d3,i.d3,i.d3)},{"d3-collection":15,"d3-dispatch":18,"d3-quadtree":30,"d3-timer":38}],24:[function(t,e,n){var i,r;i=this,r=function(e){"use strict";function a(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,e=t.slice(0,n);return[1<e.length?e[0]+e.slice(2):e,+t.slice(n+1)]}function u(t){return(t=a(Math.abs(t)))?t[1]:NaN}var L,n=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function T(t){if(!(e=n.exec(t)))throw new Error("invalid format: "+t);var e;return new i({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function i(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function r(t,e){e=a(t,e);if(!e)return t+"";t=e[0],e=e[1];return e<0?"0."+new Array(-e).join("0")+t:t.length>e+1?t.slice(0,e+1)+"."+t.slice(e+1):t+new Array(e-t.length+2).join("0")}T.prototype=i.prototype,i.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var D={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return r(100*t,e)},r:r,s:function(t,e){if(!(i=a(t,e)))return t+"";var n=i[0],i=(r=i[1])-(L=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,r=n.length;return i===r?n:r<i?n+new Array(i-r+1).join("0"):0<i?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+a(t,Math.max(0,e+i-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function c(t){return t}var o,h=Array.prototype.map,A=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function s(t){var e,s,l,w=void 0===t.grouping||void 0===t.thousands?c:(s=h.call(t.grouping,Number),l=t.thousands+"",function(t,e){for(var n=t.length,i=[],r=0,a=s[0],o=0;0<n&&0<a&&(e<o+a+1&&(a=Math.max(1,e-o)),i.push(t.substring(n-=a,n+a)),!((o+=a+1)>e));)a=s[r=(r+1)%s.length];return i.reverse().join(l)}),i=void 0===t.currency?"":t.currency[0]+"",r=void 0===t.currency?"":t.currency[1]+"",C=void 0===t.decimal?".":t.decimal+"",S=void 0===t.numerals?c:(e=h.call(t.numerals,String),function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}),a=void 0===t.percent?"%":t.percent+"",M=void 0===t.minus?"-":t.minus+"",k=void 0===t.nan?"NaN":t.nan+"";function o(t){var u=(t=T(t)).fill,c=t.align,h=t.sign,e=t.symbol,f=t.zero,d=t.width,p=t.comma,g=t.precision,m=t.trim,v=t.type;"n"===v?(p=!0,v="g"):D[v]||(void 0===g&&(g=12),m=!0,v="g"),(f||"0"===u&&"="===c)&&(f=!0,u="0",c="=");var y="$"===e?i:"#"===e&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",b="$"===e?r:/[%p]/.test(v)?a:"",_=D[v],x=/[defgprs%]/.test(v);function n(t){var e,n,i,r=y,a=b;if("c"===v)a=_(t)+a,t="";else{var o=(t=+t)<0;if(t=isNaN(t)?k:_(Math.abs(t),g),m&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;0<r&&(r=0)}return 0<r?t.slice(0,r)+t.slice(e+1):t}(t)),r=((o=o&&0==+t?!1:o)?"("===h?h:M:"-"===h||"("===h?"":h)+r,a=("s"===v?A[8+L/3]:"")+a+(o&&"("===h?")":""),x)for(e=-1,n=t.length;++e<n;)if((i=t.charCodeAt(e))<48||57<i){a=(46===i?C+t.slice(e+1):t.slice(e))+a,t=t.slice(0,e);break}}p&&!f&&(t=w(t,1/0));var s=r.length+t.length+a.length,l=s<d?new Array(d-s+1).join(u):"";switch(p&&f&&(t=w(l+t,l.length?d-a.length:1/0),l=""),c){case"<":t=r+t+a+l;break;case"=":t=r+l+t+a;break;case"^":t=l.slice(0,s=l.length>>1)+r+t+a+l.slice(s);break;default:t=l+r+t+a}return S(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),n.toString=function(){return t+""},n}return{format:o,formatPrefix:function(t,e){var n=o(((t=T(t)).type="f",t)),e=3*Math.max(-8,Math.min(8,Math.floor(u(e)/3))),i=Math.pow(10,-e),r=A[8+e/3];return function(t){return n(i*t)+r}}}}function t(t){return o=s(t),e.format=o.format,e.formatPrefix=o.formatPrefix,o}t({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),e.FormatSpecifier=i,e.formatDefaultLocale=t,e.formatLocale=s,e.formatSpecifier=T,e.precisionFixed=function(t){return Math.max(0,-u(Math.abs(t)))},e.precisionPrefix=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(u(e)/3)))-u(Math.abs(t)))},e.precisionRound=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,u(e)-u(t))+1},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],25:[function(t,e,n){var i,r;i=this,r=function(t,S){"use strict";function e(){return new n}function n(){this.reset()}n.prototype={constructor:n,reset:function(){this.s=this.t=0},add:function(t){r(i,t,this.t),r(this,i.s,this.s),this.s?this.t+=i.t:this.s=i.t},valueOf:function(){return this.s}};var i=new n;function r(t,e,n){var i=t.s=e+n,r=i-e;t.t=e-(i-r)+(n-r)}var A=1e-6,s=1e-12,k=Math.PI,L=k/2,T=k/4,D=2*k,B=180/k,P=k/180,E=Math.abs,p=Math.atan,O=Math.atan2,I=Math.cos,b=Math.ceil,a=Math.exp,o=Math.log,l=Math.pow,F=Math.sin,u=Math.sign||function(t){return 0<t?1:t<0?-1:0},j=Math.sqrt,c=Math.tan;function h(t){return 1<t?0:t<-1?k:Math.acos(t)}function N(t){return 1<t?L:t<-1?-L:Math.asin(t)}function g(t){return(t=F(t/2))*t}function f(){}function d(t,e){t&&v.hasOwnProperty(t.type)&&v[t.type](t,e)}var m={Feature:function(t,e){d(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)d(n[i].geometry,e)}},v={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){y(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)y(n[i],e,0)},Polygon:function(t,e){_(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)_(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)d(n[i],e)}};function y(t,e,n){var i,r=-1,a=t.length-n;for(e.lineStart();++r<a;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function _(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)y(t[n],e,1);e.polygonEnd()}function x(t,e){t&&m.hasOwnProperty(t.type)?m[t.type](t,e):d(t,e)}var w,C,M,R,W,H=e(),z=e(),q={point:f,lineStart:f,lineEnd:f,polygonStart:function(){H.reset(),q.lineStart=G,q.lineEnd=U},polygonEnd:function(){var t=+H;z.add(t<0?D+t:t),this.lineStart=this.lineEnd=this.point=f},sphere:function(){z.add(D)}};function G(){q.point=$}function U(){K(w,C)}function $(t,e){q.point=K,w=t,C=e,M=t*=P,R=I(e=(e*=P)/2+T),W=F(e)}function K(t,e){var n=(t*=P)-M,i=0<=n?1:-1,r=i*n,a=I(e=(e*=P)/2+T),o=F(e),n=W*o,e=R*a+n*I(r),r=n*i*F(r);H.add(O(r,e)),M=t,R=a,W=o}function Y(t){return[O(t[1],t[0]),N(t[2])]}function V(t){var e=t[0],n=t[1],t=I(n);return[t*I(e),t*F(e),F(n)]}function X(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function J(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Z(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Q(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function tt(t){var e=j(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var et,nt,it,rt,at,ot,st,lt,ut,ct,ht,ft,dt,pt,gt,mt,vt,yt,bt,_t,xt,wt,Ct,St,Mt,kt,Lt=e(),Tt={point:Dt,lineStart:Bt,lineEnd:Pt,polygonStart:function(){Tt.point=Et,Tt.lineStart=Ot,Tt.lineEnd=It,Lt.reset(),q.polygonStart()},polygonEnd:function(){q.polygonEnd(),Tt.point=Dt,Tt.lineStart=Bt,Tt.lineEnd=Pt,H<0?(et=-(it=180),nt=-(rt=90)):A<Lt?rt=90:Lt<-A&&(nt=-90),ct[0]=et,ct[1]=it},sphere:function(){et=-(it=180),nt=-(rt=90)}};function Dt(t,e){ut.push(ct=[et=t,it=t]),e<nt&&(nt=e),rt<e&&(rt=e)}function At(t,e){var n,i,r,a,o,s=V([t*P,e*P]);lt?(r=J(lt,s),tt(n=J([r[1],-r[0],0],r)),r=(n=Y(n))[0]*B*(i=0<(o=t-at)?1:-1),(o=180<E(o))^(i*at<r&&r<i*t)?(a=n[1]*B,rt<a&&(rt=a)):o^(i*at<(r=(r+360)%360-180)&&r<i*t)?(a=-n[1]*B)<nt&&(nt=a):(e<nt&&(nt=e),rt<e&&(rt=e)),o?t<at?Ft(et,t)>Ft(et,it)&&(it=t):Ft(t,it)>Ft(et,it)&&(et=t):et<=it?(t<et&&(et=t),it<t&&(it=t)):at<t?Ft(et,t)>Ft(et,it)&&(it=t):Ft(t,it)>Ft(et,it)&&(et=t)):ut.push(ct=[et=t,it=t]),e<nt&&(nt=e),rt<e&&(rt=e),lt=s,at=t}function Bt(){Tt.point=At}function Pt(){ct[0]=et,ct[1]=it,Tt.point=Dt,lt=null}function Et(t,e){var n;lt?Lt.add(180<E(n=t-at)?n+(0<n?360:-360):n):(ot=t,st=e),q.point(t,e),At(t,e)}function Ot(){q.lineStart()}function It(){Et(ot,st),q.lineEnd(),E(Lt)>A&&(et=-(it=180)),ct[0]=et,ct[1]=it,lt=null}function Ft(t,e){return(e-=t)<0?e+360:e}function jt(t,e){return t[0]-e[0]}function Nt(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var Rt={sphere:f,point:Wt,lineStart:zt,lineEnd:Ut,polygonStart:function(){Rt.lineStart=$t,Rt.lineEnd=Kt},polygonEnd:function(){Rt.lineStart=zt,Rt.lineEnd=Ut}};function Wt(t,e){t*=P;var n=I(e*=P);Ht(n*I(t),n*F(t),F(e))}function Ht(t,e,n){dt+=(t-dt)/++ht,pt+=(e-pt)/ht,gt+=(n-gt)/ht}function zt(){Rt.point=qt}function qt(t,e){t*=P;var n=I(e*=P);St=n*I(t),Mt=n*F(t),kt=F(e),Rt.point=Gt,Ht(St,Mt,kt)}function Gt(t,e){t*=P;var n=I(e*=P),i=n*I(t),n=n*F(t),t=F(e),e=O(j((e=Mt*t-kt*n)*e+(e=kt*i-St*t)*e+(e=St*n-Mt*i)*e),St*i+Mt*n+kt*t);ft+=e,mt+=e*(St+(St=i)),vt+=e*(Mt+(Mt=n)),yt+=e*(kt+(kt=t)),Ht(St,Mt,kt)}function Ut(){Rt.point=Wt}function $t(){Rt.point=Yt}function Kt(){Vt(wt,Ct),Rt.point=Wt}function Yt(t,e){wt=t,Ct=e,t*=P,e*=P,Rt.point=Vt;var n=I(e);St=n*I(t),Mt=n*F(t),kt=F(e),Ht(St,Mt,kt)}function Vt(t,e){t*=P;var n=I(e*=P),i=n*I(t),r=n*F(t),a=F(e),o=Mt*a-kt*r,s=kt*i-St*a,n=St*r-Mt*i,t=j(o*o+s*s+n*n),e=N(t),t=t&&-e/t;bt+=t*o,_t+=t*s,xt+=t*n,ft+=e,mt+=e*(St+(St=i)),vt+=e*(Mt+(Mt=r)),yt+=e*(kt+(kt=a)),Ht(St,Mt,kt)}function Xt(t){return function(){return t}}function Jt(n,i){function t(t,e){return t=n(t,e),i(t[0],t[1])}return n.invert&&i.invert&&(t.invert=function(t,e){return(t=i.invert(t,e))&&n.invert(t[0],t[1])}),t}function Zt(t,e){return[E(t)>k?t+Math.round(-t/D)*D:t,e]}function Qt(t,e,n){return(t%=D)?e||n?Jt(ee(t),ne(e,n)):ee(t):e||n?ne(e,n):Zt}function te(n){return function(t,e){return[k<(t+=n)?t-D:t<-k?t+D:t,e]}}function ee(t){var e=te(t);return e.invert=te(-t),e}function ne(t,e){var r=I(t),a=F(t),o=I(e),s=F(e);function n(t,e){var n=I(e),i=I(t)*n,t=F(t)*n,n=F(e),e=n*r+i*a;return[O(t*o-e*s,i*r-n*a),N(e*o+t*s)]}return n.invert=function(t,e){var n=I(e),i=I(t)*n,t=F(t)*n,n=F(e),e=n*o-t*s;return[O(t*o+n*s,i*r+e*a),N(e*r-i*a)]},n}function ie(e){function t(t){return(t=e(t[0]*P,t[1]*P))[0]*=B,t[1]*=B,t}return e=Qt(e[0]*P,e[1]*P,2<e.length?e[2]*P:0),t.invert=function(t){return(t=e.invert(t[0]*P,t[1]*P))[0]*=B,t[1]*=B,t},t}function re(t,e,n,i,r,a){if(n){var o=I(e),s=F(e),l=i*n;null==r?(r=e+i*D,a=e-l/2):(r=ae(o,r),a=ae(o,a),(0<i?r<a:a<r)&&(r+=i*D));for(var u,c=r;0<i?a<c:c<a;c-=l)u=Y([o,-s*I(c),-s*F(c)]),t.point(u[0],u[1])}}function ae(t,e){(e=V(e))[0]-=t,tt(e);t=h(-e[1]);return((-e[2]<0?-t:t)+D-A)%D}function oe(){var n,e=[];return{point:function(t,e){n.push([t,e])},lineStart:function(){e.push(n=[])},lineEnd:f,rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))},result:function(){var t=e;return e=[],n=null,t}}}function se(t,e){return E(t[0]-e[0])<A&&E(t[1]-e[1])<A}function le(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function ue(t,e,n,i,a){var o,r,s=[],l=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],r=t[e];if(se(i,r)){for(a.lineStart(),o=0;o<e;++o)a.point((i=t[o])[0],i[1]);a.lineEnd()}else s.push(n=new le(i,t,null,!0)),l.push(n.o=new le(i,null,n,!1)),s.push(n=new le(r,t,null,!1)),l.push(n.o=new le(r,null,n,!0))}}),s.length){for(l.sort(e),ce(s),ce(l),o=0,r=l.length;o<r;++o)l[o].e=n=!n;for(var u,c,h=s[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;u=f.z,a.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(o=0,r=u.length;o<r;++o)a.point((c=u[o])[0],c[1]);else i(f.x,f.n.x,1,a);f=f.n}else{if(d)for(u=f.p.z,o=u.length-1;0<=o;--o)a.point((c=u[o])[0],c[1]);else i(f.x,f.p.x,-1,a);f=f.p}}while(u=(f=f.o).z,d=!d,!f.v);a.lineEnd()}}}function ce(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}Zt.invert=Zt;var he=e();function fe(t){return E(t[0])<=k?t[0]:u(t[0])*((E(t[0])+k)%D-k)}function de(t,e){var n=fe(e),i=e[1],e=F(i),r=[F(n),-I(n),0],a=0,o=0;he.reset(),1===e?i=L+A:-1===e&&(i=-L-A);for(var s=0,l=t.length;s<l;++s)if(c=(u=t[s]).length)for(var u,c,h=u[c-1],f=fe(h),d=h[1]/2+T,p=F(d),g=I(d),m=0;m<c;++m,f=y,p=_,g=x,h=v){var v=u[m],y=fe(v),b=v[1]/2+T,_=F(b),x=I(b),w=y-f,C=0<=w?1:-1,S=C*w,M=k<S,b=p*_;he.add(O(b*C*F(S),g*x+b*I(S))),a+=M?w+C*D:w,M^n<=f^n<=y&&(tt(S=J(V(h),V(v))),tt(C=J(r,S)),((C=(M^0<=w?-1:1)*N(C[2]))<i||i===C&&(S[0]||S[1]))&&(o+=M^0<=w?1:-1))}return(a<-A||a<A&&he<-A)^1&o}function pe(m,v,y,b){return function(s){var l,u,c,n=v(s),h=oe(),f=v(h),d=!1,e={point:i,lineStart:r,lineEnd:a,polygonStart:function(){e.point=p,e.lineStart=o,e.lineEnd=g,u=[],l=[]},polygonEnd:function(){e.point=i,e.lineStart=r,e.lineEnd=a,u=S.merge(u);var t=de(l,b);u.length?(d||(s.polygonStart(),d=!0),ue(u,me,t,y,s)):t&&(d||(s.polygonStart(),d=!0),s.lineStart(),y(null,null,1,s),s.lineEnd()),d&&(s.polygonEnd(),d=!1),u=l=null},sphere:function(){s.polygonStart(),s.lineStart(),y(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function i(t,e){m(t,e)&&s.point(t,e)}function t(t,e){n.point(t,e)}function r(){e.point=t,n.lineStart()}function a(){e.point=i,n.lineEnd()}function p(t,e){c.push([t,e]),f.point(t,e)}function o(){f.lineStart(),c=[]}function g(){p(c[0][0],c[0][1]),f.lineEnd();var t,e,n,i,r=f.clean(),a=h.result(),o=a.length;if(c.pop(),l.push(c),c=null,o)if(1&r){if(0<(e=(n=a[0]).length-1)){for(d||(s.polygonStart(),d=!0),s.lineStart(),t=0;t<e;++t)s.point((i=n[t])[0],i[1]);s.lineEnd()}}else 1<o&&2&r&&a.push(a.pop().concat(a.shift())),u.push(a.filter(ge))}return e}}function ge(t){return 1<t.length}function me(t,e){return((t=t.x)[0]<0?t[1]-L-A:L-t[1])-((e=e.x)[0]<0?e[1]-L-A:L-e[1])}var ve=pe(function(){return 1},function(u){var c,h=NaN,f=NaN,d=NaN;return{lineStart:function(){u.lineStart(),c=1},point:function(t,e){var n,i,r,a,o,s=0<t?k:-k,l=E(t-h);E(l-k)<A?(u.point(h,f=0<(f+e)/2?L:-L),u.point(d,f),u.lineEnd(),u.lineStart(),u.point(s,f),u.point(t,f),c=0):d!==s&&k<=l&&(E(h-d)<A&&(h-=d*A),E(t-s)<A&&(t-=s*A),i=f,a=e,o=F((n=h)-(r=t)),f=E(o)>A?p((F(i)*(l=I(a))*F(r)-F(a)*(r=I(i))*F(n))/(r*l*o)):(i+a)/2,u.point(d,f),u.lineEnd(),u.lineStart(),u.point(s,f),c=0),u.point(h=t,f=e),d=s},lineEnd:function(){u.lineEnd(),h=f=NaN},clean:function(){return 2-c}}},function(t,e,n,i){var r;null==t?(r=n*L,i.point(-k,r),i.point(0,r),i.point(k,r),i.point(k,0),i.point(k,-r),i.point(0,-r),i.point(-k,-r),i.point(-k,0),i.point(-k,r)):E(t[0]-e[0])>A?(t=t[0]<e[0]?k:-k,r=n*t/2,i.point(-t,r),i.point(0,r),i.point(t,r)):i.point(e[0],e[1])},[-k,-L]);function ye(r){var d=I(r),a=6*P,f=0<d,p=E(d)>A;function g(t,e){return I(t)*I(e)>d}function m(t,e,n){var i=[1,0,0],r=J(V(t),V(e)),a=X(r,r),o=r[0],s=a-o*o;if(!s)return!n&&t;var l=J(i,r),u=Q(i,d*a/s);Z(u,Q(r,-d*o/s));var c=l,h=X(u,c),i=X(c,c),a=h*h-i*(X(u,u)-1);if(!(a<0)){r=j(a),o=Q(c,(-h-r)/i);if(Z(o,u),o=Y(o),!n)return o;var f,s=t[0],l=e[0],a=t[1],n=e[1];l<s&&(f=s,s=l,l=f);t=l-s,e=E(t-k)<A;if(!e&&n<a&&(f=a,a=n,n=f),e||t<A?e?0<a+n^o[1]<(E(o[0]-s)<A?a:n):a<=o[1]&&o[1]<=n:k<t^(s<=o[0]&&o[0]<=l)){i=Q(c,(-h+r)/i);return Z(i,u),[o,Y(i)]}}}function v(t,e){var n=f?r:k-r,i=0;return t<-n?i|=1:n<t&&(i|=2),e<-n?i|=4:n<e&&(i|=8),i}return pe(g,function(o){var s,l,u,c,h;return{lineStart:function(){c=u=!1,h=1},point:function(t,e){var n,i,r=[t,e],a=g(t,e),e=f?a?0:v(t,e):a?v(t+(t<0?k:-k),e):0;!s&&(c=u=a)&&o.lineStart(),a!==u&&((n=m(s,r))&&!se(s,n)&&!se(r,n)||(r[0]+=A,r[1]+=A,a=g(r[0],r[1]))),a!==u?(h=0,a?(o.lineStart(),n=m(r,s),o.point(n[0],n[1])):(n=m(s,r),o.point(n[0],n[1]),o.lineEnd()),s=n):p&&s&&f^a&&(e&l||!(i=m(r,s,!0))||(h=0,f?(o.lineStart(),o.point(i[0][0],i[0][1]),o.point(i[1][0],i[1][1]),o.lineEnd()):(o.point(i[1][0],i[1][1]),o.lineEnd(),o.lineStart(),o.point(i[0][0],i[0][1])))),!a||s&&se(s,r)||o.point(r[0],r[1]),s=r,u=a,l=e},lineEnd:function(){u&&o.lineEnd(),s=null},clean:function(){return h|(c&&u)<<1}}},function(t,e,n,i){re(i,r,a,n,t,e)},f?[0,-r]:[-k,r-k])}var be=1e9,_e=-be;function xe(v,y,b,_){function x(t,e){return v<=t&&t<=b&&y<=e&&e<=_}function w(t,e,n,i){var r=0,a=0;if(null==t||(r=o(t,n))!==(a=o(e,n))||s(t,e)<0^0<n)for(;i.point(0===r||3===r?v:b,1<r?_:y),(r=(r+n+4)%4)!==a;);else i.point(e[0],e[1])}function o(t,e){return E(t[0]-v)<A?0<e?0:3:E(t[0]-b)<A?0<e?2:1:E(t[1]-y)<A?0<e?1:0:0<e?3:2}function C(t,e){return s(t.x,e.x)}function s(t,e){var n=o(t,1),i=o(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(i){var r,h,a,o,s,l,u,c,f,d,p,g=i,t=oe(),e={point:n,lineStart:function(){e.point=m,h&&h.push(a=[]);d=!0,f=!1,u=c=NaN},lineEnd:function(){r&&(m(o,s),l&&f&&t.rejoin(),r.push(t.result()));e.point=n,f&&g.lineEnd()},polygonStart:function(){g=t,r=[],h=[],p=!0},polygonEnd:function(){var t=function(){for(var t=0,e=0,n=h.length;e<n;++e)for(var i,r,a=h[e],o=1,s=a.length,l=a[0],u=l[0],c=l[1];o<s;++o)i=u,r=c,l=a[o],u=l[0],c=l[1],r<=_?_<c&&(c-r)*(v-i)<(u-i)*(_-r)&&++t:c<=_&&(u-i)*(_-r)<(c-r)*(v-i)&&--t;return t}(),e=p&&t,n=(r=S.merge(r)).length;(e||n)&&(i.polygonStart(),e&&(i.lineStart(),w(null,null,1,i),i.lineEnd()),n&&ue(r,C,t,w,i),i.polygonEnd());g=i,r=h=a=null}};function n(t,e){x(t,e)&&g.point(t,e)}function m(t,e){var n,i,r=x(t,e);h&&a.push([t,e]),d?(o=t,s=e,d=!1,(l=r)&&(g.lineStart(),g.point(t,e))):r&&f?g.point(t,e):!function(t,e,n,i,r,a){var o=t[0],s=t[1],l=0,u=1,c=e[0]-o,h=e[1]-s,n=n-o;if(c||!(0<n)){if(n/=c,c<0){if(n<l)return;n<u&&(u=n)}else if(0<c){if(u<n)return;l<n&&(l=n)}if(n=r-o,c||!(n<0)){if(n/=c,c<0){if(u<n)return;l<n&&(l=n)}else if(0<c){if(n<l)return;n<u&&(u=n)}if(n=i-s,h||!(0<n)){if(n/=h,h<0){if(n<l)return;n<u&&(u=n)}else if(0<h){if(u<n)return;l<n&&(l=n)}if(n=a-s,h||!(n<0)){if(n/=h,h<0){if(u<n)return;l<n&&(l=n)}else if(0<h){if(n<l)return;n<u&&(u=n)}return 0<l&&(t[0]=o+l*c,t[1]=s+l*h),u<1&&(e[0]=o+u*c,e[1]=s+u*h),1}}}}}(n=[u=Math.max(_e,Math.min(be,u)),c=Math.max(_e,Math.min(be,c))],i=[t=Math.max(_e,Math.min(be,t)),e=Math.max(_e,Math.min(be,e))],v,y,b,_)?r&&(g.lineStart(),g.point(t,e),p=!1):(f||(g.lineStart(),g.point(n[0],n[1])),g.point(i[0],i[1]),r||g.lineEnd(),p=!1),u=t,c=e,f=r}return e}}var we,Ce,Se,Me=e(),ke={sphere:f,point:f,lineStart:function(){ke.point=Te,ke.lineEnd=Le},lineEnd:f,polygonStart:f,polygonEnd:f};function Le(){ke.point=ke.lineEnd=f}function Te(t,e){we=t*=P,Ce=F(e*=P),Se=I(e),ke.point=De}function De(t,e){t*=P;var n=F(e*=P),i=I(e),r=E(t-we),a=I(r),e=i*F(r),r=Se*n-Ce*i*a,a=Ce*n+Se*i*a;Me.add(O(j(e*e+r*r),a)),we=t,Ce=n,Se=i}function Ae(t){return Me.reset(),x(t,ke),+Me}var Be=[null,null],Pe={type:"LineString",coordinates:Be};function Ee(t,e){return Be[0]=t,Be[1]=e,Ae(Pe)}var Oe={Feature:function(t,e){return Fe(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)if(Fe(n[i].geometry,e))return!0;return!1}},Ie={Sphere:function(){return!0},Point:function(t,e){return je(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(je(n[i],e))return!0;return!1},LineString:function(t,e){return Ne(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(Ne(n[i],e))return!0;return!1},Polygon:function(t,e){return Re(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)if(Re(n[i],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)if(Fe(n[i],e))return!0;return!1}};function Fe(t,e){return!(!t||!Ie.hasOwnProperty(t.type))&&Ie[t.type](t,e)}function je(t,e){return 0===Ee(t,e)}function Ne(t,e){for(var n,i,r,a=0,o=t.length;a<o;a++){if(0===(i=Ee(t[a],e)))return!0;if(0<a&&0<(r=Ee(t[a],t[a-1]))&&n<=r&&i<=r&&(n+i-r)*(1-Math.pow((n-i)/r,2))<s*r)return!0;n=i}return!1}function Re(t,e){return!!de(t.map(We),He(e))}function We(t){return(t=t.map(He)).pop(),t}function He(t){return[t[0]*P,t[1]*P]}function ze(t,e,n){var i=S.range(t,e-A,n).concat(e);return function(e){return i.map(function(t){return[e,t]})}}function qe(t,e,n){var i=S.range(t,e-A,n).concat(e);return function(e){return i.map(function(t){return[t,e]})}}function Ge(){var e,n,i,r,a,o,s,l,u,c,h,f,d=10,p=d,g=90,m=360,v=2.5;function y(){return{type:"MultiLineString",coordinates:t()}}function t(){return S.range(b(r/g)*g,i,g).map(h).concat(S.range(b(l/m)*m,s,m).map(f)).concat(S.range(b(n/d)*d,e,d).filter(function(t){return E(t%g)>A}).map(u)).concat(S.range(b(o/p)*p,a,p).filter(function(t){return E(t%m)>A}).map(c))}return y.lines=function(){return t().map(function(t){return{type:"LineString",coordinates:t}})},y.outline=function(){return{type:"Polygon",coordinates:[h(r).concat(f(s).slice(1),h(i).reverse().slice(1),f(l).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],i=+t[1][0],l=+t[0][1],s=+t[1][1],i<r&&(t=r,r=i,i=t),s<l&&(t=l,l=s,s=t),y.precision(v)):[[r,l],[i,s]]},y.extentMinor=function(t){return arguments.length?(n=+t[0][0],e=+t[1][0],o=+t[0][1],a=+t[1][1],e<n&&(t=n,n=e,e=t),a<o&&(t=o,o=a,a=t),y.precision(v)):[[n,o],[e,a]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(g=+t[0],m=+t[1],y):[g,m]},y.stepMinor=function(t){return arguments.length?(d=+t[0],p=+t[1],y):[d,p]},y.precision=function(t){return arguments.length?(v=+t,u=ze(o,a,90),c=qe(n,e,v),h=ze(l,s,90),f=qe(r,i,v),y):v},y.extentMajor([[-180,-90+A],[180,90-A]]).extentMinor([[-180,-80-A],[180,80+A]])}function Ue(t){return t}var $e,Ke,Ye,Ve,Xe=e(),Je=e(),Ze={point:f,lineStart:f,lineEnd:f,polygonStart:function(){Ze.lineStart=Qe,Ze.lineEnd=nn},polygonEnd:function(){Ze.lineStart=Ze.lineEnd=Ze.point=f,Xe.add(E(Je)),Je.reset()},result:function(){var t=Xe/2;return Xe.reset(),t}};function Qe(){Ze.point=tn}function tn(t,e){Ze.point=en,$e=Ye=t,Ke=Ve=e}function en(t,e){Je.add(Ve*t-Ye*e),Ye=t,Ve=e}function nn(){en($e,Ke)}var rn=1/0,an=rn,on=-rn,sn=on,ln={point:function(t,e){t<rn&&(rn=t);on<t&&(on=t);e<an&&(an=e);sn<e&&(sn=e)},lineStart:f,lineEnd:f,polygonStart:f,polygonEnd:f,result:function(){var t=[[rn,an],[on,sn]];return on=sn=-(an=rn=1/0),t}};var un,cn,hn,fn,dn=0,pn=0,gn=0,mn=0,vn=0,yn=0,bn=0,_n=0,xn=0,wn={point:Cn,lineStart:Sn,lineEnd:Ln,polygonStart:function(){wn.lineStart=Tn,wn.lineEnd=Dn},polygonEnd:function(){wn.point=Cn,wn.lineStart=Sn,wn.lineEnd=Ln},result:function(){var t=xn?[bn/xn,_n/xn]:yn?[mn/yn,vn/yn]:gn?[dn/gn,pn/gn]:[NaN,NaN];return dn=pn=gn=mn=vn=yn=bn=_n=xn=0,t}};function Cn(t,e){dn+=t,pn+=e,++gn}function Sn(){wn.point=Mn}function Mn(t,e){wn.point=kn,Cn(hn=t,fn=e)}function kn(t,e){var n=t-hn,i=e-fn,i=j(n*n+i*i);mn+=i*(hn+t)/2,vn+=i*(fn+e)/2,yn+=i,Cn(hn=t,fn=e)}function Ln(){wn.point=Cn}function Tn(){wn.point=An}function Dn(){Bn(un,cn)}function An(t,e){wn.point=Bn,Cn(un=hn=t,cn=fn=e)}function Bn(t,e){var n=t-hn,i=e-fn,i=j(n*n+i*i);mn+=i*(hn+t)/2,vn+=i*(fn+e)/2,yn+=i,bn+=(i=fn*t-hn*e)*(hn+t),_n+=i*(fn+e),xn+=3*i,Cn(hn=t,fn=e)}function Pn(t){this._context=t}Pn.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,D)}},result:f};var En,On,In,Fn,jn,Nn=e(),Rn={point:f,lineStart:function(){Rn.point=Wn},lineEnd:function(){En&&Hn(On,In),Rn.point=f},polygonStart:function(){En=!0},polygonEnd:function(){En=null},result:function(){var t=+Nn;return Nn.reset(),t}};function Wn(t,e){Rn.point=Hn,On=Fn=t,In=jn=e}function Hn(t,e){Fn-=t,jn-=e,Nn.add(j(Fn*Fn+jn*jn)),Fn=t,jn=e}function zn(){this._string=[]}function qn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Gn(i){return function(t){var e,n=new Un;for(e in i)n[e]=i[e];return n.stream=t,n}}function Un(){}function $n(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=i&&t.clipExtent(null),x(n,t.stream(ln)),e(ln.result()),null!=i&&t.clipExtent(i),t}function Kn(r,a,t){return $n(r,function(t){var e=a[1][0]-a[0][0],n=a[1][1]-a[0][1],i=Math.min(e/(t[1][0]-t[0][0]),n/(t[1][1]-t[0][1])),e=+a[0][0]+(e-i*(t[1][0]+t[0][0]))/2,t=+a[0][1]+(n-i*(t[1][1]+t[0][1]))/2;r.scale(150*i).translate([e,t])},t)}function Yn(t,e,n){return Kn(t,[[0,0],e],n)}function Vn(i,r,t){return $n(i,function(t){var e=+r,n=e/(t[1][0]-t[0][0]),e=(e-n*(t[1][0]+t[0][0]))/2,t=-n*t[0][1];i.scale(150*n).translate([e,t])},t)}function Xn(r,a,t){return $n(r,function(t){var e=+a,n=e/(t[1][1]-t[0][1]),i=-n*t[0][0],t=(e-n*(t[1][1]+t[0][1]))/2;r.scale(150*n).translate([i,t])},t)}zn.prototype={_radius:4.5,_circle:qn(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=qn(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Un.prototype={constructor:Un,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Jn=16,Zn=I(30*P);function Qn(t,e){return+e?(L=t,T=e,function(i){var n,r,a,o,s,l,u,c,h,f,d,p,g={point:t,lineStart:e,lineEnd:v,polygonStart:function(){i.polygonStart(),g.lineStart=y},polygonEnd:function(){i.polygonEnd(),g.lineStart=e}};function t(t,e){t=L(t,e),i.point(t[0],t[1])}function e(){c=NaN,g.point=m,i.lineStart()}function m(t,e){var n=V([t,e]),e=L(t,e);D(c,h,u,f,d,p,c=e[0],h=e[1],u=t,f=n[0],d=n[1],p=n[2],Jn,i),i.point(c,h)}function v(){g.point=t,i.lineEnd()}function y(){e(),g.point=b,g.lineEnd=_}function b(t,e){m(n=t,e),r=c,a=h,o=f,s=d,l=p,g.point=m}function _(){D(c,h,u,f,d,p,r,a,n,o,s,l,Jn,i),g.lineEnd=v,v()}return g}):(n=t,Gn({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}}));var n,L,T;function D(t,e,n,i,r,a,o,s,l,u,c,h,f,d){var p,g,m,v,y,b,_,x,w,C,S=o-t,M=s-e,k=S*S+M*M;4*T<k&&f--&&(m=a+h,w=N(m/=v=j((p=i+u)*p+(g=r+c)*g+m*m)),y=E(E(m)-1)<A||E(n-l)<A?(n+l)/2:O(g,p),b=(C=L(y,w))[0],_=C[1],(T<(C=M*(x=b-t)-S*(w=_-e))*C/k||.3<E((S*x+M*w)/k-.5)||i*u+r*c+a*h<Zn)&&(D(t,e,n,i,r,a,b,_,y,p/=v,g/=v,m,f,d),d.point(b,_),D(b,_,y,p,g,m,o,s,l,u,c,h,f,d)))}}var ti=Gn({point:function(t,e){this.stream.point(t*P,e*P)}});function ei(n,i,r){function t(t,e){return[i+n*t,r-n*e]}return t.invert=function(t,e){return[(t-i)/n,(r-e)/n]},t}function ni(t,n,i,e){var r=I(e),e=F(e),a=r*t,o=e*t,s=r/t,l=e/t,u=(e*i-r*n)/t,c=(e*n+r*i)/t;function h(t,e){return[a*t-o*e+n,i-o*t-a*e]}return h.invert=function(t,e){return[s*t-l*e+u,c-l*t-s*e]},h}function ii(t){return ri(function(){return t})()}function ri(t){var e,i,n,r,a,o,s,l,u,c,h=150,f=480,d=250,p=0,g=0,m=0,v=0,y=0,b=0,_=null,x=ve,w=null,C=Ue,S=.5;function M(t){return l(t[0]*P,t[1]*P)}function k(t){return(t=l.invert(t[0],t[1]))&&[t[0]*B,t[1]*B]}function L(){var t=ni(h,0,0,b).apply(null,e(p,g)),t=(b?ni:ei)(h,f-t[0],d-t[1],b);return i=Qt(m,v,y),s=Jt(e,t),l=Jt(i,s),o=Qn(s,S),T()}function T(){return u=c=null,M}return M.stream=function(t){return u&&c===t?u:u=ti((n=i,Gn({point:function(t,e){e=n(t,e);return this.stream.point(e[0],e[1])}})(x(o(C(c=t))))));var n},M.preclip=function(t){return arguments.length?(x=t,_=void 0,T()):x},M.postclip=function(t){return arguments.length?(C=t,w=n=r=a=null,T()):C},M.clipAngle=function(t){return arguments.length?(x=+t?ye(_=t*P):(_=null,ve),T()):_*B},M.clipExtent=function(t){return arguments.length?(C=null==t?(w=n=r=a=null,Ue):xe(w=+t[0][0],n=+t[0][1],r=+t[1][0],a=+t[1][1]),T()):null==w?null:[[w,n],[r,a]]},M.scale=function(t){return arguments.length?(h=+t,L()):h},M.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],L()):[f,d]},M.center=function(t){return arguments.length?(p=t[0]%360*P,g=t[1]%360*P,L()):[p*B,g*B]},M.rotate=function(t){return arguments.length?(m=t[0]%360*P,v=t[1]%360*P,y=2<t.length?t[2]%360*P:0,L()):[m*B,v*B,y*B]},M.angle=function(t){return arguments.length?(b=t%360*P,L()):b*B},M.precision=function(t){return arguments.length?(o=Qn(s,S=t*t),T()):j(S)},M.fitExtent=function(t,e){return Kn(M,t,e)},M.fitSize=function(t,e){return Yn(M,t,e)},M.fitWidth=function(t,e){return Vn(M,t,e)},M.fitHeight=function(t,e){return Xn(M,t,e)},function(){return e=t.apply(this,arguments),M.invert=e.invert&&k,L()}}function ai(t){var e=0,n=k/3,i=ri(t),t=i(e,n);return t.parallels=function(t){return arguments.length?i(e=t[0]*P,n=t[1]*P):[e*B,n*B]},t}function oi(t,e){var n,i=F(t),r=(i+F(e))/2;if(E(r)<A)return n=I(t),a.invert=function(t,e){return[t/n,N(e*n)]},a;function a(t,e){return[t*n,F(e)/n]}var o=1+i*(2*r-i),s=j(o)/r;function l(t,e){e=j(o-2*r*F(e))/r;return[e*F(t*=r),s-e*I(t)]}return l.invert=function(t,e){e=s-e;return[O(t,E(e))/r*u(e),N((o-(t*t+e*e)*r*r)/(2*r))]},l}function si(){return ai(oi).scale(155.424).center([0,33.6442])}function li(){return si().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function ui(r){return function(t,e){var n=I(t),i=I(e),n=r(n*i);return[n*i*F(t),n*F(e)]}}function ci(a){return function(t,e){var n=j(t*t+e*e),i=a(n),r=F(i),i=I(i);return[O(t*r,n*i),N(n&&e*r/n)]}}var hi=ui(function(t){return j(2/(1+t))});hi.invert=ci(function(t){return 2*N(t/2)});var fi=ui(function(t){return(t=h(t))&&t/F(t)});function di(t,e){return[t,o(c((L+e)/2))]}function pi(n){var i,r,a,o=ii(n),e=o.center,s=o.scale,l=o.translate,u=o.clipExtent,c=null;function h(){var t=k*s(),e=o(ie(o.rotate()).invert([0,0]));return u(null==c?[[e[0]-t,e[1]-t],[e[0]+t,e[1]+t]]:n===di?[[Math.max(e[0]-t,c),i],[Math.min(e[0]+t,r),a]]:[[c,Math.max(e[1]-t,i)],[r,Math.min(e[1]+t,a)]])}return o.scale=function(t){return arguments.length?(s(t),h()):s()},o.translate=function(t){return arguments.length?(l(t),h()):l()},o.center=function(t){return arguments.length?(e(t),h()):e()},o.clipExtent=function(t){return arguments.length?(null==t?c=i=r=a=null:(c=+t[0][0],i=+t[0][1],r=+t[1][0],a=+t[1][1]),h()):null==c?null:[[c,i],[r,a]]},h()}function gi(t){return c((L+t)/2)}function mi(t,e){var n=I(t),i=t===e?F(t):o(n/I(e))/o(gi(e)/gi(t)),r=n*l(gi(t),i)/i;return i?(a.invert=function(t,e){var n=r-e,e=u(i)*j(t*t+n*n);return[O(t,E(n))/i*u(n),2*p(l(r/e,1/i))-L]},a):di;function a(t,e){0<r?e<-L+A&&(e=-L+A):L-A<e&&(e=L-A);e=r/l(gi(e),i);return[e*F(i*t),r-e*I(i*t)]}}function vi(t,e){return[t,e]}function yi(t,e){var n=I(t),i=t===e?F(t):(n-I(e))/(e-t),r=n/i+t;return E(i)<A?vi:(a.invert=function(t,e){e=r-e;return[O(t,E(e))/i*u(e),r-u(i)*j(t*t+e*e)]},a);function a(t,e){e=r-e,t*=i;return[e*F(t),r-e*I(t)]}}fi.invert=ci(function(t){return t}),di.invert=function(t,e){return[t,2*p(a(e))-L]},vi.invert=vi;var bi=1.340264,_i=-.081106,xi=893e-6,wi=.003796,Ci=j(3)/2;function Si(t,e){var n=N(Ci*F(e)),i=n*n,e=i*i*i;return[t*I(n)/(Ci*(bi+3*_i*i+e*(7*xi+9*wi*i))),n*(bi+_i*i+e*(xi+wi*i))]}function Mi(t,e){var n=I(e),i=I(t)*n;return[n*F(t)/i,F(e)/i]}function ki(n,i,r,a){return 1===n&&1===i&&0===r&&0===a?Ue:Gn({point:function(t,e){this.stream.point(t*n+r,e*i+a)}})}function Li(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function Ti(t,e){return[I(e)*F(t),F(e)]}function Di(t,e){var n=I(e),i=1+I(t)*n;return[n*F(t)/i,F(e)/i]}function Ai(t,e){return[o(c((L+e)/2)),-t]}Si.invert=function(t,e){for(var n,i=e,r=i*i,a=r*r*r,o=0;o<12&&(a=(r=(i-=n=(i*(bi+_i*r+a*(xi+wi*r))-e)/(bi+3*_i*r+a*(7*xi+9*wi*r)))*i)*r*r,!(E(n)<s));++o);return[Ci*t*(bi+3*_i*r+a*(7*xi+9*wi*r))/I(i),N(F(i)/Ci)]},Mi.invert=ci(p),Li.invert=function(t,e){var n=e,i=25;do{var r=n*n,a=r*r}while(n-=a=(n*(1.007226+r*(.015085+a*(.028874*r-.044475-.005916*a)))-e)/(1.007226+r*(.045255+a*(.259866*r-.311325-.005916*11*a))),E(a)>A&&0<--i);return[t/(.8707+(r=n*n)*(r*(r*r*r*(.003971-.001529*r)-.013791)-.131979)),n]},Ti.invert=ci(N),Di.invert=ci(function(t){return 2*p(t)}),Ai.invert=function(t,e){return[-e,2*p(a(t))-L]},t.geoAlbers=li,t.geoAlbersUsa=function(){var e,n,r,a,o,i,s=li(),l=si().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=si().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){i=[t,e]}};function h(t){var e=t[0],t=t[1];return i=null,r.point(e,t),i||(a.point(e,t),i)||(o.point(e,t),i)}function f(){return e=n=null,h}return h.invert=function(t){var e=s.scale(),n=s.translate(),i=(t[0]-n[0])/e,e=(t[1]-n[1])/e;return(.12<=e&&e<.234&&-.425<=i&&i<-.214?l:.166<=e&&e<.234&&-.214<=i&&i<-.115?u:s).invert(t)},h.stream=function(t){return e&&n===t?e:(i=[s.stream(n=t),l.stream(t),u.stream(t)],r=i.length,e={point:function(t,e){for(var n=-1;++n<r;)i[n].point(t,e)},sphere:function(){for(var t=-1;++t<r;)i[t].sphere()},lineStart:function(){for(var t=-1;++t<r;)i[t].lineStart()},lineEnd:function(){for(var t=-1;++t<r;)i[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<r;)i[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<r;)i[t].polygonEnd()}});var i,r},h.precision=function(t){return arguments.length?(s.precision(t),l.precision(t),u.precision(t),f()):s.precision()},h.scale=function(t){return arguments.length?(s.scale(t),l.scale(.35*t),u.scale(t),h.translate(s.translate())):s.scale()},h.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),n=+t[0],i=+t[1];return r=s.translate(t).clipExtent([[n-.455*e,i-.238*e],[n+.455*e,i+.238*e]]).stream(c),a=l.translate([n-.307*e,i+.201*e]).clipExtent([[n-.425*e+A,i+.12*e+A],[n-.214*e-A,i+.234*e-A]]).stream(c),o=u.translate([n-.205*e,i+.212*e]).clipExtent([[n-.214*e+A,i+.166*e+A],[n-.115*e-A,i+.234*e-A]]).stream(c),f()},h.fitExtent=function(t,e){return Kn(h,t,e)},h.fitSize=function(t,e){return Yn(h,t,e)},h.fitWidth=function(t,e){return Vn(h,t,e)},h.fitHeight=function(t,e){return Xn(h,t,e)},h.scale(1070)},t.geoArea=function(t){return z.reset(),x(t,q),2*z},t.geoAzimuthalEqualArea=function(){return ii(hi).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=hi,t.geoAzimuthalEquidistant=function(){return ii(fi).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=fi,t.geoBounds=function(t){var e,n,i,r,a,o,s;if(rt=it=-(et=nt=1/0),ut=[],x(t,Tt),n=ut.length){for(ut.sort(jt),e=1,a=[i=ut[0]];e<n;++e)Nt(i,(r=ut[e])[0])||Nt(i,r[1])?(Ft(i[0],r[1])>Ft(i[0],i[1])&&(i[1]=r[1]),Ft(r[0],i[1])>Ft(i[0],i[1])&&(i[0]=r[0])):a.push(i=r);for(o=-1/0,e=0,i=a[n=a.length-1];e<=n;i=r,++e)r=a[e],(s=Ft(i[1],r[0]))>o&&(o=s,et=r[0],it=i[1])}return ut=ct=null,et===1/0||nt===1/0?[[NaN,NaN],[NaN,NaN]]:[[et,nt],[it,rt]]},t.geoCentroid=function(t){ht=ft=dt=pt=gt=mt=vt=yt=bt=_t=xt=0,x(t,Rt);var e=bt,n=_t,i=xt;return(t=e*e+n*n+i*i)<s&&(e=mt,n=vt,i=yt,ft<A&&(e=dt,n=pt,i=gt),(t=e*e+n*n+i*i)<s)?[NaN,NaN]:[O(n,e)*B,N(i/j(t))*B]},t.geoCircle=function(){var i,r,a=Xt([0,0]),o=Xt(90),s=Xt(6),l={point:function(t,e){i.push(t=r(t,e)),t[0]*=B,t[1]*=B}};function e(){var t=a.apply(this,arguments),e=o.apply(this,arguments)*P,n=s.apply(this,arguments)*P;return i=[],r=Qt(-t[0]*P,-t[1]*P,0).invert,re(l,e,n,1),t={type:"Polygon",coordinates:[i]},i=r=null,t}return e.center=function(t){return arguments.length?(a="function"==typeof t?t:Xt([+t[0],+t[1]]),e):a},e.radius=function(t){return arguments.length?(o="function"==typeof t?t:Xt(+t),e):o},e.precision=function(t){return arguments.length?(s="function"==typeof t?t:Xt(+t),e):s},e},t.geoClipAntimeridian=ve,t.geoClipCircle=ye,t.geoClipExtent=function(){var e,n,i,r=0,a=0,o=960,s=500;return i={stream:function(t){return e&&n===t?e:e=xe(r,a,o,s)(n=t)},extent:function(t){return arguments.length?(r=+t[0][0],a=+t[0][1],o=+t[1][0],s=+t[1][1],e=n=null,i):[[r,a],[o,s]]}}},t.geoClipRectangle=xe,t.geoConicConformal=function(){return ai(mi).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=mi,t.geoConicEqualArea=si,t.geoConicEqualAreaRaw=oi,t.geoConicEquidistant=function(){return ai(yi).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=yi,t.geoContains=function(t,e){return(t&&Oe.hasOwnProperty(t.type)?Oe[t.type]:Fe)(t,e)},t.geoDistance=Ee,t.geoEqualEarth=function(){return ii(Si).scale(177.158)},t.geoEqualEarthRaw=Si,t.geoEquirectangular=function(){return ii(vi).scale(152.63)},t.geoEquirectangularRaw=vi,t.geoGnomonic=function(){return ii(Mi).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=Mi,t.geoGraticule=Ge,t.geoGraticule10=function(){return Ge()()},t.geoIdentity=function(){var e,n,i,r,a,o,s=1,l=0,u=0,c=1,h=1,f=Ue,d=null,p=Ue;function g(){return r=a=null,o}return o={stream:function(t){return r&&a===t?r:r=f(p(a=t))},postclip:function(t){return arguments.length?(p=t,d=e=n=i=null,g()):p},clipExtent:function(t){return arguments.length?(p=null==t?(d=e=n=i=null,Ue):xe(d=+t[0][0],e=+t[0][1],n=+t[1][0],i=+t[1][1]),g()):null==d?null:[[d,e],[n,i]]},scale:function(t){return arguments.length?(f=ki((s=+t)*c,s*h,l,u),g()):s},translate:function(t){return arguments.length?(f=ki(s*c,s*h,l=+t[0],u=+t[1]),g()):[l,u]},reflectX:function(t){return arguments.length?(f=ki(s*(c=t?-1:1),s*h,l,u),g()):c<0},reflectY:function(t){return arguments.length?(f=ki(s*c,s*(h=t?-1:1),l,u),g()):h<0},fitExtent:function(t,e){return Kn(o,t,e)},fitSize:function(t,e){return Yn(o,t,e)},fitWidth:function(t,e){return Vn(o,t,e)},fitHeight:function(t,e){return Xn(o,t,e)}}},t.geoInterpolate=function(t,e){var n=t[0]*P,i=t[1]*P,r=e[0]*P,a=e[1]*P,t=I(i),o=F(i),e=I(a),s=F(a),l=t*I(n),u=t*F(n),c=e*I(r),h=e*F(r),f=2*N(j(g(a-i)+t*e*g(r-n))),d=F(f);return(r=f?function(t){var e=F(t*=f)/d,n=F(f-t)/d,i=n*l+e*c,t=n*u+e*h,e=n*o+e*s;return[O(t,i)*B,O(e,j(i*i+t*t))*B]}:function(){return[n*B,i*B]}).distance=f,r},t.geoLength=Ae,t.geoMercator=function(){return pi(di).scale(961/D)},t.geoMercatorRaw=di,t.geoNaturalEarth1=function(){return ii(Li).scale(175.295)},t.geoNaturalEarth1Raw=Li,t.geoOrthographic=function(){return ii(Ti).scale(249.5).clipAngle(90+A)},t.geoOrthographicRaw=Ti,t.geoPath=function(e,n){var i,r,a=4.5;function o(t){return t&&("function"==typeof a&&r.pointRadius(+a.apply(this,arguments)),x(t,i(r))),r.result()}return o.area=function(t){return x(t,i(Ze)),Ze.result()},o.measure=function(t){return x(t,i(Rn)),Rn.result()},o.bounds=function(t){return x(t,i(ln)),ln.result()},o.centroid=function(t){return x(t,i(wn)),wn.result()},o.projection=function(t){return arguments.length?(i=null==t?(e=null,Ue):(e=t).stream,o):e},o.context=function(t){return arguments.length?(r=null==t?(n=null,new zn):new Pn(n=t),"function"!=typeof a&&r.pointRadius(a),o):n},o.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(r.pointRadius(+t),+t),o):a},o.projection(e).context(n)},t.geoProjection=ii,t.geoProjectionMutator=ri,t.geoRotation=ie,t.geoStereographic=function(){return ii(Di).scale(250).clipAngle(142)},t.geoStereographicRaw=Di,t.geoStream=x,t.geoTransform=function(t){return{stream:Gn(t)}},t.geoTransverseMercator=function(){var t=pi(Ai),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],2<t.length?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=Ai,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-array")):"function"==typeof define&&define.amd?define(["exports","d3-array"],r):r((i=i||self).d3=i.d3||{},i.d3)},{"d3-array":11}],26:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";function n(t,e){return t.parent===e.parent?1:2}function h(t,e){return t+e.x}function f(t,e){return Math.max(t,e.y)}function e(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;0<=--i;)e+=n[i].value;else e=1;t.value=e}function i(t,e){var n,i,r,a,o,s=new p(t),l=+t.value&&(s.value=t.value),u=[s];for(null==e&&(e=c);n=u.pop();)if(l&&(n.value=+n.data.value),(r=e(n.data))&&(o=r.length))for(n.children=new Array(o),a=o-1;0<=a;--a)u.push(i=n.children[a]=new p(r[a])),i.parent=n,i.depth=n.depth+1;return s.eachBefore(d)}function c(t){return t.children}function r(t){t.data=t.data.data}function d(t){for(var e=0;t.height=e,(t=t.parent)&&t.height<++e;);}function p(t){this.data=t,this.depth=this.height=0,this.parent=null}p.prototype=i.prototype={constructor:p,count:function(){return this.eachAfter(e)},each:function(t){var e,n,i,r,a,o=[this];do{for(n=o.reverse(),o=[];e=n.pop();)if(t(e),i=e.children)for(r=0,a=i.length;r<a;++r)o.push(i[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,i,r=this,a=[r],o=[];r=a.pop();)if(o.push(r),e=r.children)for(n=0,i=e.length;n<i;++n)a.push(e[n]);for(;r=o.pop();)t(r);return this},eachBefore:function(t){for(var e,n,i,r=[this];e=r.pop();)if(t(e),n=e.children)for(i=n.length-1;0<=i;--i)r.push(n[i]);return this},sum:function(r){return this.eachAfter(function(t){for(var e=+r(t.data)||0,n=t.children,i=n&&n.length;0<=--i;)e+=n[i].value;t.value=e})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;t=n.pop(),e=i.pop();for(;t===e;)r=t,t=n.pop(),e=i.pop();return r}(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var e=[];return this.each(function(t){e.push(t)}),e},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,n=[];return e.each(function(t){t!==e&&n.push({source:t.parent,target:t})}),n},copy:function(){return i(this).eachBefore(r)}};var o=Array.prototype.slice;function g(t){for(var e,n,i=0,r=(t=function(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t}(o.call(t))).length,a=[];i<r;)e=t[i],n&&l(n,e)?++i:(n=function(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return m(t[0],t[1]);case 3:return v(t[0],t[1],t[2])}}(a=function(t,e){var n,i;if(u(e,t))return[e];for(n=0;n<t.length;++n)if(s(e,t[n])&&u(m(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(s(m(t[n],t[i]),e)&&s(m(t[n],e),t[i])&&s(m(t[i],e),t[n])&&u(v(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}(a,e)),i=0);return n}function s(t,e){var n=t.r-e.r,i=e.x-t.x,t=e.y-t.y;return n<0||n*n<i*i+t*t}function l(t,e){var n=t.r-e.r+1e-6,i=e.x-t.x,t=e.y-t.y;return 0<n&&i*i+t*t<n*n}function u(t,e){for(var n=0;n<e.length;++n)if(!l(t,e[n]))return;return 1}function m(t,e){var n=t.x,i=t.y,r=t.r,a=e.x,o=e.y,s=e.r,l=a-n,u=o-i,t=s-r,e=Math.sqrt(l*l+u*u);return{x:(n+a+l/e*t)/2,y:(i+o+u/e*t)/2,r:(e+r+s)/2}}function v(t,e,n){var i=t.x,r=t.y,a=t.r,o=e.x,s=e.y,l=e.r,u=n.x,c=n.y,h=n.r,f=i-o,d=i-u,p=r-s,g=r-c,t=l-a,e=h-a,n=i*i+r*r-a*a,l=n-o*o-s*s+l*l,u=n-u*u-c*c+h*h,c=d*p-f*g,h=(p*u-g*l)/(2*c)-i,p=(g*t-p*e)/c,u=(d*l-f*u)/(2*c)-r,d=(f*e-d*t)/c,t=p*p+d*d-1,c=2*(a+h*p+u*d),a=h*h+u*u-a*a,c=-(t?(c+Math.sqrt(c*c-4*t*a))/(2*t):a/c);return{x:i+h+p*c,y:r+u+d*c,r:c}}function y(t,e,n){var i,r,a,o,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(r=e.r+n.r,o=t.r+n.r,(o*=o)<(r*=r)?(i=(u+o-r)/(2*u),a=Math.sqrt(Math.max(0,o/u-i*i)),n.x=t.x-i*s-a*l,n.y=t.y-i*l+a*s):(i=(u+r-o)/(2*u),a=Math.sqrt(Math.max(0,r/u-i*i)),n.x=e.x+i*s-a*l,n.y=e.y+i*l+a*s)):(n.x=e.x+n.r,n.y=e.y)}function b(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,t=e.y-t.y;return 0<n&&i*i+t*t<n*n}function _(t){var e=t._,n=t.next._,i=e.r+n.r,t=(e.x*n.r+n.x*e.r)/i,i=(e.y*n.r+n.y*e.r)/i;return t*t+i*i}function x(t){this._=t,this.next=null,this.previous=null}function w(t){if(!(i=t.length))return 0;var e,n,i,r,a,o,s,l,u,c,h=t[0];if(h.x=0,h.y=0,!(1<i))return h.r;if(e=t[1],h.x=-e.r,e.x=h.r,e.y=0,!(2<i))return h.r+e.r;y(e,h,n=t[2]),h=new x(h),e=new x(e),n=new x(n),((h.next=n.previous=e).next=h.previous=n).next=e.previous=h;t:for(o=3;o<i;++o){y(h._,e._,n=t[o]),n=new x(n),s=e.next,l=h.previous,u=e._.r,c=h._.r;do{if(u<=c){if(b(s._,n._)){(h.next=e=s).previous=h,--o;continue t}u+=s._.r,s=s.next}else{if(b(l._,n._)){((h=l).next=e).previous=h,--o;continue t}c+=l._.r,l=l.previous}}while(s!==l.next);for(n.previous=h,n.next=e,h.next=e.previous=e=n,r=_(h);(n=n.next)!==e;)(a=_(n))<r&&(h=n,r=a);e=h.next}for(h=[e._],n=e;(n=n.next)!==e;)h.push(n._);for(n=g(h),o=0;o<i;++o)(h=t[o]).x-=n.x,h.y-=n.y;return n.r}function C(t){if("function"!=typeof t)throw new Error;return t}function S(){return 0}function M(t){return function(){return t}}function k(t){return Math.sqrt(t.value)}function L(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function T(o,s){return function(t){if(e=t.children){var e,n,i,r=e.length,a=o(t)*s||0;if(a)for(n=0;n<r;++n)e[n].r+=a;if(i=w(e),a)for(n=0;n<r;++n)e[n].r-=a;t.r=i+a}}}function D(n){return function(t){var e=t.parent;t.r*=n,e&&(t.x=e.x+n*t.x,t.y=e.y+n*t.y)}}function A(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function B(t,e,n,i,r){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(i-e)/t.value;++s<l;)(a=o[s]).y0=n,a.y1=r,a.x0=e,a.x1=e+=a.value*u}var P={depth:-1},E={};function a(t){return t.id}function O(t){return t.parentId}function I(t,e){return t.parent===e.parent?1:2}function F(t){var e=t.children;return e?e[0]:t.t}function j(t){var e=t.children;return e?e[e.length-1]:t.t}function N(t,e){this._=t,this.parent=null,this.children=null,this.A=null,(this.a=this).z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function R(t,e,n,i,r){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(r-n)/t.value;++s<l;)(a=o[s]).x0=e,a.x1=i,a.y0=n,a.y1=n+=a.value*u}N.prototype=Object.create(p.prototype);var W=(1+Math.sqrt(5))/2;function H(t,e,n,i,r,a){for(var o,s,l,u,c,h,f,d,p,g,m,v=[],y=e.children,b=0,_=0,x=y.length,w=e.value;b<x;){for(l=r-n,u=a-i;!(c=y[_++].value)&&_<x;);for(m=(h=f=c)*c*(g=Math.max(u/l,l/u)/(w*t)),p=Math.max(f/m,m/h);_<x;++_){if(c+=s=y[_].value,s<h&&(h=s),f<s&&(f=s),m=c*c*g,p<(d=Math.max(f/m,m/h))){c-=s;break}p=d}v.push(o={value:c,dice:l<u,children:y.slice(b,_)}),o.dice?B(o,n,i,r,w?i+=u*c/w:a):R(o,n,i,w?n+=l*c/w:r,a),w-=c,b=_}return v}var z=function e(a){function t(t,e,n,i,r){H(a,t,e,n,i,r)}return t.ratio=function(t){return e(1<(t=+t)?t:1)},t}(W);W=function e(d){function t(t,e,n,i,r){if((a=t._squarify)&&a.ratio===d)for(var a,o,s,l,u,c=-1,h=a.length,f=t.value;++c<h;){for(s=(o=a[c]).children,l=o.value=0,u=s.length;l<u;++l)o.value+=s[l].value;o.dice?B(o,e,n,i,n+=(r-n)*o.value/f):R(o,e,n,e+=(i-e)*o.value/f,r),f-=o.value}else t._squarify=a=H(d,t,e,n,i,r),a.ratio=d}return t.ratio=function(t){return e(1<(t=+t)?t:1)},t}(W);t.cluster=function(){var s=n,l=1,u=1,c=!1;function e(e){var i,r=0;e.eachAfter(function(t){var e,n=t.children;n?(t.x=(e=n).reduce(h,0)/e.length,t.y=1+n.reduce(f,0)):(t.x=i?r+=s(t,i):0,t.y=0,i=t)});var t=function(t){for(var e;e=t.children;)t=e[0];return t}(e),n=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(e),a=t.x-s(t,n)/2,o=n.x+s(n,t)/2;return e.eachAfter(c?function(t){t.x=(t.x-e.x)*l,t.y=(e.y-t.y)*u}:function(t){t.x=(t.x-a)/(o-a)*l,t.y=(1-(e.y?t.y/e.y:1))*u})}return e.separation=function(t){return arguments.length?(s=t,e):s},e.size=function(t){return arguments.length?(c=!1,l=+t[0],u=+t[1],e):c?null:[l,u]},e.nodeSize=function(t){return arguments.length?(c=!0,l=+t[0],u=+t[1],e):c?[l,u]:null},e},t.hierarchy=i,t.pack=function(){var e=null,n=1,i=1,r=S;function a(t){return t.x=n/2,t.y=i/2,e?t.eachBefore(L(e)).eachAfter(T(r,.5)).eachBefore(D(1)):t.eachBefore(L(k)).eachAfter(T(S,1)).eachAfter(T(r,t.r/Math.min(n,i))).eachBefore(D(Math.min(n,i)/(2*t.r))),t}return a.radius=function(t){return arguments.length?(e=null==(t=t)?null:C(t),a):e},a.size=function(t){return arguments.length?(n=+t[0],i=+t[1],a):[n,i]},a.padding=function(t){return arguments.length?(r="function"==typeof t?t:M(+t),a):r},a},t.packEnclose=g,t.packSiblings=function(t){return w(t),t},t.partition=function(){var n=1,i=1,s=0,r=!1;function e(t){var a,o,e=t.height+1;return t.x0=t.y0=s,t.x1=n,t.y1=i/e,t.eachBefore((a=i,o=e,function(t){t.children&&B(t,t.x0,a*(t.depth+1)/o,t.x1,a*(t.depth+2)/o);var e=t.x0,n=t.y0,i=t.x1-s,r=t.y1-s;i<e&&(e=i=(e+i)/2),r<n&&(n=r=(n+r)/2),t.x0=e,t.y0=n,t.x1=i,t.y1=r})),r&&t.eachBefore(A),t}return e.round=function(t){return arguments.length?(r=!!t,e):r},e.size=function(t){return arguments.length?(n=+t[0],i=+t[1],e):[n,i]},e.padding=function(t){return arguments.length?(s=+t,e):s},e},t.stratify=function(){var c=a,h=O;function e(t){for(var e,n,i,r,a,o=t.length,s=new Array(o),l={},u=0;u<o;++u)a=t[u],i=s[u]=new p(a),null!=(r=c(a,u,t))&&(r+="")&&(l[a="$"+(i.id=r)]=a in l?E:i);for(u=0;u<o;++u)if(i=s[u],null!=(r=h(t[u],u,t))&&(r+="")){if(!(n=l["$"+r]))throw new Error("missing: "+r);if(n===E)throw new Error("ambiguous: "+r);n.children?n.children.push(i):n.children=[i],i.parent=n}else{if(e)throw new Error("multiple roots");e=i}if(!e)throw new Error("no root");if(e.parent=P,e.eachBefore(function(t){t.depth=t.parent.depth+1,--o}).eachBefore(d),e.parent=null,0<o)throw new Error("cycle");return e}return e.id=function(t){return arguments.length?(c=C(t),e):c},e.parentId=function(t){return arguments.length?(h=C(t),e):h},e},t.tree=function(){var f=I,l=1,u=1,c=null;function e(t){var e,n,i,r,a,o,s=function(t){for(var e,n,i,r,a,o=[t=new N(t,0)];e=o.pop();)if(i=e._.children)for(e.children=new Array(a=i.length),r=a-1;0<=r;--r)o.push(n=e.children[r]=new N(i[r],r)),n.parent=e;return(t.parent=new N(null,0)).children=[t],t}(t);return s.eachAfter(h),s.parent.m=-s.z,s.eachBefore(d),c?t.eachBefore(p):((i=n=e=t).eachBefore(function(t){t.x<e.x&&(e=t),t.x>n.x&&(n=t),t.depth>i.depth&&(i=t)}),s=e===n?1:f(e,n)/2,r=s-e.x,a=l/(n.x+s+r),o=u/(i.depth||1),t.eachBefore(function(t){t.x=(t.x+r)*a,t.y=t.depth*o})),t}function h(t){var e=t.children,n=t.parent.children,i=t.i?n[t.i-1]:null;e?(function(t){for(var e,n=0,i=0,r=t.children,a=r.length;0<=--a;)(e=r[a]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(t),e=(e[0].z+e[e.length-1].z)/2,i?(t.z=i.z+f(t._,i._),t.m=t.z-e):t.z=e):i&&(t.z=i.z+f(t._,i._)),t.parent.A=function(t,e,n){if(e){for(var i,r=t,a=t,o=e,s=r.parent.children[0],l=r.m,u=a.m,c=o.m,h=s.m;o=j(o),r=F(r),o&&r;)s=F(s),(a=j(a)).a=t,0<(i=o.z+c-r.z-l+f(o._,r._))&&(function(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}(function(t,e,n){return t.a.parent===e.parent?t.a:n}(o,t,n),t,i),l+=i,u+=i),c+=o.m,l+=r.m,h+=s.m,u+=a.m;o&&!j(a)&&(a.t=o,a.m+=c-u),r&&!F(s)&&(s.t=r,s.m+=l-h,n=t)}return n}(t,i,t.parent.A||n[0])}function d(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function p(t){t.x*=l,t.y=t.depth*u}return e.separation=function(t){return arguments.length?(f=t,e):f},e.size=function(t){return arguments.length?(c=!1,l=+t[0],u=+t[1],e):c?null:[l,u]},e.nodeSize=function(t){return arguments.length?(c=!0,l=+t[0],u=+t[1],e):c?[l,u]:null},e},t.treemap=function(){var o=z,e=!1,n=1,i=1,s=[0],l=S,u=S,c=S,h=S,f=S;function r(t){return t.x0=t.y0=0,t.x1=n,t.y1=i,t.eachBefore(a),s=[0],e&&t.eachBefore(A),t}function a(t){var e=s[t.depth],n=t.x0+e,i=t.y0+e,r=t.x1-e,a=t.y1-e;r<n&&(n=r=(n+r)/2),a<i&&(i=a=(i+a)/2),t.x0=n,t.y0=i,t.x1=r,t.y1=a,t.children&&(e=s[t.depth+1]=l(t)/2,n+=f(t)-e,i+=u(t)-e,(r-=c(t)-e)<n&&(n=r=(n+r)/2),(a-=h(t)-e)<i&&(i=a=(i+a)/2),o(t,n,i,r,a))}return r.round=function(t){return arguments.length?(e=!!t,r):e},r.size=function(t){return arguments.length?(n=+t[0],i=+t[1],r):[n,i]},r.tile=function(t){return arguments.length?(o=C(t),r):o},r.padding=function(t){return arguments.length?r.paddingInner(t).paddingOuter(t):r.paddingInner()},r.paddingInner=function(t){return arguments.length?(l="function"==typeof t?t:M(+t),r):l},r.paddingOuter=function(t){return arguments.length?r.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):r.paddingTop()},r.paddingTop=function(t){return arguments.length?(u="function"==typeof t?t:M(+t),r):u},r.paddingRight=function(t){return arguments.length?(c="function"==typeof t?t:M(+t),r):c},r.paddingBottom=function(t){return arguments.length?(h="function"==typeof t?t:M(+t),r):h},r.paddingLeft=function(t){return arguments.length?(f="function"==typeof t?t:M(+t),r):f},r},t.treemapBinary=function(t,e,n,i,r){var a,o,g=t.children,s=g.length,m=new Array(s+1);for(m[0]=o=a=0;a<s;++a)m[a+1]=o+=g[a].value;!function t(e,n,i,r,a,o,s){if(n-1<=e){var l=g[e];return l.x0=r,l.y0=a,l.x1=o,void(l.y1=s)}var u=m[e],c=i/2+u,h=e+1,f=n-1;for(;h<f;){var d=h+f>>>1;m[d]<c?h=1+d:f=d}c-m[h-1]<m[h]-c&&e+1<h&&--h;var p=m[h]-u,l=i-p;s-a<o-r?(t(e,h,p,r,a,u=(r*l+o*p)/i,s),t(h,n,l,u,a,o,s)):(t(e,h,p,r,a,o,i=(a*l+s*p)/i),t(h,n,l,r,i,o,s))}(0,s,t.value,e,n,i,r)},t.treemapDice=B,t.treemapResquarify=W,t.treemapSlice=R,t.treemapSliceDice=function(t,e,n,i,r){(1&t.depth?R:B)(t,e,n,i,r)},t.treemapSquarify=z,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],27:[function(t,e,n){var i,r;i=this,r=function(t,l){"use strict";function u(t,e,n,i,r){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*i+o*r)/6}function e(o){var s=o.length-1;return function(t){var e=t<=0?t=0:1<=t?s-(t=1):Math.floor(t*s),n=o[e],i=o[e+1],r=0<e?o[e-1]:2*n-i,a=e<s-1?o[e+2]:2*i-n;return u((t-e/s)*s,r,n,i,a)}}function n(o){var s=o.length;return function(t){var e=Math.floor(((t%=1)<0?++t:t)*s),n=o[(e+s-1)%s],i=o[e%s],r=o[(e+1)%s],a=o[(e+2)%s];return u((t-e/s)*s,n,i,r,a)}}function o(t){return function(){return t}}function i(e,n){return function(t){return e+t*n}}function r(t,e){var n=e-t;return n?i(t,180<n||n<-180?n-360*Math.round(n/360):n):o(isNaN(t)?e:t)}function a(a){return 1==(a=+a)?c:function(t,e){return e-t?(n=t,i=e,r=a,n=Math.pow(n,r),i=Math.pow(i,r)-n,r=1/r,function(t){return Math.pow(n+t*i,r)}):o(isNaN(t)?e:t);var n,i,r}}function c(t,e){var n=e-t;return n?i(t,n):o(isNaN(t)?e:t)}var s=function t(e){var o=a(e);function n(e,t){var n=o((e=l.rgb(e)).r,(t=l.rgb(t)).r),i=o(e.g,t.g),r=o(e.b,t.b),a=c(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=r(t),e.opacity=a(t),e+""}}return n.gamma=t,n}(1);function h(s){return function(t){for(var e,n=t.length,i=new Array(n),r=new Array(n),a=new Array(n),o=0;o<n;++o)e=l.rgb(t[o]),i[o]=e.r||0,r[o]=e.g||0,a[o]=e.b||0;return i=s(i),r=s(r),a=s(a),e.opacity=1,function(t){return e.r=i(t),e.g=r(t),e.b=a(t),e+""}}}var f=h(e),d=h(n);function p(e,n){n=n||[];var i,r=e?Math.min(n.length,e.length):0,a=n.slice();return function(t){for(i=0;i<r;++i)a[i]=e[i]*(1-t)+n[i]*t;return a}}function g(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function m(t,e){for(var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),a=new Array(n),o=0;o<i;++o)r[o]=C(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(t){for(o=0;o<i;++o)a[o]=r[o](t);return a}}function v(e,n){var i=new Date;return e=+e,n=+n,function(t){return i.setTime(e*(1-t)+n*t),i}}function y(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}function b(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),e=null===e||"object"!=typeof e?{}:e)n in t?i[n]=C(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var _=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(_.source,"g");function w(t,i){var e,n,r,a,o,s=_.lastIndex=x.lastIndex=0,l=-1,u=[],c=[];for(t+="",i+="";(e=_.exec(t))&&(n=x.exec(i));)(r=n.index)>s&&(r=i.slice(s,r),u[l]?u[l]+=r:u[++l]=r),(e=e[0])===(n=n[0])?u[l]?u[l]+=n:u[++l]=n:(u[++l]=null,c.push({i:l,x:y(e,n)})),s=x.lastIndex;return s<i.length&&(r=i.slice(s),u[l]?u[l]+=r:u[++l]=r),u.length<2?c[0]?(o=c[0].x,function(t){return o(t)+""}):(a=i,function(){return a}):(i=c.length,function(t){for(var e,n=0;n<i;++n)u[(e=c[n]).i]=e.x(t);return u.join("")})}function C(t,e){var n=typeof e;return null==e||"boolean"==n?o(e):("number"==n?y:"string"==n?(n=l.color(e))?(e=n,s):w:e instanceof l.color?s:e instanceof Date?v:g(e)?p:Array.isArray(e)?m:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?b:y)(t,e)}var S,M,k,L,T=180/Math.PI,D={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function A(t,e,n,i,r,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*T,skewX:Math.atan(l)*T,scaleX:o,scaleY:s}}function B(h,f,d,p){function g(t){return t.length?t.pop()+" ":""}return function(t,e){var n,i,r,a,o,s,l,u=[],c=[];return t=h(t),e=h(e),r=t.translateX,a=t.translateY,l=e.translateX,s=e.translateY,o=u,n=c,r!==l||a!==s?(i=o.push("translate(",null,f,null,d),n.push({i:i-4,x:y(r,l)},{i:i-2,x:y(a,s)})):(l||s)&&o.push("translate("+l+f+s+d),n=t.rotate,r=e.rotate,i=u,a=c,n!==r?(180<n-r?r+=360:180<r-n&&(n+=360),a.push({i:i.push(g(i)+"rotate(",null,p)-2,x:y(n,r)})):r&&i.push(g(i)+"rotate("+r+p),o=t.skewX,l=e.skewX,s=u,a=c,o!==l?a.push({i:s.push(g(s)+"skewX(",null,p)-2,x:y(o,l)}):l&&s.push(g(s)+"skewX("+l+p),n=t.scaleX,i=t.scaleY,r=e.scaleX,a=e.scaleY,o=u,s=c,n!==r||i!==a?(l=o.push(g(o)+"scale(",null,",",null,")"),s.push({i:l-4,x:y(n,r)},{i:l-2,x:y(i,a)})):1===r&&1===a||o.push(g(o)+"scale("+r+","+a+")"),t=e=null,function(t){for(var e,n=-1,i=c.length;++n<i;)u[(e=c[n]).i]=e.x(t);return u.join("")}}}var P=B(function(t){return"none"===t?D:(S||(S=document.createElement("DIV"),M=document.documentElement,k=document.defaultView),S.style.transform=t,t=k.getComputedStyle(M.appendChild(S),null).getPropertyValue("transform"),M.removeChild(S),A(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),E=B(function(t){return null==t?D:((L=L||document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("transform",t),(t=L.transform.baseVal.consolidate())?A((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):D)},", ",")",")"),O=Math.SQRT2;function I(t){return((t=Math.exp(t))+1/t)/2}function F(o){return function(e,t){var n=o((e=l.hsl(e)).h,(t=l.hsl(t)).h),i=c(e.s,t.s),r=c(e.l,t.l),a=c(e.opacity,t.opacity);return function(t){return e.h=n(t),e.s=i(t),e.l=r(t),e.opacity=a(t),e+""}}}var j=F(r),N=F(c);function R(o){return function(e,t){var n=o((e=l.hcl(e)).h,(t=l.hcl(t)).h),i=c(e.c,t.c),r=c(e.l,t.l),a=c(e.opacity,t.opacity);return function(t){return e.h=n(t),e.c=i(t),e.l=r(t),e.opacity=a(t),e+""}}}var W=R(r),H=R(c);function z(s){return function t(o){function e(e,t){var n=s((e=l.cubehelix(e)).h,(t=l.cubehelix(t)).h),i=c(e.s,t.s),r=c(e.l,t.l),a=c(e.opacity,t.opacity);return function(t){return e.h=n(t),e.s=i(t),e.l=r(Math.pow(t,o)),e.opacity=a(t),e+""}}return o=+o,e.gamma=t,e}(1)}var q=z(r),G=z(c);t.interpolate=C,t.interpolateArray=function(t,e){return(g(e)?p:m)(t,e)},t.interpolateBasis=e,t.interpolateBasisClosed=n,t.interpolateCubehelix=q,t.interpolateCubehelixLong=G,t.interpolateDate=v,t.interpolateDiscrete=function(e){var n=e.length;return function(t){return e[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}},t.interpolateHcl=W,t.interpolateHclLong=H,t.interpolateHsl=j,t.interpolateHslLong=N,t.interpolateHue=function(t,e){var n=r(+t,+e);return function(t){t=n(t);return t-360*Math.floor(t/360)}},t.interpolateLab=function(e,t){var n=c((e=l.lab(e)).l,(t=l.lab(t)).l),i=c(e.a,t.a),r=c(e.b,t.b),a=c(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=i(t),e.b=r(t),e.opacity=a(t),e+""}},t.interpolateNumber=y,t.interpolateNumberArray=p,t.interpolateObject=b,t.interpolateRgb=s,t.interpolateRgbBasis=f,t.interpolateRgbBasisClosed=d,t.interpolateRound=function(e,n){return e=+e,n=+n,function(t){return Math.round(e*(1-t)+n*t)}},t.interpolateString=w,t.interpolateTransformCss=P,t.interpolateTransformSvg=E,t.interpolateZoom=function(t,e){var i,r,a,n,o=t[0],s=t[1],l=t[2],u=e[0],t=e[1],e=e[2],c=u-o,h=t-s;return(n=(u=c*c+h*h)<1e-12?(a=Math.log(e/l)/O,function(t){return[o+t*c,s+t*h,l*Math.exp(O*t*a)]}):(i=Math.sqrt(u),t=(e*e-l*l+4*u)/(2*l*2*i),n=(e*e-l*l-4*u)/(2*e*2*i),r=Math.log(Math.sqrt(t*t+1)-t),a=(Math.log(Math.sqrt(n*n+1)-n)-r)/O,function(t){var e=t*a,n=I(r),t=l/(2*i)*(n*(t=O*e+r,((t=Math.exp(2*t))-1)/(t+1))-(t=r,((t=Math.exp(t))-1/t)/2));return[o+t*c,s+t*h,l*n/I(O*e+r)]})).duration=1e3*a,n},t.piecewise=function(t,e){for(var n=0,i=e.length-1,r=e[0],a=new Array(i<0?0:i);n<i;)a[n]=t(r,r=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return a[e](t-e)}},t.quantize=function(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-color")):"function"==typeof define&&define.amd?define(["exports","d3-color"],r):r((i=i||self).d3=i.d3||{},i.d3)},{"d3-color":16}],28:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";var p=Math.PI,h=2*p,f=h-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function n(){return new e}e.prototype=n.prototype={constructor:e,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,n,i,r){var a,o,s=this._x1,l=this._y1,u=(n=+n)-(t=+t),c=(i=+i)-(e=+e),h=s-t,f=l-e,d=h*h+f*f;if((r=+r)<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+(this._x1=t)+","+(this._y1=e):1e-6<d&&(1e-6<Math.abs(f*u-c*h)&&r?(o=u*u+c*c,s=(a=n-s)*a+(n=i-l)*n,i=Math.sqrt(o),l=Math.sqrt(d),l=(s=r*Math.tan((p-Math.acos((o+d-s)/(2*i*l)))/2))/l,i=s/i,1e-6<Math.abs(l-1)&&(this._+="L"+(t+l*h)+","+(e+l*f)),this._+="A"+r+","+r+",0,0,"+ +(h*n<f*a)+","+(this._x1=t+i*u)+","+(this._y1=e+i*c)):this._+="L"+(this._x1=t)+","+(this._y1=e))},arc:function(t,e,n,i,r,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(i),s=n*Math.sin(i),l=t+o,u=e+s,c=1^a,i=a?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+u:(1e-6<Math.abs(this._x1-l)||1e-6<Math.abs(this._y1-u))&&(this._+="L"+l+","+u),n&&(f<(i=i<0?i%h+h:i)?this._+="A"+n+","+n+",0,1,"+c+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):1e-6<i&&(this._+="A"+n+","+n+",0,"+ +(p<=i)+","+c+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}},t.path=n,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],29:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";function c(t,e){return t[0]-e[0]||t[1]-e[1]}function h(t){for(var e,n,i,r=t.length,a=[0,1],o=2,s=2;s<r;++s){for(;1<o&&(e=t[a[o-2]],n=t[a[o-1]],i=t[s],(n[0]-e[0])*(i[1]-e[1])-(n[1]-e[1])*(i[0]-e[0])<=0);)--o;a[o++]=s}return a.slice(0,o)}t.polygonArea=function(t){for(var e,n=-1,i=t.length,r=t[i-1],a=0;++n<i;)e=r,r=t[n],a+=e[1]*r[0]-e[0]*r[1];return a/2},t.polygonCentroid=function(t){for(var e,n,i=-1,r=t.length,a=0,o=0,s=t[r-1],l=0;++i<r;)e=s,s=t[i],l+=n=e[0]*s[1]-s[0]*e[1],a+=(e[0]+s[0])*n,o+=(e[1]+s[1])*n;return[a/(l*=3),o/l]},t.polygonContains=function(t,e){for(var n,i,r=t.length,a=t[r-1],o=e[0],s=e[1],l=a[0],u=a[1],c=!1,h=0;h<r;++h)n=(a=t[h])[0],s<(i=a[1])!=s<u&&o<(l-n)*(s-i)/(u-i)+n&&(c=!c),l=n,u=i;return c},t.polygonHull=function(t){if((e=t.length)<3)return null;for(var e,n=new Array(e),i=new Array(e),r=0;r<e;++r)n[r]=[+t[r][0],+t[r][1],r];for(n.sort(c),r=0;r<e;++r)i[r]=[n[r][0],-n[r][1]];var a=h(n),o=h(i),s=o[0]===a[0],l=o[o.length-1]===a[a.length-1],u=[];for(r=a.length-1;0<=r;--r)u.push(t[n[a[r]][2]]);for(r=+s;r<o.length-l;++r)u.push(t[n[o[r]][2]]);return u},t.polygonLength=function(t){for(var e,n,i=-1,r=t.length,a=t[r-1],o=a[0],s=a[1],l=0;++i<r;)e=o,n=s,e-=o=(a=t[i])[0],n-=s=a[1],l+=Math.sqrt(e*e+n*n);return l},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],30:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";function f(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,a,o,s,l,u,c,h,f,d=t._root,p={data:i},g=t._x0,m=t._y0,v=t._x1,y=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((u=e>=(a=(g+v)/2))?g=a:v=a,(c=n>=(o=(m+y)/2))?m=o:y=o,!(d=(r=d)[h=c<<1|u]))return r[h]=p,t;if(s=+t._x.call(null,d.data),l=+t._y.call(null,d.data),e===s&&n===l)return p.next=d,r?r[h]=p:t._root=p,t;for(;r=r?r[h]=new Array(4):t._root=new Array(4),(u=e>=(a=(g+v)/2))?g=a:v=a,(c=n>=(o=(m+y)/2))?m=o:y=o,(h=c<<1|u)==(f=(o<=l)<<1|a<=s););return r[f]=d,r[h]=p,t}function v(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function i(t){return t[0]}function r(t){return t[1]}function e(t,e,n){n=new a(null==e?i:e,null==n?r:n,NaN,NaN,NaN,NaN);return null==t?n:n.addAll(t)}function a(t,e,n,i,r,a){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=a,this._root=void 0}function o(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var n=e.prototype=a.prototype;n.copy=function(){var t,e,n=new a(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=o(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var r=0;r<4;++r)(e=i.source[r])&&(e.length?t.push({source:e,target:i.target[r]=new Array(4)}):i.target[r]=o(e));return n},n.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return f(this.cover(e,n),e,n,t)},n.addAll=function(t){for(var e,n,i,r=t.length,a=new Array(r),o=new Array(r),s=1/0,l=1/0,u=-1/0,c=-1/0,h=0;h<r;++h)isNaN(n=+this._x.call(null,e=t[h]))||isNaN(i=+this._y.call(null,e))||((a[h]=n)<s&&(s=n),u<n&&(u=n),(o[h]=i)<l&&(l=i),c<i&&(c=i));if(u<s||c<l)return this;for(this.cover(s,l).cover(u,c),h=0;h<r;++h)f(this,a[h],o[h],t[h]);return this},n.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,a=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,a=(i=Math.floor(e))+1;else{for(var o,s,l=r-n,u=this._root;t<n||r<=t||e<i||a<=e;)switch(s=(e<i)<<1|t<n,(o=new Array(4))[s]=u,u=o,l*=2,s){case 0:r=n+l,a=i+l;break;case 1:n=r-l,a=i+l;break;case 2:r=n+l,i=a-l;break;case 3:n=r-l,i=a-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=i,this._x1=r,this._y1=a,this},n.data=function(){var e=[];return this.visit(function(t){if(!t.length)for(;e.push(t.data),t=t.next;);}),e},n.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},n.find=function(t,e,n){var i,r,a,o,s,l,u,c,h=this._x0,f=this._y0,d=this._x1,p=this._y1,g=[],m=this._root;for(m&&g.push(new v(m,h,f,d,p)),null==n?n=1/0:(h=t-n,f=e-n,d=t+n,p=e+n,n*=n);u=g.pop();)!(m=u.node)||(i=u.x0)>d||(r=u.y0)>p||(a=u.x1)<h||(o=u.y1)<f||(m.length?(g.push(new v(m[3],s=(i+a)/2,l=(r+o)/2,a,o),new v(m[2],i,l,s,o),new v(m[1],s,r,a,l),new v(m[0],i,r,s,l)),(s=(l<=e)<<1|s<=t)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-s],g[g.length-1-s]=u)):(u=(u=t-+this._x.call(null,m.data))*u+(u=e-+this._y.call(null,m.data))*u)<n&&(h=t-(u=Math.sqrt(n=u)),f=e-u,d=t+u,p=e+u,c=m.data));return c},n.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,i,r,a,o,s,l,u,c,h,f=this._root,d=this._x0,p=this._y0,g=this._x1,m=this._y1;if(!f)return this;if(f.length)for(;;){if((l=a>=(u=(d+g)/2))?d=u:g=u,(u=o>=(s=(p+m)/2))?p=s:m=s,!(f=(e=f)[c=u<<1|l]))return this;if(!f.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(n=e,h=c)}for(;f.data!==t;)if(!(f=(i=f).next))return this;return(r=f.next)&&delete f.next,i?r?i.next=r:delete i.next:e?(r?e[c]=r:delete e[c],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[h]=f:this._root=f)):this._root=r,this},n.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},n.root=function(){return this._root},n.size=function(){var e=0;return this.visit(function(t){if(!t.length)for(;++e,t=t.next;);}),e},n.visit=function(t){var e,n,i,r,a,o,s,l=[],u=this._root;for(u&&l.push(new v(u,this._x0,this._y0,this._x1,this._y1));e=l.pop();)!t(u=e.node,n=e.x0,i=e.y0,r=e.x1,a=e.y1)&&u.length&&(o=(n+r)/2,s=(i+a)/2,(e=u[3])&&l.push(new v(e,o,s,r,a)),(e=u[2])&&l.push(new v(e,n,s,o,a)),(e=u[1])&&l.push(new v(e,o,i,r,s)),(e=u[0])&&l.push(new v(e,n,i,o,s)));return this},n.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new v(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var r,a,o,s,l,u,c,h=e.node;h.length&&(a=e.x0,o=e.y0,u=(a+(s=e.x1))/2,c=(o+(l=e.y1))/2,(r=h[0])&&n.push(new v(r,a,o,u,c)),(r=h[1])&&n.push(new v(r,u,o,s,c)),(r=h[2])&&n.push(new v(r,a,c,u,l)),(r=h[3])&&n.push(new v(r,u,c,s,l))),i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},n.x=function(t){return arguments.length?(this._x=t,this):this._x},n.y=function(t){return arguments.length?(this._y=t,this):this._y},t.quadtree=e,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],31:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";function e(){return Math.random()}var n=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return n()*e+t}}return e.source=t,e}(e),i=function t(a){function e(e,n){var i,r;return e=null==e?0:+e,n=null==n?1:+n,function(){var t;if(null!=i)t=i,i=null;else for(;i=2*a()-1,t=2*a()-1,!(r=i*i+t*t)||1<r;);return e+n*t*Math.sqrt(-2*Math.log(r)/r)}}return e.source=t,e}(e),r=function t(e){function n(){var t=i.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(e),a=function t(i){function e(n){return function(){for(var t=0,e=0;e<n;++e)t+=i();return t}}return e.source=t,e}(e),o=function t(n){function e(t){var e=a.source(n)(t);return function(){return e()/t}}return e.source=t,e}(e),s=function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(e);t.randomUniform=n,t.randomNormal=i,t.randomLogNormal=r,t.randomBates=o,t.randomIrwinHall=a,t.randomExponential=s,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(i.d3=i.d3||{})},{}],32:[function(t,e,n){var i,r;i=this,r=function(t,e,n){"use strict";function i(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n}var r=i("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),a=i("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),o=i("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),s=i("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),l=i("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),u=i("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),c=i("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),h=i("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),f=i("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),d=i("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function p(t){return e.interpolateRgbBasis(t[t.length-1])}var g=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(i),m=p(g),v=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(i),y=p(v),b=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(i),_=p(b),x=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(i),w=p(x),C=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(i),S=p(C),M=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(i),k=p(M),L=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(i),T=p(L),D=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(i),A=p(D),B=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(i),P=p(B),E=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(i),O=p(E),I=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(i),F=p(I),j=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(i),N=p(j),R=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(i),W=p(R),H=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(i),z=p(H),q=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(i),G=p(q),U=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(i),$=p(U),K=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(i),Y=p(K),V=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(i),X=p(V),J=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(i),Z=p(J),Q=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(i),tt=p(Q),et=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(i),nt=p(et),it=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(i),rt=p(it),at=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(i),ot=p(at),st=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(i),lt=p(st),ut=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(i),ct=p(ut),ht=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(i),ft=p(ht),dt=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(i),pt=p(dt);var gt=e.interpolateCubehelixLong(n.cubehelix(300,.5,0),n.cubehelix(-240,.5,1)),mt=e.interpolateCubehelixLong(n.cubehelix(-100,.75,.35),n.cubehelix(80,1.5,.8)),vt=e.interpolateCubehelixLong(n.cubehelix(260,.75,.35),n.cubehelix(80,1.5,.8)),yt=n.cubehelix();var bt=n.rgb(),_t=Math.PI/3,xt=2*Math.PI/3;function wt(e){var n=e.length;return function(t){return e[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}}var Ct=wt(i("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),St=wt(i("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Mt=wt(i("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),n=wt(i("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));t.interpolateBlues=rt,t.interpolateBrBG=m,t.interpolateBuGn=O,t.interpolateBuPu=F,t.interpolateCividis=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},t.interpolateCool=vt,t.interpolateCubehelixDefault=gt,t.interpolateGnBu=N,t.interpolateGreens=ot,t.interpolateGreys=lt,t.interpolateInferno=Mt,t.interpolateMagma=St,t.interpolateOrRd=W,t.interpolateOranges=pt,t.interpolatePRGn=y,t.interpolatePiYG=_,t.interpolatePlasma=n,t.interpolatePuBu=G,t.interpolatePuBuGn=z,t.interpolatePuOr=w,t.interpolatePuRd=$,t.interpolatePurples=ct,t.interpolateRainbow=function(t){(t<0||1<t)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return yt.h=360*t-100,yt.s=1.5-1.5*e,yt.l=.8-.9*e,yt+""},t.interpolateRdBu=S,t.interpolateRdGy=k,t.interpolateRdPu=Y,t.interpolateRdYlBu=T,t.interpolateRdYlGn=A,t.interpolateReds=ft,t.interpolateSinebow=function(t){var e;return t=(.5-t)*Math.PI,bt.r=255*(e=Math.sin(t))*e,bt.g=255*(e=Math.sin(t+_t))*e,bt.b=255*(e=Math.sin(t+xt))*e,bt+""},t.interpolateSpectral=P,t.interpolateTurbo=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"},t.interpolateViridis=Ct,t.interpolateWarm=mt,t.interpolateYlGn=Z,t.interpolateYlGnBu=X,t.interpolateYlOrBr=tt,t.interpolateYlOrRd=nt,t.schemeAccent=a,t.schemeBlues=it,t.schemeBrBG=g,t.schemeBuGn=E,t.schemeBuPu=I,t.schemeCategory10=r,t.schemeDark2=o,t.schemeGnBu=j,t.schemeGreens=at,t.schemeGreys=st,t.schemeOrRd=R,t.schemeOranges=dt,t.schemePRGn=v,t.schemePaired=s,t.schemePastel1=l,t.schemePastel2=u,t.schemePiYG=b,t.schemePuBu=q,t.schemePuBuGn=H,t.schemePuOr=x,t.schemePuRd=U,t.schemePurples=ut,t.schemeRdBu=C,t.schemeRdGy=M,t.schemeRdPu=K,t.schemeRdYlBu=L,t.schemeRdYlGn=D,t.schemeReds=ht,t.schemeSet1=c,t.schemeSet2=h,t.schemeSet3=f,t.schemeSpectral=B,t.schemeTableau10=d,t.schemeYlGn=J,t.schemeYlGnBu=V,t.schemeYlOrBr=Q,t.schemeYlOrRd=et,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-interpolate"),t("d3-color")):"function"==typeof define&&define.amd?define(["exports","d3-interpolate","d3-color"],r):r((i=i||self).d3=i.d3||{},i.d3,i.d3)},{"d3-color":16,"d3-interpolate":27}],33:[function(t,e,n){var i,r;i=this,r=function(t,l,S,d,s,e,n){"use strict";function p(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function i(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var r=Array.prototype,M=r.map,g=r.slice,u={name:"implicit"};function m(){var a=l.map(),o=[],i=[],r=u;function s(t){var e=t+"",n=a.get(e);if(!n){if(r!==u)return r;a.set(e,n=o.push(t))}return i[(n-1)%i.length]}return s.domain=function(t){if(!arguments.length)return o.slice();o=[],a=l.map();for(var e,n,i=-1,r=t.length;++i<r;)a.has(n=(e=t[i])+"")||a.set(n,o.push(e));return s},s.range=function(t){return arguments.length?(i=g.call(t),s):i.slice()},s.unknown=function(t){return arguments.length?(r=t,s):r},s.copy=function(){return m(o,i).unknown(r)},p.apply(s,arguments),s}function v(){var r,a,t=m().unknown(void 0),o=t.domain,s=t.range,l=[0,1],u=!1,c=0,h=0,f=.5;function e(){var t=o().length,e=l[1]<l[0],n=l[+e],i=l[1-e];r=(i-n)/Math.max(1,t-c+2*h),u&&(r=Math.floor(r)),n+=(i-n-r*(t-c))*f,a=r*(1-c),u&&(n=Math.round(n),a=Math.round(a));t=S.range(t).map(function(t){return n+r*t});return s(e?t.reverse():t)}return delete t.unknown,t.domain=function(t){return arguments.length?(o(t),e()):o()},t.range=function(t){return arguments.length?(l=[+t[0],+t[1]],e()):l.slice()},t.rangeRound=function(t){return l=[+t[0],+t[1]],u=!0,e()},t.bandwidth=function(){return a},t.step=function(){return r},t.round=function(t){return arguments.length?(u=!!t,e()):u},t.padding=function(t){return arguments.length?(c=Math.min(1,h=+t),e()):c},t.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),e()):c},t.paddingOuter=function(t){return arguments.length?(h=+t,e()):h},t.align=function(t){return arguments.length?(f=Math.max(0,Math.min(1,t)),e()):f},t.copy=function(){return v(o(),l).round(u).paddingInner(c).paddingOuter(h).align(f)},p.apply(e(),arguments)}function y(t){return+t}var b=[0,1];function k(t){return t}function c(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:(t=isNaN(n)?NaN:.5,function(){return t});var t}function _(t){var e=t[0],n=t[t.length-1];return n<e&&(t=e,e=n,n=t),function(t){return Math.max(e,Math.min(n,t))}}function x(t,e,n){var i=t[0],t=t[1],r=e[0],e=e[1],r=t<i?(i=c(t,i),n(e,r)):(i=c(i,t),n(r,e));return function(t){return r(i(t))}}function w(n,t,e){var i=Math.min(n.length,t.length)-1,r=new Array(i),a=new Array(i),o=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=c(n[o],n[o+1]),a[o]=e(t[o],t[o+1]);return function(t){var e=S.bisect(n,t,1,i)-1;return a[e](r[e](t))}}function L(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function a(){var n,i,e,r,a,o,s=b,l=b,u=d.interpolate,c=k;function h(){return r=2<Math.min(s.length,l.length)?w:x,a=o=null,f}function f(t){return isNaN(t=+t)?e:(a=a||r(s.map(n),l,u))(n(c(t)))}return f.invert=function(t){return c(i((o=o||r(l,s.map(n),d.interpolateNumber))(t)))},f.domain=function(t){return arguments.length?(s=M.call(t,y),c===k||(c=_(s)),h()):s.slice()},f.range=function(t){return arguments.length?(l=g.call(t),h()):l.slice()},f.rangeRound=function(t){return l=g.call(t),u=d.interpolateRound,h()},f.clamp=function(t){return arguments.length?(c=t?_(s):k,f):c!==k},f.interpolate=function(t){return arguments.length?(u=t,h()):u},f.unknown=function(t){return arguments.length?(e=t,f):e},function(t,e){return n=t,i=e,h()}}function T(t,e){return a()(t,e)}function o(t,e,n,i){var r,a=S.tickStep(t,e,n);switch((i=s.formatSpecifier(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=s.precisionPrefix(a,o))||(i.precision=r),s.formatPrefix(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=s.precisionRound(a,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=s.precisionFixed(a))||(i.precision=r-2*("%"===i.type))}return s.format(i)}function h(s){var l=s.domain;return s.ticks=function(t){var e=l();return S.ticks(e[0],e[e.length-1],null==t?10:t)},s.tickFormat=function(t,e){var n=l();return o(n[0],n[n.length-1],null==t?10:t,e)},s.nice=function(t){null==t&&(t=10);var e,n=l(),i=0,r=n.length-1,a=n[i],o=n[r];return o<a&&(e=a,a=o,o=e,e=i,i=r,r=e),0<(e=S.tickIncrement(a,o,t))?(a=Math.floor(a/e)*e,o=Math.ceil(o/e)*e,e=S.tickIncrement(a,o,t)):e<0&&(a=Math.ceil(a*e)/e,o=Math.floor(o*e)/e,e=S.tickIncrement(a,o,t)),0<e?(n[i]=Math.floor(a/e)*e,n[r]=Math.ceil(o/e)*e,l(n)):e<0&&(n[i]=Math.ceil(a*e)/e,n[r]=Math.floor(o*e)/e,l(n)),s},s}function D(t,e){var n,i=0,r=(t=t.slice()).length-1,a=t[i],o=t[r];return o<a&&(n=i,i=r,r=n,n=a,a=o,o=n),t[i]=e.floor(a),t[r]=e.ceil(o),t}function C(t){return Math.log(t)}function A(t){return Math.exp(t)}function B(t){return-Math.log(-t)}function P(t){return-Math.exp(-t)}function E(t){return isFinite(t)?+("1e"+t):t<0?0:t}function O(e){return function(t){return-e(-t)}}function f(t){var c,h,r=t(C,A),f=r.domain,d=10;function e(){var e,n;return c=(n=d)===Math.E?Math.log:10===n&&Math.log10||2===n&&Math.log2||(n=Math.log(n),function(t){return Math.log(t)/n}),h=10===(e=d)?E:e===Math.E?Math.exp:function(t){return Math.pow(e,t)},f()[0]<0?(c=O(c),h=O(h),t(B,P)):t(C,A),r}return r.base=function(t){return arguments.length?(d=+t,e()):d},r.domain=function(t){return arguments.length?(f(t),e()):f()},r.ticks=function(t){var e=f(),n=e[0],i=e[e.length-1];(e=i<n)&&(s=n,n=i,i=s);var r,a,o,s=c(n),l=c(i),t=null==t?10:+t,u=[];if(!(d%1)&&l-s<t){if(s=Math.round(s)-1,l=Math.round(l)+1,0<n){for(;s<l;++s)for(a=1,r=h(s);a<d;++a)if(!((o=r*a)<n)){if(i<o)break;u.push(o)}}else for(;s<l;++s)for(a=d-1,r=h(s);1<=a;--a)if(!((o=r*a)<n)){if(i<o)break;u.push(o)}}else u=S.ticks(s,l,Math.min(l-s,t)).map(h);return e?u.reverse():u},r.tickFormat=function(t,n){if("function"!=typeof(n=null==n?10===d?".0e":",":n)&&(n=s.format(n)),t===1/0)return n;null==t&&(t=10);var i=Math.max(1,d*t/r.ticks().length);return function(t){var e=t/h(Math.round(c(t)));return e*d<d-.5&&(e*=d),e<=i?n(t):""}},r.nice=function(){return f(D(f(),{floor:function(t){return h(Math.floor(c(t)))},ceil:function(t){return h(Math.ceil(c(t)))}}))},r}function I(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function F(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function j(e){var n=1,t=e(I(n),F(n));return t.constant=function(t){return arguments.length?e(I(n=+t),F(n)):n},h(t)}function N(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function R(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function W(t){return t<0?-t*t:t*t}function H(e){var t=e(k,k),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(k,k):.5===n?e(R,W):e(N(n),N(1/n)):n},h(t)}function z(){var t=H(a());return t.copy=function(){return L(t,z()).exponent(t.exponent())},p.apply(t,arguments),t}var q=1e3,G=60*q,U=60*G,$=24*U,K=7*$,Y=30*$,V=365*$;function X(t){return new Date(t)}function J(t){return t instanceof Date?+t:+new Date(+t)}function Z(o,e,n,i,r,a,s,l,u){var c=T(k,k),h=c.invert,f=c.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),_=u("%Y"),x=[[s,1,q],[s,5,5*q],[s,15,15*q],[s,30,30*q],[a,1,G],[a,5,5*G],[a,15,15*G],[a,30,30*G],[r,1,U],[r,3,3*U],[r,6,6*U],[r,12,12*U],[i,1,$],[i,2,2*$],[n,1,K],[e,1,Y],[e,3,3*Y],[o,1,V]];function w(t){return(s(t)<t?d:a(t)<t?p:r(t)<t?g:i(t)<t?m:e(t)<t?n(t)<t?v:y:o(t)<t?b:_)(t)}function C(t,e,n,i){var r,a;return"number"==typeof(t=null==t?10:t)&&(r=Math.abs(n-e)/t,t=(a=S.bisector(function(t){return t[2]}).right(x,r))===x.length?(i=S.tickStep(e/V,n/V,t),o):a?(i=(a=x[r/x[a-1][2]<x[a][2]/r?a-1:a])[1],a[0]):(i=Math.max(S.tickStep(e,n,t),1),l)),null==i?t:t.every(i)}return c.invert=function(t){return new Date(h(t))},c.domain=function(t){return arguments.length?f(M.call(t,J)):f().map(X)},c.ticks=function(t,e){var n,i=f(),r=i[0],a=i[i.length-1],i=a<r;return i&&(n=r,r=a,a=n),n=(n=C(t,r,a,e))?n.range(r,a+1):[],i?n.reverse():n},c.tickFormat=function(t,e){return null==e?w:u(e)},c.nice=function(t,e){var n=f();return(t=C(t,n[0],n[n.length-1],e))?f(D(n,t)):c},c.copy=function(){return L(c,Z(o,e,n,i,r,a,s,l,u))},c}function Q(){var e,n,i,r,a,o=0,s=1,l=k,u=!1;function c(t){return isNaN(t=+t)?a:l(0===i?.5:(t=(r(t)-e)*i,u?Math.max(0,Math.min(1,t)):t))}return c.domain=function(t){return arguments.length?(e=r(o=+t[0]),n=r(s=+t[1]),i=e===n?0:1/(n-e),c):[o,s]},c.clamp=function(t){return arguments.length?(u=!!t,c):u},c.interpolator=function(t){return arguments.length?(l=t,c):l},c.unknown=function(t){return arguments.length?(a=t,c):a},function(t){return e=(r=t)(o),n=t(s),i=e===n?0:1/(n-e),c}}function tt(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function et(){var t=H(Q());return t.copy=function(){return tt(t,et()).exponent(t.exponent())},i.apply(t,arguments)}function nt(){var e,n,i,r,a,o,s,l=0,u=.5,c=1,h=k,f=!1;function d(t){return isNaN(t=+t)?s:(t=.5+((t=+o(t))-n)*(t<n?r:a),h(f?Math.max(0,Math.min(1,t)):t))}return d.domain=function(t){return arguments.length?(e=o(l=+t[0]),n=o(u=+t[1]),i=o(c=+t[2]),r=e===n?0:.5/(n-e),a=n===i?0:.5/(i-n),d):[l,u,c]},d.clamp=function(t){return arguments.length?(f=!!t,d):f},d.interpolator=function(t){return arguments.length?(h=t,d):h},d.unknown=function(t){return arguments.length?(s=t,d):s},function(t){return e=(o=t)(l),n=t(u),i=t(c),r=e===n?0:.5/(n-e),a=n===i?0:.5/(i-n),d}}function it(){var t=H(nt());return t.copy=function(){return tt(t,it()).exponent(t.exponent())},i.apply(t,arguments)}t.scaleBand=v,t.scalePoint=function(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t(n())},e}(v.apply(null,arguments).paddingInner(1))},t.scaleIdentity=function t(e){var n;function i(t){return isNaN(t=+t)?n:t}return(i.invert=i).domain=i.range=function(t){return arguments.length?(e=M.call(t,y),i):e.slice()},i.unknown=function(t){return arguments.length?(n=t,i):n},i.copy=function(){return t(e).unknown(n)},e=arguments.length?M.call(e,y):[0,1],h(i)},t.scaleLinear=function t(){var e=T(k,k);return e.copy=function(){return L(e,t())},p.apply(e,arguments),h(e)},t.scaleLog=function t(){var e=f(a()).domain([1,10]);return e.copy=function(){return L(e,t()).base(e.base())},p.apply(e,arguments),e},t.scaleSymlog=function t(){var e=j(a());return e.copy=function(){return L(e,t()).constant(e.constant())},p.apply(e,arguments)},t.scaleOrdinal=m,t.scaleImplicit=u,t.scalePow=z,t.scaleSqrt=function(){return z.apply(null,arguments).exponent(.5)},t.scaleQuantile=function t(){var e,r=[],n=[],i=[];function a(){var t=0,e=Math.max(1,n.length);for(i=new Array(e-1);++t<e;)i[t-1]=S.quantile(r,t/e);return o}function o(t){return isNaN(t=+t)?e:n[S.bisect(i,t)]}return o.invertExtent=function(t){return(t=n.indexOf(t))<0?[NaN,NaN]:[0<t?i[t-1]:r[0],t<i.length?i[t]:r[r.length-1]]},o.domain=function(t){if(!arguments.length)return r.slice();r=[];for(var e,n=0,i=t.length;n<i;++n)null==(e=t[n])||isNaN(e=+e)||r.push(e);return r.sort(S.ascending),a()},o.range=function(t){return arguments.length?(n=g.call(t),a()):n.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return i.slice()},o.copy=function(){return t().domain(r).range(n).unknown(e)},p.apply(o,arguments)},t.scaleQuantize=function t(){var e,n=0,i=1,r=1,a=[.5],o=[0,1];function s(t){return t<=t?o[S.bisect(a,t,0,r)]:e}function l(){var t=-1;for(a=new Array(r);++t<r;)a[t]=((t+1)*i-(t-r)*n)/(r+1);return s}return s.domain=function(t){return arguments.length?(n=+t[0],i=+t[1],l()):[n,i]},s.range=function(t){return arguments.length?(r=(o=g.call(t)).length-1,l()):o.slice()},s.invertExtent=function(t){return(t=o.indexOf(t))<0?[NaN,NaN]:t<1?[n,a[0]]:r<=t?[a[r-1],i]:[a[t-1],a[t]]},s.unknown=function(t){return arguments.length&&(e=t),s},s.thresholds=function(){return a.slice()},s.copy=function(){return t().domain([n,i]).range(o).unknown(e)},p.apply(h(s),arguments)},t.scaleThreshold=function t(){var e,n=[.5],i=[0,1],r=1;function a(t){return t<=t?i[S.bisect(n,t,0,r)]:e}return a.domain=function(t){return arguments.length?(n=g.call(t),r=Math.min(n.length,i.length-1),a):n.slice()},a.range=function(t){return arguments.length?(i=g.call(t),r=Math.min(n.length,i.length-1),a):i.slice()},a.invertExtent=function(t){return t=i.indexOf(t),[n[t-1],n[t]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t().domain(n).range(i).unknown(e)},p.apply(a,arguments)},t.scaleTime=function(){return p.apply(Z(e.timeYear,e.timeMonth,e.timeWeek,e.timeDay,e.timeHour,e.timeMinute,e.timeSecond,e.timeMillisecond,n.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},t.scaleUtc=function(){return p.apply(Z(e.utcYear,e.utcMonth,e.utcWeek,e.utcDay,e.utcHour,e.utcMinute,e.utcSecond,e.utcMillisecond,n.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},t.scaleSequential=function t(){var e=h(Q()(k));return e.copy=function(){return tt(e,t())},i.apply(e,arguments)},t.scaleSequentialLog=function t(){var e=f(Q()).domain([1,10]);return e.copy=function(){return tt(e,t()).base(e.base())},i.apply(e,arguments)},t.scaleSequentialPow=et,t.scaleSequentialSqrt=function(){return et.apply(null,arguments).exponent(.5)},t.scaleSequentialSymlog=function t(){var e=j(Q());return e.copy=function(){return tt(e,t()).constant(e.constant())},i.apply(e,arguments)},t.scaleSequentialQuantile=function t(){var r=[],e=k;function a(t){if(!isNaN(t=+t))return e((S.bisect(r,t)-1)/(r.length-1))}return a.domain=function(t){if(!arguments.length)return r.slice();r=[];for(var e,n=0,i=t.length;n<i;++n)null==(e=t[n])||isNaN(e=+e)||r.push(e);return r.sort(S.ascending),a},a.interpolator=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t(e).domain(r)},i.apply(a,arguments)},t.scaleDiverging=function t(){var e=h(nt()(k));return e.copy=function(){return tt(e,t())},i.apply(e,arguments)},t.scaleDivergingLog=function t(){var e=f(nt()).domain([.1,1,10]);return e.copy=function(){return tt(e,t()).base(e.base())},i.apply(e,arguments)},t.scaleDivergingPow=it,t.scaleDivergingSqrt=function(){return it.apply(null,arguments).exponent(.5)},t.scaleDivergingSymlog=function t(){var e=j(nt());return e.copy=function(){return tt(e,t()).constant(e.constant())},i.apply(e,arguments)},t.tickFormat=o,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-collection"),t("d3-array"),t("d3-interpolate"),t("d3-format"),t("d3-time"),t("d3-time-format")):"function"==typeof define&&define.amd?define(["exports","d3-collection","d3-array","d3-interpolate","d3-format","d3-time","d3-time-format"],r):r(i.d3=i.d3||{},i.d3,i.d3,i.d3,i.d3,i.d3,i.d3)},{"d3-array":11,"d3-collection":15,"d3-format":24,"d3-interpolate":27,"d3-time":37,"d3-time-format":36}],34:[function(t,e,n){var i,r;i=this,r=function(a){"use strict";var i="http://www.w3.org/1999/xhtml",r={svg:"http://www.w3.org/2000/svg",xhtml:i,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function o(t){var e=t+="",n=e.indexOf(":");return 0<=n&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),r.hasOwnProperty(e)?{space:r[e],local:t}:t}function s(t){t=o(t);return(t.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===i&&t.documentElement.namespaceURI===i?t.createElement(n):t.createElementNS(e,n)}})(t)}function e(){}function h(t){return null==t?e:function(){return this.querySelector(t)}}function n(){return[]}function c(t){return null==t?n:function(){return this.querySelectorAll(t)}}function f(t){return function(){return this.matches(t)}}function t(t){return new Array(t.length)}function p(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var g="$";function w(t,e,n,i,r,a){for(var o,s=0,l=e.length,u=a.length;s<u;++s)(o=e[s])?(o.__data__=a[s],i[s]=o):n[s]=new p(t,a[s]);for(;s<l;++s)(o=e[s])&&(r[s]=o)}function C(t,e,n,i,r,a,o){for(var s,l,u={},c=e.length,h=a.length,f=new Array(c),d=0;d<c;++d)(s=e[d])&&(f[d]=l=g+o.call(s,s.__data__,d,e),l in u?r[d]=s:u[l]=s);for(d=0;d<h;++d)(s=u[l=g+o.call(t,a[d],d,a)])?((i[d]=s).__data__=a[d],u[l]=null):n[d]=new p(t,a[d]);for(d=0;d<c;++d)(s=e[d])&&u[f[d]]===s&&(r[d]=s)}function d(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}function l(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function u(t,e){return t.style.getPropertyValue(e)||l(t).getComputedStyle(t,null).getPropertyValue(e)}function m(t){return t.trim().split(/^|\s+/)}function v(t){return t.classList||new y(t)}function y(t){this._node=t,this._names=m(t.getAttribute("class")||"")}function b(t,e){for(var n=v(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function _(t,e){for(var n=v(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function x(){this.textContent=""}function S(){this.innerHTML=""}function M(){this.nextSibling&&this.parentNode.appendChild(this)}function k(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function L(){return null}function T(){var t=this.parentNode;t&&t.removeChild(this)}function D(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function A(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}y.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){t=this._names.indexOf(t);0<=t&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return 0<=this._names.indexOf(t)}};var B={};function P(n,t,e){return n=E(n,t,e),function(t){var e=t.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||n.call(this,t)}}function E(n,i,r){return function(t){var e=a.event;a.event=t;try{n.call(this,this.__data__,i,r)}finally{a.event=e}}}function O(a){return function(){var t=this.__on;if(t){for(var e,n=0,i=-1,r=t.length;n<r;++n)e=t[n],a.type&&e.type!==a.type||e.name!==a.name?t[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?t.length=i:delete this.__on}}}function I(l,u,c){var h=B.hasOwnProperty(l.type)?P:E;return function(t,e,n){var i,r=this.__on,a=h(u,e,n);if(r)for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===l.type&&i.name===l.name)return this.removeEventListener(i.type,i.listener,i.capture),this.addEventListener(i.type,i.listener=a,i.capture=c),void(i.value=u);this.addEventListener(l.type,a,c),i={type:l.type,name:l.name,value:u,listener:a,capture:c},r?r.push(i):this.__on=[i]}}function F(t,e,n){var i=l(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}a.event=null,"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(B={mouseenter:"mouseover",mouseleave:"mouseout"}));var j=[null];function N(t,e){this._groups=t,this._parents=e}function R(){return new N([[document.documentElement]],j)}function W(t){return"string"==typeof t?new N([[document.querySelector(t)]],[document.documentElement]):new N([[t]],j)}N.prototype=R.prototype={constructor:N,select:function(t){"function"!=typeof t&&(t=h(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o,s=e[r],l=s.length,u=i[r]=new Array(l),c=0;c<l;++c)(a=s[c])&&(o=t.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),u[c]=o);return new N(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=c(t));for(var e=this._groups,n=e.length,i=[],r=[],a=0;a<n;++a)for(var o,s=e[a],l=s.length,u=0;u<l;++u)(o=s[u])&&(i.push(t.call(o,o.__data__,u,s)),r.push(o));return new N(i,r)},filter:function(t){"function"!=typeof t&&(t=f(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o=e[r],s=o.length,l=i[r]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new N(i,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each(function(t){p[++c]=t}),p;var n,i=e?C:w,r=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),l=new Array(o),u=new Array(o),c=0;c<o;++c){var h=r[c],f=a[c],d=f.length,p=t.call(h,h&&h.__data__,c,r),g=p.length,m=l[c]=new Array(g),v=s[c]=new Array(g);i(h,f,m,v,u[c]=new Array(d),p,e);for(var y,b,_=0,x=0;_<g;++_)if(y=m[_]){for(x<=_&&(x=_+1);!(b=v[x])&&++x<g;);y._next=b||null}}return(s=new N(s,r))._enter=l,s._exit=u,s},enter:function(){return new N(this._enter||this._groups.map(t),this._parents)},exit:function(){return new N(this._exit||this._groups.map(t),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,a=this.exit(),i="function"==typeof t?t(i):i.append(t+"");return null!=e&&(r=e(r)),null==n?a.remove():n(a),i&&r?i.merge(r).order():r},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,t=n.length,r=Math.min(i,t),a=new Array(i),o=0;o<r;++o)for(var s,l=e[o],u=n[o],c=l.length,h=a[o]=new Array(c),f=0;f<c;++f)(s=l[f]||u[f])&&(h[f]=s);for(;o<i;++o)a[o]=e[o];return new N(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],a=r.length-1,o=r[a];0<=--a;)(i=r[a])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(n){function t(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}n=n||d;for(var e=this._groups,i=e.length,r=new Array(i),a=0;a<i;++a){for(var o,s=e[a],l=s.length,u=r[a]=new Array(l),c=0;c<l;++c)(o=s[c])&&(u[c]=o);u.sort(t)}return new N(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length;r<a;++r){var o=i[r];if(o)return o}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,a=e[n],o=0,s=a.length;o<s;++o)(r=a[o])&&t.call(r,r.__data__,o,a);return this},attr:function(t,e){var n=o(t);if(arguments.length<2){t=this.node();return n.local?t.getAttributeNS(n.space,n.local):t.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}:function(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return 1<arguments.length?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(e,n,i){return function(){var t=n.apply(this,arguments);null==t?this.style.removeProperty(e):this.style.setProperty(e,t,i)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):u(this.node(),t)},property:function(t,e){return 1<arguments.length?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(e,n){return function(){var t=n.apply(this,arguments);null==t?delete this[e]:this[e]=t}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=m(t+"");if(arguments.length<2){for(var i=v(this.node()),r=-1,a=n.length;++r<a;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?b:_)(this,t)}}:e?function(t){return function(){b(this,t)}}:function(t){return function(){_(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?x:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?S:("function"==typeof t?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(M)},lower:function(){return this.each(k)},append:function(t){var e="function"==typeof t?t:s(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:s(t),i=null==e?L:"function"==typeof e?e:h(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(T)},clone:function(t){return this.select(t?A:D)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,a=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return 0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),o=a.length;if(!(arguments.length<2)){for(s=e?I:O,null==n&&(n=!1),i=0;i<o;++i)this.each(s(a[i],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(i=0,l=s[u];i<o;++i)if((r=a[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return F(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return F(this,t,e)}})(t,e))}};var H=0;function z(){return new q}function q(){this._="@"+(++H).toString(36)}function G(){for(var t,e=a.event;t=e.sourceEvent;)e=t;return e}function U(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}q.prototype=z.prototype={constructor:q,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}},a.clientPoint=U,a.create=function(t){return W(s(t).call(document.documentElement))},a.creator=s,a.customEvent=function(t,e,n,i){var r=a.event;t.sourceEvent=a.event,a.event=t;try{return e.apply(n,i)}finally{a.event=r}},a.local=z,a.matcher=f,a.mouse=function(t){var e=G();return U(t,e=e.changedTouches?e.changedTouches[0]:e)},a.namespace=o,a.namespaces=r,a.select=W,a.selectAll=function(t){return"string"==typeof t?new N([document.querySelectorAll(t)],[document.documentElement]):new N([null==t?[]:t],j)},a.selection=R,a.selector=h,a.selectorAll=c,a.style=u,a.touch=function(t,e,n){arguments.length<3&&(n=e,e=G().changedTouches);for(var i,r=0,a=e?e.length:0;r<a;++r)if((i=e[r]).identifier===n)return U(t,i);return null},a.touches=function(t,e){for(var n=0,i=(e=null==e?G().touches:e)?e.length:0,r=new Array(i);n<i;++n)r[n]=U(t,e[n]);return r},a.window=l,Object.defineProperty(a,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],35:[function(t,e,n){var i,r;i=this,r=function(t,F){"use strict";function b(t){return function(){return t}}var j=Math.abs,N=Math.atan2,R=Math.cos,p=Math.max,W=Math.min,H=Math.sin,z=Math.sqrt,q=1e-12,G=Math.PI,U=G/2,$=2*G;function K(t){return 1<=t?U:t<=-1?-U:Math.asin(t)}function n(t){return t.innerRadius}function i(t){return t.outerRadius}function r(t){return t.startAngle}function a(t){return t.endAngle}function o(t){return t&&t.padAngle}function Y(t,e,n,i,r,a,o){var s=t-n,l=e-i,u=(o?a:-a)/z(s*s+l*l),c=u*l,h=-u*s,f=t+c,d=e+h,o=n+c,l=i+h,u=(f+o)/2,s=(d+l)/2,t=o-f,e=l-d,n=t*t+e*e,i=r-a,a=f*l-o*d,f=(e<0?-1:1)*z(p(0,i*i*n-a*a)),l=(a*e-t*f)/n,o=(-a*t-e*f)/n,d=(a*e+t*f)/n,e=(-a*t+e*f)/n,f=l-u,n=o-s,u=d-u,s=e-s;return u*u+s*s<f*f+n*n&&(l=d,o=e),{cx:l,cy:o,x01:-c,y01:-h,x11:l*(r/i-1),y11:o*(r/i-1)}}function e(t){this._context=t}function y(t){return new e(t)}function _(t){return t[0]}function x(t){return t[1]}function s(){var o=_,s=x,l=b(!0),u=null,c=y,h=null;function e(t){var e,n,i,r=t.length,a=!1;for(null==u&&(h=c(i=F.path())),e=0;e<=r;++e)!(e<r&&l(n=t[e],e,t))===a&&((a=!a)?h.lineStart():h.lineEnd()),a&&h.point(+o(n,e,t),+s(n,e,t));if(i)return h=null,i+""||null}return e.x=function(t){return arguments.length?(o="function"==typeof t?t:b(+t),e):o},e.y=function(t){return arguments.length?(s="function"==typeof t?t:b(+t),e):s},e.defined=function(t){return arguments.length?(l="function"==typeof t?t:b(!!t),e):l},e.curve=function(t){return arguments.length?(c=t,null!=u&&(h=c(u)),e):c},e.context=function(t){return arguments.length?(null==t?u=h=null:h=c(u=t),e):u},e}function l(){var c=_,h=null,f=b(0),d=x,p=b(!0),g=null,m=y,v=null;function e(t){var e,n,i,r,a,o=t.length,s=!1,l=new Array(o),u=new Array(o);for(null==g&&(v=m(a=F.path())),e=0;e<=o;++e){if(!(e<o&&p(r=t[e],e,t))===s)if(s=!s)n=e,v.areaStart(),v.lineStart();else{for(v.lineEnd(),v.lineStart(),i=e-1;n<=i;--i)v.point(l[i],u[i]);v.lineEnd(),v.areaEnd()}s&&(l[e]=+c(r,e,t),u[e]=+f(r,e,t),v.point(h?+h(r,e,t):l[e],d?+d(r,e,t):u[e]))}if(a)return v=null,a+""||null}function t(){return s().defined(p).curve(m).context(g)}return e.x=function(t){return arguments.length?(c="function"==typeof t?t:b(+t),h=null,e):c},e.x0=function(t){return arguments.length?(c="function"==typeof t?t:b(+t),e):c},e.x1=function(t){return arguments.length?(h=null==t?null:"function"==typeof t?t:b(+t),e):h},e.y=function(t){return arguments.length?(f="function"==typeof t?t:b(+t),d=null,e):f},e.y0=function(t){return arguments.length?(f="function"==typeof t?t:b(+t),e):f},e.y1=function(t){return arguments.length?(d=null==t?null:"function"==typeof t?t:b(+t),e):d},e.lineX0=e.lineY0=function(){return t().x(c).y(f)},e.lineY1=function(){return t().x(c).y(d)},e.lineX1=function(){return t().x(h).y(f)},e.defined=function(t){return arguments.length?(p="function"==typeof t?t:b(!!t),e):p},e.curve=function(t){return arguments.length?(m=t,null!=g&&(v=m(g)),e):m},e.context=function(t){return arguments.length?(null==t?g=v=null:v=m(g=t),e):g},e}function u(t,e){return e<t?-1:t<e?1:t<=e?0:NaN}function c(t){return t}e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var h=d(y);function f(t){this._curve=t}function d(e){function t(t){return new f(e(t))}return t._curve=e,t}function g(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(d(t)):e()._curve},t}function m(){return g(s().curve(h))}function v(){var t=l().curve(h),e=t.curve,n=t.lineX0,i=t.lineX1,r=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return g(n())},delete t.lineX0,t.lineEndAngle=function(){return g(i())},delete t.lineX1,t.lineInnerRadius=function(){return g(r())},delete t.lineY0,t.lineOuterRadius=function(){return g(a())},delete t.lineY1,t.curve=function(t){return arguments.length?e(d(t)):e()._curve},t}function w(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}f.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var C=Array.prototype.slice;function S(t){return t.source}function M(t){return t.target}function k(r){var a=S,o=M,s=_,l=x,u=null;function e(){var t,e=C.call(arguments),n=a.apply(this,e),i=o.apply(this,e);if(u=u||(t=F.path()),r(u,+s.apply(this,(e[0]=n,e)),+l.apply(this,e),+s.apply(this,(e[0]=i,e)),+l.apply(this,e)),t)return u=null,t+""||null}return e.source=function(t){return arguments.length?(a=t,e):a},e.target=function(t){return arguments.length?(o=t,e):o},e.x=function(t){return arguments.length?(s="function"==typeof t?t:b(+t),e):s},e.y=function(t){return arguments.length?(l="function"==typeof t?t:b(+t),e):l},e.context=function(t){return arguments.length?(u=null==t?null:t,e):u},e}function L(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e=(e+i)/2,n,e,r,i,r)}function T(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+r)/2,i,n,i,r)}function D(t,e,n,i,r){var a=w(e,n),e=w(e,n=(n+r)/2),n=w(i,n),r=w(i,r);t.moveTo(a[0],a[1]),t.bezierCurveTo(e[0],e[1],n[0],n[1],r[0],r[1])}var A={draw:function(t,e){e=Math.sqrt(e/G);t.moveTo(e,0),t.arc(0,0,e,0,$)}},B={draw:function(t,e){e=Math.sqrt(e/5)/2;t.moveTo(-3*e,-e),t.lineTo(-e,-e),t.lineTo(-e,-3*e),t.lineTo(e,-3*e),t.lineTo(e,-e),t.lineTo(3*e,-e),t.lineTo(3*e,e),t.lineTo(e,e),t.lineTo(e,3*e),t.lineTo(-e,3*e),t.lineTo(-e,e),t.lineTo(-3*e,e),t.closePath()}},P=Math.sqrt(1/3),E=2*P,O={draw:function(t,e){var n=Math.sqrt(e/E),e=n*P;t.moveTo(0,-n),t.lineTo(e,0),t.lineTo(0,n),t.lineTo(-e,0),t.closePath()}},I=Math.sin(G/10)/Math.sin(7*G/10),V=Math.sin($/10)*I,X=-Math.cos($/10)*I,J={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),i=V*n,r=X*n;t.moveTo(0,-n),t.lineTo(i,r);for(var a=1;a<5;++a){var o=$*a/5,s=Math.cos(o),o=Math.sin(o);t.lineTo(o*n,-s*n),t.lineTo(s*i-o*r,o*i+s*r)}t.closePath()}},Z={draw:function(t,e){var n=Math.sqrt(e),e=-n/2;t.rect(e,e,n,n)}},Q=Math.sqrt(3),tt={draw:function(t,e){e=-Math.sqrt(e/(3*Q));t.moveTo(0,2*e),t.lineTo(-Q*e,-e),t.lineTo(Q*e,-e),t.closePath()}},et=Math.sqrt(3)/2,nt=1/Math.sqrt(12),it=3*(nt/2+1),rt={draw:function(t,e){var n=Math.sqrt(e/it),i=n/2,r=n*nt,a=i,o=n*nt+n,e=-a,n=o;t.moveTo(i,r),t.lineTo(a,o),t.lineTo(e,n),t.lineTo(-.5*i-et*r,et*i+-.5*r),t.lineTo(-.5*a-et*o,et*a+-.5*o),t.lineTo(-.5*e-et*n,et*e+-.5*n),t.lineTo(-.5*i+et*r,-.5*r-et*i),t.lineTo(-.5*a+et*o,-.5*o-et*a),t.lineTo(-.5*e+et*n,-.5*n-et*e),t.closePath()}},at=[A,B,O,Z,J,tt,rt];function ot(){}function st(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function lt(t){this._context=t}function ut(t){this._context=t}function ct(t){this._context=t}function ht(t,e){this._basis=new lt(t),this._beta=e}lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:st(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ut.prototype={areaStart:ot,areaEnd:ot,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ct.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:st(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ht.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(0<n)for(var i,r=t[0],a=e[0],o=t[n]-r,s=e[n]-a,l=-1;++l<=n;)this._basis.point(this._beta*t[l]+(1-this._beta)*(r+(i=l/n)*o),this._beta*e[l]+(1-this._beta)*(a+i*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var ft=function e(n){function t(t){return 1===n?new lt(t):new ht(t,n)}return t.beta=function(t){return e(+t)},t}(.85);function dt(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function pt(t,e){this._context=t,this._k=(1-e)/6}pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:dt(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:dt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var gt=function e(n){function t(t){return new pt(t,n)}return t.tension=function(t){return e(+t)},t}(0);function mt(t,e){this._context=t,this._k=(1-e)/6}mt.prototype={areaStart:ot,areaEnd:ot,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:dt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var vt=function e(n){function t(t){return new mt(t,n)}return t.tension=function(t){return e(+t)},t}(0);function yt(t,e){this._context=t,this._k=(1-e)/6}yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:dt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var bt=function e(n){function t(t){return new yt(t,n)}return t.tension=function(t){return e(+t)},t}(0);function _t(t,e,n){var i,r,a=t._x1,o=t._y1,s=t._x2,l=t._y2;t._l01_a>q&&(i=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,r=3*t._l01_a*(t._l01_a+t._l12_a),a=(a*i-t._x0*t._l12_2a+t._x2*t._l01_2a)/r,o=(o*i-t._y0*t._l12_2a+t._y2*t._l01_2a)/r),t._l23_a>q&&(i=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,r=3*t._l23_a*(t._l23_a+t._l12_a),s=(s*i+t._x1*t._l23_2a-e*t._l12_2a)/r,l=(l*i+t._y1*t._l23_2a-n*t._l12_2a)/r),t._context.bezierCurveTo(a,o,s,l,t._x2,t._y2)}function xt(t,e){this._context=t,this._alpha=e}xt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n,i;switch(t=+t,e=+e,this._point&&(n=this._x2-t,i=this._y2-e,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))),this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var wt=function e(n){function t(t){return n?new xt(t,n):new pt(t,0)}return t.alpha=function(t){return e(+t)},t}(.5);function Ct(t,e){this._context=t,this._alpha=e}Ct.prototype={areaStart:ot,areaEnd:ot,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){var n,i;switch(t=+t,e=+e,this._point&&(n=this._x2-t,i=this._y2-e,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))),this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var St=function e(n){function t(t){return n?new Ct(t,n):new mt(t,0)}return t.alpha=function(t){return e(+t)},t}(.5);function Mt(t,e){this._context=t,this._alpha=e}Mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n,i;switch(t=+t,e=+e,this._point&&(n=this._x2-t,i=this._y2-e,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))),this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_t(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};I=function e(n){function t(t){return n?new Mt(t,n):new yt(t,0)}return t.alpha=function(t){return e(+t)},t}(.5);function kt(t){this._context=t}function Lt(t){return t<0?-1:1}function Tt(t,e,n){var i=t._x1-t._x0,r=e-t._x1,e=(t._y1-t._y0)/(i||r<0&&-0),t=(n-t._y1)/(r||i<0&&-0),r=(e*r+t*i)/(i+r);return(Lt(e)+Lt(t))*Math.min(Math.abs(e),Math.abs(t),.5*Math.abs(r))||0}function Dt(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function At(t,e,n){var i=t._x0,r=t._y0,a=t._x1,o=t._y1,s=(a-i)/3;t._context.bezierCurveTo(i+s,r+s*e,a-s,o-s*n,a,o)}function Bt(t){this._context=t}function Pt(t){this._context=new Et(t)}function Et(t){this._context=t}function Ot(t){this._context=t}function It(t){var e,n,i=t.length-1,r=new Array(i),a=new Array(i),o=new Array(i);for(a[r[0]=0]=2,o[0]=t[0]+2*t[1],e=1;e<i-1;++e)r[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(r[i-1]=2,a[i-1]=7,o[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=r[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(r[i-1]=o[i-1]/a[i-1],e=i-2;0<=e;--e)r[e]=(o[e]-r[e+1])/a[e];for(a[i-1]=(t[i]+r[i-1])/2,e=0;e<i-1;++e)a[e]=2*t[e+1]-r[e+1];return[r,a]}function Ft(t,e){this._context=t,this._t=e}function jt(t,e){if(1<(r=t.length))for(var n,i,r,a=1,o=t[e[0]],s=o.length;a<r;++a)for(i=o,o=t[e[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Nt(t){for(var e=t.length,n=new Array(e);0<=--e;)n[e]=e;return n}function Rt(t,e){return t[e]}function Wt(t){var n=t.map(Ht);return Nt(t).sort(function(t,e){return n[t]-n[e]})}function Ht(t){for(var e,n=-1,i=0,r=t.length,a=-1/0;++n<r;)(e=+t[n][1])>a&&(a=e,i=n);return i}function zt(t){var n=t.map(qt);return Nt(t).sort(function(t,e){return n[t]-n[e]})}function qt(t){for(var e,n=0,i=-1,r=t.length;++i<r;)(e=+t[i][1])&&(n+=e);return n}kt.prototype={areaStart:ot,areaEnd:ot,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:At(this,this._t0,Dt(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,At(this,Dt(this,n=Tt(this,t,e)),n);break;default:At(this,this._t0,n=Tt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Pt.prototype=Object.create(Bt.prototype)).point=function(t,e){Bt.prototype.point.call(this,e,t)},Et.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,a){this._context.bezierCurveTo(e,t,i,n,a,r)}},Ot.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=It(t),r=It(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(i[0][a],r[0][a],i[1][a],r[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Ft.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:var n;this._t<=0?(this._context.lineTo(this._x,e),this._context.lineTo(t,e)):(n=this._x*(1-this._t)+t*this._t,this._context.lineTo(n,this._y),this._context.lineTo(n,e))}this._x=t,this._y=e}},t.arc=function(){var T=n,D=i,A=b(0),B=null,P=r,E=a,O=o,I=null;function e(){var t,e,n,i,r,a,o,s,l,u,c,h,f,d,p,g,m,v,y,b,_,x,w=+T.apply(this,arguments),C=+D.apply(this,arguments),S=P.apply(this,arguments)-U,M=E.apply(this,arguments)-U,k=j(M-S),L=S<M;if(I=I||(t=F.path()),C<w&&(c=C,C=w,w=c),q<C?$-q<k?(I.moveTo(C*R(S),C*H(S)),I.arc(0,0,C,S,M,!L),q<w&&(I.moveTo(w*R(M),w*H(M)),I.arc(0,0,w,M,S,L))):(i=e=S,r=n=M,o=a=k,f=O.apply(this,arguments)/2,h=q<f&&(B?+B.apply(this,arguments):z(w*w+C*C)),x=_=s=W(j(C-w)/2,+A.apply(this,arguments)),q<h&&(d=K(h/w*H(f)),y=K(h/C*H(f)),(a-=2*d)>q?(i+=d*=L?1:-1,r-=d):(a=0,i=r=(S+M)/2),(o-=2*y)>q?(e+=y*=L?1:-1,n-=y):(o=0,e=n=(S+M)/2)),c=C*R(e),h=C*H(e),f=w*R(r),d=w*H(r),q<s&&(p=C*R(n),g=C*H(n),m=w*R(i),v=w*H(i),k<G&&(b=function(t,e,n,i,r,a,o,s){var l=n-t,n=i-e,i=o-r;if(!((s=(o=s-a)*l-i*n)*s<q))return[t+(s=(i*(e-a)-o*(t-r))/s)*l,e+s*n]}(c,h,m,v,p,g,f,d))&&(y=c-b[0],S=h-b[1],M=p-b[0],k=g-b[1],k=1/H((1<(k=(y*M+S*k)/(z(y*y+S*S)*z(M*M+k*k)))?0:k<-1?G:Math.acos(k))/2),b=z(b[0]*b[0]+b[1]*b[1]),_=W(s,(w-b)/(k-1)),x=W(s,(C-b)/(1+k)))),q<o?q<x?(l=Y(m,v,c,h,C,x,L),u=Y(p,g,f,d,C,x,L),I.moveTo(l.cx+l.x01,l.cy+l.y01),x<s?I.arc(l.cx,l.cy,x,N(l.y01,l.x01),N(u.y01,u.x01),!L):(I.arc(l.cx,l.cy,x,N(l.y01,l.x01),N(l.y11,l.x11),!L),I.arc(0,0,C,N(l.cy+l.y11,l.cx+l.x11),N(u.cy+u.y11,u.cx+u.x11),!L),I.arc(u.cx,u.cy,x,N(u.y11,u.x11),N(u.y01,u.x01),!L))):(I.moveTo(c,h),I.arc(0,0,C,e,n,!L)):I.moveTo(c,h),q<w&&q<a?q<_?(l=Y(f,d,p,g,w,-_,L),u=Y(c,h,m,v,w,-_,L),I.lineTo(l.cx+l.x01,l.cy+l.y01),_<s?I.arc(l.cx,l.cy,_,N(l.y01,l.x01),N(u.y01,u.x01),!L):(I.arc(l.cx,l.cy,_,N(l.y01,l.x01),N(l.y11,l.x11),!L),I.arc(0,0,w,N(l.cy+l.y11,l.cx+l.x11),N(u.cy+u.y11,u.cx+u.x11),L),I.arc(u.cx,u.cy,_,N(u.y11,u.x11),N(u.y01,u.x01),!L))):I.arc(0,0,w,r,i,L):I.lineTo(f,d)):I.moveTo(0,0),I.closePath(),t)return I=null,t+""||null}return e.centroid=function(){var t=(+T.apply(this,arguments)+ +D.apply(this,arguments))/2,e=(+P.apply(this,arguments)+ +E.apply(this,arguments))/2-G/2;return[R(e)*t,H(e)*t]},e.innerRadius=function(t){return arguments.length?(T="function"==typeof t?t:b(+t),e):T},e.outerRadius=function(t){return arguments.length?(D="function"==typeof t?t:b(+t),e):D},e.cornerRadius=function(t){return arguments.length?(A="function"==typeof t?t:b(+t),e):A},e.padRadius=function(t){return arguments.length?(B=null==t?null:"function"==typeof t?t:b(+t),e):B},e.startAngle=function(t){return arguments.length?(P="function"==typeof t?t:b(+t),e):P},e.endAngle=function(t){return arguments.length?(E="function"==typeof t?t:b(+t),e):E},e.padAngle=function(t){return arguments.length?(O="function"==typeof t?t:b(+t),e):O},e.context=function(t){return arguments.length?(I=null==t?null:t,e):I},e},t.area=l,t.areaRadial=v,t.curveBasis=function(t){return new lt(t)},t.curveBasisClosed=function(t){return new ut(t)},t.curveBasisOpen=function(t){return new ct(t)},t.curveBundle=ft,t.curveCardinal=gt,t.curveCardinalClosed=vt,t.curveCardinalOpen=bt,t.curveCatmullRom=wt,t.curveCatmullRomClosed=St,t.curveCatmullRomOpen=I,t.curveLinear=y,t.curveLinearClosed=function(t){return new kt(t)},t.curveMonotoneX=function(t){return new Bt(t)},t.curveMonotoneY=function(t){return new Pt(t)},t.curveNatural=function(t){return new Ot(t)},t.curveStep=function(t){return new Ft(t,.5)},t.curveStepAfter=function(t){return new Ft(t,1)},t.curveStepBefore=function(t){return new Ft(t,0)},t.line=s,t.lineRadial=m,t.linkHorizontal=function(){return k(L)},t.linkRadial=function(){var t=k(D);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},t.linkVertical=function(){return k(T)},t.pie=function(){var d=c,p=u,g=null,m=b(0),v=b($),y=b(0);function e(n){for(var t,e,i,r=n.length,a=0,o=new Array(r),s=new Array(r),l=+m.apply(this,arguments),u=Math.min($,Math.max(-$,v.apply(this,arguments)-l)),c=Math.min(Math.abs(u)/r,y.apply(this,arguments)),h=c*(u<0?-1:1),f=0;f<r;++f)0<(i=s[o[f]=f]=+d(n[f],f,n))&&(a+=i);for(null!=p?o.sort(function(t,e){return p(s[t],s[e])}):null!=g&&o.sort(function(t,e){return g(n[t],n[e])}),f=0,t=a?(u-r*h)/a:0;f<r;++f,l=e)e=o[f],i=s[e],s[e]={data:n[e],index:f,value:i,startAngle:l,endAngle:e=l+(0<i?i*t:0)+h,padAngle:c};return s}return e.value=function(t){return arguments.length?(d="function"==typeof t?t:b(+t),e):d},e.sortValues=function(t){return arguments.length?(p=t,g=null,e):p},e.sort=function(t){return arguments.length?(g=t,p=null,e):g},e.startAngle=function(t){return arguments.length?(m="function"==typeof t?t:b(+t),e):m},e.endAngle=function(t){return arguments.length?(v="function"==typeof t?t:b(+t),e):v},e.padAngle=function(t){return arguments.length?(y="function"==typeof t?t:b(+t),e):y},e},t.pointRadial=w,t.radialArea=v,t.radialLine=m,t.stack=function(){var h=b([]),f=Nt,d=jt,p=Rt;function e(t){for(var e,n=h.apply(this,arguments),i=t.length,r=n.length,a=new Array(r),o=0;o<r;++o){for(var s,l=n[o],u=a[o]=new Array(i),c=0;c<i;++c)u[c]=s=[0,+p(t[c],l,c,t)],s.data=t[c];u.key=l}for(o=0,e=f(a);o<r;++o)a[e[o]].index=o;return d(a,e),a}return e.keys=function(t){return arguments.length?(h="function"==typeof t?t:b(C.call(t)),e):h},e.value=function(t){return arguments.length?(p="function"==typeof t?t:b(+t),e):p},e.order=function(t){return arguments.length?(f=null==t?Nt:"function"==typeof t?t:b(C.call(t)),e):f},e.offset=function(t){return arguments.length?(d=null==t?jt:t,e):d},e},t.stackOffsetDiverging=function(t,e){if(0<(s=t.length))for(var n,i,r,a,o,s,l=0,u=t[e[0]].length;l<u;++l)for(n=a=o=0;n<s;++n)0<(r=(i=t[e[n]][l])[1]-i[0])?(i[0]=a,i[1]=a+=r):r<0?(i[1]=o,i[0]=o+=r):(i[0]=0,i[1]=r)},t.stackOffsetExpand=function(t,e){if(0<(i=t.length)){for(var n,i,r,a=0,o=t[0].length;a<o;++a){for(r=n=0;n<i;++n)r+=t[n][a][1]||0;if(r)for(n=0;n<i;++n)t[n][a][1]/=r}jt(t,e)}},t.stackOffsetNone=jt,t.stackOffsetSilhouette=function(t,e){if(0<(n=t.length)){for(var n,i=0,r=t[e[0]],a=r.length;i<a;++i){for(var o=0,s=0;o<n;++o)s+=t[o][i][1]||0;r[i][1]+=r[i][0]=-s/2}jt(t,e)}},t.stackOffsetWiggle=function(t,e){if(0<(r=t.length)&&0<(i=(n=t[e[0]]).length)){for(var n,i,r,a=0,o=1;o<i;++o){for(var s=0,l=0,u=0;s<r;++s){for(var c=t[e[s]],h=c[o][1]||0,f=(h-(c[o-1][1]||0))/2,d=0;d<s;++d){var p=t[e[d]];f+=(p[o][1]||0)-(p[o-1][1]||0)}l+=h,u+=f*h}n[o-1][1]+=n[o-1][0]=a,l&&(a-=u/l)}n[o-1][1]+=n[o-1][0]=a,jt(t,e)}},t.stackOrderAppearance=Wt,t.stackOrderAscending=zt,t.stackOrderDescending=function(t){return zt(t).reverse()},t.stackOrderInsideOut=function(t){for(var e,n=t.length,i=t.map(qt),r=Wt(t),a=0,o=0,s=[],l=[],u=0;u<n;++u)e=r[u],a<o?(a+=i[e],s.push(e)):(o+=i[e],l.push(e));return l.reverse().concat(s)},t.stackOrderNone=Nt,t.stackOrderReverse=function(t){return Nt(t).reverse()},t.symbol=function(){var e=b(A),n=b(64),i=null;function r(){var t;if(i=i||(t=F.path()),e.apply(this,arguments).draw(i,+n.apply(this,arguments)),t)return i=null,t+""||null}return r.type=function(t){return arguments.length?(e="function"==typeof t?t:b(t),r):e},r.size=function(t){return arguments.length?(n="function"==typeof t?t:b(+t),r):n},r.context=function(t){return arguments.length?(i=null==t?null:t,r):i},r},t.symbolCircle=A,t.symbolCross=B,t.symbolDiamond=O,t.symbolSquare=Z,t.symbolStar=J,t.symbolTriangle=tt,t.symbolWye=rt,t.symbols=at,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-path")):"function"==typeof define&&define.amd?define(["exports","d3-path"],r):r((i=i||self).d3=i.d3||{},i.d3)},{"d3-path":28}],36:[function(t,e,n){var i,r;i=this,r=function(e,M){"use strict";function k(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function L(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function T(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function n(t){var i=t.dateTime,r=t.date,a=t.time,e=t.periods,n=t.days,o=t.shortDays,s=t.months,l=t.shortMonths,u=A(e),c=B(e),h=A(n),f=B(n),d=A(o),p=B(o),g=A(s),m=B(s),v=A(l),y=B(l),b={a:function(t){return o[t.getDay()]},A:function(t){return n[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Z,e:Z,f:it,H:Q,I:tt,j:et,L:nt,m:rt,M:at,p:function(t){return e[+(12<=t.getHours())]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Et,s:Ot,S:ot,u:st,U:lt,V:ut,w:ct,W:ht,x:null,X:null,y:ft,Y:dt,Z:pt,"%":Pt},_={a:function(t){return o[t.getUTCDay()]},A:function(t){return n[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:gt,e:gt,f:_t,H:mt,I:vt,j:yt,L:bt,m:xt,M:wt,p:function(t){return e[+(12<=t.getUTCHours())]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Et,s:Ot,S:Ct,u:St,U:Mt,V:kt,w:Lt,W:Tt,x:null,X:null,y:Dt,Y:At,Z:Bt,"%":Pt},x={a:function(t,e,n){e=d.exec(e.slice(n));return e?(t.w=p[e[0].toLowerCase()],n+e[0].length):-1},A:function(t,e,n){e=h.exec(e.slice(n));return e?(t.w=f[e[0].toLowerCase()],n+e[0].length):-1},b:function(t,e,n){e=v.exec(e.slice(n));return e?(t.m=y[e[0].toLowerCase()],n+e[0].length):-1},B:function(t,e,n){e=g.exec(e.slice(n));return e?(t.m=m[e[0].toLowerCase()],n+e[0].length):-1},c:function(t,e,n){return S(t,i,e,n)},d:z,e:z,f:Y,H:G,I:G,j:q,L:K,m:H,M:U,p:function(t,e,n){e=u.exec(e.slice(n));return e?(t.p=c[e[0].toLowerCase()],n+e[0].length):-1},q:W,Q:X,s:J,S:$,u:E,U:O,V:I,w:P,W:F,x:function(t,e,n){return S(t,r,e,n)},X:function(t,e,n){return S(t,a,e,n)},y:N,Y:j,Z:R,"%":V};function w(l,u){return function(t){var e,n,i,r=[],a=-1,o=0,s=l.length;for(t instanceof Date||(t=new Date(+t));++a<s;)37===l.charCodeAt(a)&&(r.push(l.slice(o,a)),null!=(n=D[e=l.charAt(++a)])?e=l.charAt(++a):n="e"===e?" ":"0",(i=u[e])&&(e=i(t,n)),r.push(e),o=a+1);return r.push(l.slice(o,a)),r.join("")}}function C(r,a){return function(t){var e,n,i=T(1900,void 0,1);if(S(i,r,t+="",0)!=t.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(!a||"Z"in i||(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||53<i.V)return null;"w"in i||(i.w=1),"Z"in i?(e=4<(n=(e=L(T(i.y,0,1))).getUTCDay())||0===n?M.utcMonday.ceil(e):M.utcMonday(e),e=M.utcDay.offset(e,7*(i.V-1)),i.y=e.getUTCFullYear(),i.m=e.getUTCMonth(),i.d=e.getUTCDate()+(i.w+6)%7):(e=4<(n=(e=k(T(i.y,0,1))).getDay())||0===n?M.timeMonday.ceil(e):M.timeMonday(e),e=M.timeDay.offset(e,7*(i.V-1)),i.y=e.getFullYear(),i.m=e.getMonth(),i.d=e.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),n="Z"in i?L(T(i.y,0,1)).getUTCDay():k(T(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(n+5)%7:i.w+7*i.U-(n+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,L(i)):k(i)}}function S(t,e,n,i){for(var r,a,o=0,s=e.length,l=n.length;o<s;){if(l<=i)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(a=x[r in D?e.charAt(o++):r])||(i=a(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return b.x=w(r,b),b.X=w(a,b),b.c=w(i,b),_.x=w(r,_),_.X=w(a,_),_.c=w(i,_),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=C(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",_);return e.toString=function(){return t},e},utcParse:function(t){var e=C(t+="",!0);return e.toString=function(){return t},e}}}var i,D={"-":"",_:" ",0:"0"},r=/^\s*\d+/,a=/^%/,o=/[\\^$*+?|[\]().{}]/g;function s(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",t=r.length;return i+(t<n?new Array(n-t+1).join(e)+r:r)}function l(t){return t.replace(o,"\\$&")}function A(t){return new RegExp("^(?:"+t.map(l).join("|")+")","i")}function B(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function P(t,e,n){e=r.exec(e.slice(n,n+1));return e?(t.w=+e[0],n+e[0].length):-1}function E(t,e,n){e=r.exec(e.slice(n,n+1));return e?(t.u=+e[0],n+e[0].length):-1}function O(t,e,n){e=r.exec(e.slice(n,n+2));return e?(t.U=+e[0],n+e[0].length):-1}function I(t,e,n){e=r.exec(e.slice(n,n+2));return e?(t.V=+e[0],n+e[0].length):-1}function F(t,e,n){e=r.exec(e.slice(n,n+2));return e?(t.W=+e[0],n+e[0].length):-1}function j(t,e,n){e=r.exec(e.slice(n,n+4));return e?(t.y=+e[0],n+e[0].length):-1}function N(t,e,n){e=r.exec(e.slice(n,n+2));return e?(t.y=+e[0]+(68<+e[0]?1900:2e3),n+e[0].length):-1}function R(t,e,n){e=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return e?(t.Z=e[1]?0:-(e[2]+(e[3]||"00")),n+e[0].length):-1}function W(t,e,n){e=r.exec(e.slice(n,n+1));return e?(t.q=3*e[0]-3,n+e[0].length):-1}function H(t,e,n){e=r.exec(e.slice(n,n+2));return e?(t.m=e[0]-1,n+e[0].length):-1}function z(t,e,n){e=r.exec(e.slice(n,n+2));return e?(t.d=+e[0],n+e[0].length):-1}function q(t,e,n){e=r.exec(e.slice(n,n+3));return e?(t.m=0,t.d=+e[0],n+e[0].length):-1}function G(t,e,n){e=r.exec(e.slice(n,n+2));return e?(t.H=+e[0],n+e[0].length):-1}function U(t,e,n){e=r.exec(e.slice(n,n+2));return e?(t.M=+e[0],n+e[0].length):-1}function $(t,e,n){e=r.exec(e.slice(n,n+2));return e?(t.S=+e[0],n+e[0].length):-1}function K(t,e,n){e=r.exec(e.slice(n,n+3));return e?(t.L=+e[0],n+e[0].length):-1}function Y(t,e,n){e=r.exec(e.slice(n,n+6));return e?(t.L=Math.floor(e[0]/1e3),n+e[0].length):-1}function V(t,e,n){e=a.exec(e.slice(n,n+1));return e?n+e[0].length:-1}function X(t,e,n){e=r.exec(e.slice(n));return e?(t.Q=+e[0],n+e[0].length):-1}function J(t,e,n){e=r.exec(e.slice(n));return e?(t.s=+e[0],n+e[0].length):-1}function Z(t,e){return s(t.getDate(),e,2)}function Q(t,e){return s(t.getHours(),e,2)}function tt(t,e){return s(t.getHours()%12||12,e,2)}function et(t,e){return s(1+M.timeDay.count(M.timeYear(t),t),e,3)}function nt(t,e){return s(t.getMilliseconds(),e,3)}function it(t,e){return nt(t,e)+"000"}function rt(t,e){return s(t.getMonth()+1,e,2)}function at(t,e){return s(t.getMinutes(),e,2)}function ot(t,e){return s(t.getSeconds(),e,2)}function st(t){t=t.getDay();return 0===t?7:t}function lt(t,e){return s(M.timeSunday.count(M.timeYear(t)-1,t),e,2)}function ut(t,e){var n=t.getDay();return t=4<=n||0===n?M.timeThursday(t):M.timeThursday.ceil(t),s(M.timeThursday.count(M.timeYear(t),t)+(4===M.timeYear(t).getDay()),e,2)}function ct(t){return t.getDay()}function ht(t,e){return s(M.timeMonday.count(M.timeYear(t)-1,t),e,2)}function ft(t,e){return s(t.getFullYear()%100,e,2)}function dt(t,e){return s(t.getFullYear()%1e4,e,4)}function pt(t){t=t.getTimezoneOffset();return(0<t?"-":(t*=-1,"+"))+s(t/60|0,"0",2)+s(t%60,"0",2)}function gt(t,e){return s(t.getUTCDate(),e,2)}function mt(t,e){return s(t.getUTCHours(),e,2)}function vt(t,e){return s(t.getUTCHours()%12||12,e,2)}function yt(t,e){return s(1+M.utcDay.count(M.utcYear(t),t),e,3)}function bt(t,e){return s(t.getUTCMilliseconds(),e,3)}function _t(t,e){return bt(t,e)+"000"}function xt(t,e){return s(t.getUTCMonth()+1,e,2)}function wt(t,e){return s(t.getUTCMinutes(),e,2)}function Ct(t,e){return s(t.getUTCSeconds(),e,2)}function St(t){t=t.getUTCDay();return 0===t?7:t}function Mt(t,e){return s(M.utcSunday.count(M.utcYear(t)-1,t),e,2)}function kt(t,e){var n=t.getUTCDay();return t=4<=n||0===n?M.utcThursday(t):M.utcThursday.ceil(t),s(M.utcThursday.count(M.utcYear(t),t)+(4===M.utcYear(t).getUTCDay()),e,2)}function Lt(t){return t.getUTCDay()}function Tt(t,e){return s(M.utcMonday.count(M.utcYear(t)-1,t),e,2)}function Dt(t,e){return s(t.getUTCFullYear()%100,e,2)}function At(t,e){return s(t.getUTCFullYear()%1e4,e,4)}function Bt(){return"+0000"}function Pt(){return"%"}function Et(t){return+t}function Ot(t){return Math.floor(+t/1e3)}function t(t){return i=n(t),e.timeFormat=i.format,e.timeParse=i.parse,e.utcFormat=i.utcFormat,e.utcParse=i.utcParse,i}t({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var u="%Y-%m-%dT%H:%M:%S.%LZ";var c=Date.prototype.toISOString?function(t){return t.toISOString()}:e.utcFormat(u);u=+new Date("2000-01-01T00:00:00.000Z")?function(t){return t=new Date(t),isNaN(t)?null:t}:e.utcParse(u);e.isoFormat=c,e.isoParse=u,e.timeFormatDefaultLocale=t,e.timeFormatLocale=n,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-time")):"function"==typeof define&&define.amd?define(["exports","d3-time"],r):r((i=i||self).d3=i.d3||{},i.d3)},{"d3-time":37}],37:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";var r=new Date,l=new Date;function u(a,o,n,i){function s(t){return a(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=function(t){return a(t=new Date(+t)),t},s.ceil=function(t){return a(t=new Date(t-1)),o(t,1),a(t),t},s.round=function(t){var e=s(t),n=s.ceil(t);return t-e<n-t?e:n},s.offset=function(t,e){return o(t=new Date(+t),null==e?1:Math.floor(e)),t},s.range=function(t,e,n){var i,r=[];if(t=s.ceil(t),n=null==n?1:Math.floor(n),!(t<e&&0<n))return r;for(;r.push(i=new Date(+t)),o(t,n),a(t),i<t&&t<e;);return r},s.filter=function(n){return u(function(t){if(t<=t)for(;a(t),!n(t);)t.setTime(t-1)},function(t,e){if(t<=t)if(e<0)for(;++e<=0;)for(;o(t,-1),!n(t););else for(;0<=--e;)for(;o(t,1),!n(t););})},n&&(s.count=function(t,e){return r.setTime(+t),l.setTime(+e),a(r),a(l),Math.floor(n(r,l))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&0<e?1<e?s.filter(i?function(t){return i(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var e=u(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});e.every=function(n){return n=Math.floor(n),isFinite(n)&&0<n?1<n?u(function(t){t.setTime(Math.floor(t/n)*n)},function(t,e){t.setTime(+t+e*n)},function(t,e){return(e-t)/n}):e:null};var n=e.range,i=u(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),a=i.range,o=u(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())},function(t,e){t.setTime(+t+6e4*e)},function(t,e){return(e-t)/6e4},function(t){return t.getMinutes()}),s=o.range,c=u(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),h=c.range,f=u(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5},function(t){return t.getDate()-1}),d=f.range;function p(e){return u(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5})}var g=p(0),m=p(1),v=p(2),y=p(3),b=p(4),_=p(5),x=p(6),w=g.range,C=m.range,S=v.range,M=y.range,k=b.range,L=_.range,T=x.range,D=u(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),A=D.range,B=u(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});B.every=function(n){return isFinite(n=Math.floor(n))&&0<n?u(function(t){t.setFullYear(Math.floor(t.getFullYear()/n)*n),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e*n)}):null};var P=B.range,E=u(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+6e4*e)},function(t,e){return(e-t)/6e4},function(t){return t.getUTCMinutes()}),O=E.range,I=u(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()}),F=I.range,j=u(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1}),N=j.range;function R(e){return u(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/6048e5})}var W=R(0),H=R(1),z=R(2),q=R(3),G=R(4),U=R(5),$=R(6),K=W.range,Y=H.range,V=z.range,X=q.range,J=G.range,Z=U.range,Q=$.range,tt=u(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),et=tt.range,nt=u(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});nt.every=function(n){return isFinite(n=Math.floor(n))&&0<n?u(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/n)*n),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e*n)}):null};var it=nt.range;t.timeDay=f,t.timeDays=d,t.timeFriday=_,t.timeFridays=L,t.timeHour=c,t.timeHours=h,t.timeInterval=u,t.timeMillisecond=e,t.timeMilliseconds=n,t.timeMinute=o,t.timeMinutes=s,t.timeMonday=m,t.timeMondays=C,t.timeMonth=D,t.timeMonths=A,t.timeSaturday=x,t.timeSaturdays=T,t.timeSecond=i,t.timeSeconds=a,t.timeSunday=g,t.timeSundays=w,t.timeThursday=b,t.timeThursdays=k,t.timeTuesday=v,t.timeTuesdays=S,t.timeWednesday=y,t.timeWednesdays=M,t.timeWeek=g,t.timeWeeks=w,t.timeYear=B,t.timeYears=P,t.utcDay=j,t.utcDays=N,t.utcFriday=U,t.utcFridays=Z,t.utcHour=I,t.utcHours=F,t.utcMillisecond=e,t.utcMilliseconds=n,t.utcMinute=E,t.utcMinutes=O,t.utcMonday=H,t.utcMondays=Y,t.utcMonth=tt,t.utcMonths=et,t.utcSaturday=$,t.utcSaturdays=Q,t.utcSecond=i,t.utcSeconds=a,t.utcSunday=W,t.utcSundays=K,t.utcThursday=G,t.utcThursdays=J,t.utcTuesday=z,t.utcTuesdays=V,t.utcWednesday=q,t.utcWednesdays=X,t.utcWeek=W,t.utcWeeks=K,t.utcYear=nt,t.utcYears=it,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],38:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";var r,a,n=0,e=0,i=0,o=1e3,s=0,l=0,u=0,c="object"==typeof performance&&performance.now?performance:Date,h="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function f(){return l||(h(d),l=c.now()+u)}function d(){l=0}function p(){this._call=this._time=this._next=null}function g(t,e,n){var i=new p;return i.restart(t,e,n),i}function m(){f(),++n;for(var t,e=r;e;)0<=(t=l-e._time)&&e._call.call(null,t),e=e._next;--n}function v(){l=(s=c.now())+u,n=e=0;try{m()}finally{n=0,function(){var t,e,n=r,i=1/0;for(;n;)n=n._call?(i>n._time&&(i=n._time),(t=n)._next):(e=n._next,n._next=null,t?t._next=e:r=e);a=t,b(i)}(),l=0}}function y(){var t=c.now(),e=t-s;o<e&&(u-=e,s=t)}function b(t){n||(e=e&&clearTimeout(e),24<t-l?(t<1/0&&(e=setTimeout(v,t-c.now()-u)),i=i&&clearInterval(i)):(i||(s=c.now(),i=setInterval(y,o)),n=1,h(v)))}p.prototype=g.prototype={constructor:p,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?f():+n)+(null==e?0:+e),this._next||a===this||(a?a._next=this:r=this,a=this),this._call=t,this._time=n,b()},stop:function(){this._call&&(this._call=null,this._time=1/0,b())}},t.interval=function(n,i,r){var a=new p,o=i;return null==i?a.restart(n,i,r):(i=+i,r=null==r?f():+r,a.restart(function t(e){e+=o,a.restart(t,o+=i,r),n(e)},i,r)),a},t.now=f,t.timeout=function(e,n,t){var i=new p;return i.restart(function(t){i.stop(),e(t+n)},n=null==n?0:+n,t),i},t.timer=g,t.timerFlush=m,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r((i=i||self).d3=i.d3||{})},{}],39:[function(t,e,n){var i,r;i=this,r=function(t,D,e,g,A,i,n){"use strict";var m=e.dispatch("start","end","cancel","interrupt"),v=[],y=0,b=1,_=2,x=3,w=4,C=5,S=6;function M(t,e,n,i,r,a){var o,s,l,u,c,h=t.__transition;if(h){if(n in h)return}else t.__transition={};function f(t){var e,n,i,r;if(l.state!==b)return p();for(e in c)if((r=c[e]).name===l.name){if(r.state===x)return g.timeout(f);r.state===w?(r.state=S,r.timer.stop(),r.on.call("interrupt",o,o.__data__,r.index,r.group),delete c[e]):+e<s&&(r.state=S,r.timer.stop(),r.on.call("cancel",o,o.__data__,r.index,r.group),delete c[e])}if(g.timeout(function(){l.state===x&&(l.state=w,l.timer.restart(d,l.delay,l.time),d(t))}),l.state=_,l.on.call("start",o,o.__data__,l.index,l.group),l.state===_){for(l.state=x,u=new Array(i=l.tween.length),e=0,n=-1;e<i;++e)(r=l.tween[e].value.call(o,o.__data__,l.index,l.group))&&(u[++n]=r);u.length=n+1}}function d(t){for(var e=t<l.duration?l.ease.call(null,t/l.duration):(l.timer.restart(p),l.state=C,1),n=-1,i=u.length;++n<i;)u[n].call(o,e);l.state===C&&(l.on.call("end",o,o.__data__,l.index,l.group),p())}function p(){for(var t in l.state=S,l.timer.stop(),delete c[s],c)return;delete o.__transition}o=t,s=n,l={name:e,index:i,group:r,on:m,tween:v,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:y},((c=o.__transition)[s]=l).timer=g.timer(function(t){l.state=b,l.timer.restart(f,l.delay,l.time),l.delay<=t&&f(t-l.delay)},0,l.time)}function u(t,e){e=k(t,e);if(e.state>y)throw new Error("too late; already scheduled");return e}function B(t,e){e=k(t,e);if(e.state>x)throw new Error("too late; already running");return e}function k(t,e){t=t.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function r(t,e){var n,i,r,a=t.__transition,o=!0;if(a){for(r in e=null==e?null:e+"",a)(n=a[r]).name===e?(i=n.state>_&&n.state<C,n.state=S,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[r]):o=!1;o&&delete t.__transition}}function P(t,e,n){var i=t._id;return t.each(function(){var t=B(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return k(t,i).value[e]}}function E(t,e){var n;return("number"==typeof e?A.interpolateNumber:e instanceof i.color?A.interpolateRgb:(n=i.color(e))?(e=n,A.interpolateRgb):A.interpolateString)(t,e)}function a(i,r){var a,o;function t(){var e,n,t=r.apply(this,arguments);return a=t!==o?(o=t)&&(e=i,n=t,function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))}):a}return t._value=r,t}function o(i,r){var a,o;function t(){var e,n,t=r.apply(this,arguments);return a=t!==o?(o=t)&&(e=i,n=t,function(t){this.setAttribute(e,n.call(this,t))}):a}return t._value=r,t}var s=D.selection.prototype.constructor;function O(t){return function(){this.style.removeProperty(t)}}function l(r,a,o){var s,l;function t(){var e,n,i,t=a.apply(this,arguments);return s=t!==l?(l=t)&&(e=r,n=t,i=o,function(t){this.style.setProperty(e,n.call(this,t),i)}):s}return t._value=a,t}function c(n){var i,r;function t(){var e,t=n.apply(this,arguments);return i=t!==r?(r=t)&&(e=t,function(t){this.textContent=e.call(this,t)}):i}return t._value=n,t}var h=0;function L(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function f(t){return D.selection().transition(t)}e=D.selection.prototype;L.prototype=f.prototype={constructor:L,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=D.selector(t));for(var i=this._groups,r=i.length,a=new Array(r),o=0;o<r;++o)for(var s,l,u=i[o],c=u.length,h=a[o]=new Array(c),f=0;f<c;++f)(s=u[f])&&(l=t.call(s,s.__data__,f,u))&&("__data__"in s&&(l.__data__=s.__data__),h[f]=l,M(h[f],e,n,f,h,k(s,n)));return new L(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=D.selectorAll(t));for(var i=this._groups,r=i.length,a=[],o=[],s=0;s<r;++s)for(var l,u=i[s],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var f,d=t.call(l,l.__data__,h,u),p=k(l,n),g=0,m=d.length;g<m;++g)(f=d[g])&&M(f,e,n,g,d,p);a.push(d),o.push(l)}return new L(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=D.matcher(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o=e[r],s=o.length,l=i[r]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&l.push(a);return new L(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,t=n.length,r=Math.min(i,t),a=new Array(i),o=0;o<r;++o)for(var s,l=e[o],u=n[o],c=l.length,h=a[o]=new Array(c),f=0;f<c;++f)(s=l[f]||u[f])&&(h[f]=s);for(;o<i;++o)a[o]=e[o];return new L(a,this._parents,this._name,this._id)},selection:function(){return new s(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=++h,i=this._groups,r=i.length,a=0;a<r;++a)for(var o,s=i[a],l=s.length,u=0;u<l;++u)(o=s[u])&&M(o,t,n,u,s,{time:(o=k(o,e)).time+o.delay+o.duration,delay:0,duration:o.duration,ease:o.ease});return new L(i,this._parents,t,n)},call:e.call,nodes:e.nodes,node:e.node,size:e.size,empty:e.empty,each:e.each,on:function(t,e){var n,i,r,a,o,s,l=this._id;return arguments.length<2?k(this.node(),l).on.on(t):this.each((n=l,r=e,s=((i=t)+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return!(t=0<=e?t.slice(0,e):t)||"start"===t})?u:B,function(){var t=s(this,n),e=t.on;e!==a&&(o=(a=e).copy()).on(i,r),t.on=o}))},attr:function(t,e){var n=D.namespace(t),i="transform"===n?A.interpolateTransformSvg:E;return this.attrTween(t,"function"==typeof e?(n.local?function(i,r,a){var o,s,l;return function(){var t,e,n=a(this);if(null!=n)return(t=this.getAttributeNS(i.space,i.local))===(e=n+"")?null:t===o&&e===s?l:(s=e,l=r(o=t,n));this.removeAttributeNS(i.space,i.local)}}:function(i,r,a){var o,s,l;return function(){var t,e,n=a(this);if(null!=n)return(t=this.getAttribute(i))===(e=n+"")?null:t===o&&e===s?l:(s=e,l=r(o=t,n));this.removeAttribute(i)}})(n,i,P(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(e,n,i){var r,a,o=i+"";return function(){var t=this.getAttributeNS(e.space,e.local);return t===o?null:t===r?a:a=n(r=t,i)}}:function(e,n,i){var r,a,o=i+"";return function(){var t=this.getAttribute(e);return t===o?null:t===r?a:a=n(r=t,i)}})(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return t=D.namespace(t),this.tween(n,(t.local?a:o)(t,e))},style:function(t,e,n){var i,r,a,o,s,l,u,c,h,f,d,p,g,m,v,y,b,_,x,w,C,S,M,k,L,T="transform"==(t+="")?A.interpolateTransformCss:E;return null==e?this.styleTween(t,(C=t,S=T,function(){var t=D.style(this,C),e=(this.style.removeProperty(C),D.style(this,C));return t===e?null:t===M&&e===k?L:L=S(M=t,k=e)})).on("end.style."+t,O(t)):"function"==typeof e?this.styleTween(t,(y=T,b=P(this,"style."+(v=t),e),function(){var t=D.style(this,v),e=b(this),n=e+"";return null==e&&(this.style.removeProperty(v),n=e=D.style(this,v)),t===n?null:t===_&&n===x?w:(x=n,w=y(_=t,e))})).each((u=this._id,m="end."+(g="style."+(c=t)),function(){var t=B(this,u),e=t.on,n=null==t.value[g]?p=p||O(c):void 0;e===h&&d===n||(f=(h=e).copy()).on(m,d=n),t.on=f})):this.styleTween(t,(i=t,r=T,l=(a=e)+"",function(){var t=D.style(this,i);return t===l?null:t===o?s:s=r(o=t,a)}),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,l(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?(n=P(this,"text",t),function(){var t=n(this);this.textContent=null==t?"":t}):(e=null==t?"":t+"",function(){this.textContent=e}));var e,n},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,c(t))},remove:function(){return this.on("end.remove",(n=this._id,function(){var t,e=this.parentNode;for(t in this.__transition)if(+t!==n)return;e&&e.removeChild(this)}));var n},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=k(this.node(),n).tween,a=0,o=r.length;a<o;++a)if((i=r[a]).name===t)return i.value;return null}return this.each((null==e?function(r,a){var o,s;return function(){var t=B(this,r),e=t.tween;if(e!==o)for(var n=0,i=(s=o=e).length;n<i;++n)if(s[n].name===a){(s=s.slice()).splice(n,1);break}t.tween=s}}:function(a,o,s){var l,u;if("function"!=typeof s)throw new Error;return function(){var t=B(this,a),e=t.tween;if(e!==l){u=(l=e).slice();for(var n={name:o,value:s},i=0,r=u.length;i<r;++i)if(u[i].name===o){u[i]=n;break}i===r&&u.push(n)}t.tween=u}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){u(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){u(this,t).delay=e}})(e,t)):k(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){B(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){B(this,t).duration=e}})(e,t)):k(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){B(this,t).ease=e}}(e,t)):k(this.node(),e).ease},end:function(){var r,a,o=this,s=o._id,l=o.size();return new Promise(function(t,e){var n={value:e},i={value:function(){0==--l&&t()}};o.each(function(){var t=B(this,s),e=t.on;e!==r&&((a=(r=e).copy())._.cancel.push(n),a._.interrupt.push(n),a._.end.push(i)),t.on=a})})}};var d={time:null,delay:0,duration:250,ease:n.easeCubicInOut};D.selection.prototype.interrupt=function(t){return this.each(function(){r(this,t)})},D.selection.prototype.transition=function(t){var e,n;t=t instanceof L?(e=t._id,t._name):(e=++h,(n=d).time=g.now(),null==t?null:t+"");for(var i=this._groups,r=i.length,a=0;a<r;++a)for(var o,s=i[a],l=s.length,u=0;u<l;++u)(o=s[u])&&M(o,t,e,u,s,n||function(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return d.time=g.now(),d;return n}(o,e));return new L(i,this._parents,t,e)};var p=[null];t.active=function(t,e){var n,i,r=t.__transition;if(r)for(i in e=null==e?null:e+"",r)if((n=r[i]).state>b&&n.name===e)return new L([[t]],p,e,+i);return null},t.interrupt=r,t.transition=f,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-selection"),t("d3-dispatch"),t("d3-timer"),t("d3-interpolate"),t("d3-color"),t("d3-ease")):"function"==typeof define&&define.amd?define(["exports","d3-selection","d3-dispatch","d3-timer","d3-interpolate","d3-color","d3-ease"],r):r((i=i||self).d3=i.d3||{},i.d3,i.d3,i.d3,i.d3,i.d3,i.d3)},{"d3-color":16,"d3-dispatch":18,"d3-ease":21,"d3-interpolate":27,"d3-selection":34,"d3-timer":38}],40:[function(t,e,n){var i,r;i=this,r=function(t){"use strict";function i(t){return function(){return t}}function o(t){return t[0]}function s(t){return t[1]}function u(){this._=null}function n(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function l(t,e){var n=e,i=e.R,e=n.U;e?e.L===n?e.L=i:e.R=i:t._=i,i.U=e,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function c(t,e){var n=e,i=e.L,e=n.U;e?e.L===n?e.L=i:e.R=i:t._=i,i.U=e,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function h(t){for(;t.L;)t=t.L;return t}function b(t,e,n,i){var r=[null,null],a=A.push(r)-1;return r.left=t,r.right=e,n&&_(r,t,e,n),i&&_(r,e,t,i),T[t.index].halfedges.push(a),T[e.index].halfedges.push(a),r}function C(t,e,n){n=[e,n];return n.left=t,n}function _(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function f(t,e,n,i){for(var r,a=A.length;a--;)(function(t,e,n,i,r){var a=t[1];if(a)return 1;var o=t[0],s=t.left,l=t.right,u=s[0],c=s[1],h=l[0],f=l[1],s=(u+h)/2;if(f===c){if(s<e||i<=s)return;if(h<u){if(o){if(o[1]>=r)return}else o=[s,n];a=[s,r]}else{if(o){if(o[1]<n)return}else o=[s,r];a=[s,n]}}else if(s=(c+f)/2-(l=(u-h)/(f-c))*s,l<-1||1<l)if(h<u){if(o){if(o[1]>=r)return}else o=[(n-s)/l,n];a=[(r-s)/l,r]}else{if(o){if(o[1]<n)return}else o=[(r-s)/l,r];a=[(n-s)/l,n]}else if(c<f){if(o){if(o[0]>=i)return}else o=[e,l*e+s];a=[i,l*i+s]}else{if(o){if(o[0]<e)return}else o=[i,l*i+s];a=[e,l*e+s]}return t[0]=o,t[1]=a,1})(r=A[a],t,e,n,i)&&function(t,e,n,i,r){var a=t[0],o=t[1],s=a[0],l=a[1],u=0,c=1,a=o[0]-s,o=o[1]-l,e=e-s;if(a||!(0<e)){if(e/=a,a<0){if(e<u)return;e<c&&(c=e)}else if(0<a){if(c<e)return;u<e&&(u=e)}if(e=i-s,a||!(e<0)){if(e/=a,a<0){if(c<e)return;u<e&&(u=e)}else if(0<a){if(e<u)return;e<c&&(c=e)}if(e=n-l,o||!(0<e)){if(e/=o,o<0){if(e<u)return;e<c&&(c=e)}else if(0<o){if(c<e)return;u<e&&(u=e)}if(e=r-l,o||!(e<0)){if(e/=o,o<0){if(c<e)return;u<e&&(u=e)}else if(0<o){if(e<u)return;e<c&&(c=e)}return 0<u||c<1?(0<u&&(t[0]=[s+u*a,l+u*o]),c<1&&(t[1]=[s+c*a,l+c*o]),1):1}}}}}(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>B||Math.abs(r[0][1]-r[1][1])>B)||delete A[a]}function S(t,e){return e[+(e.left!==t.site)]}function d(){for(var t,e,n,i,r,a,o,s=0,l=T.length;s<l;++s)if((t=T[s])&&(n=(e=t.halfedges).length)){for(var u=new Array(n),c=new Array(n),h=0;h<n;++h)u[h]=h,c[h]=(i=t,r=A[e[h]],o=a=void 0,a=i.site,o=r.left,i=r.right,a===i&&(i=o,o=a),i?Math.atan2(i[1]-o[1],i[0]-o[0]):(i=a===o?(o=r[1],r[0]):(o=r[0],r[1]),Math.atan2(o[0]-i[0],i[1]-o[1])));for(u.sort(function(t,e){return c[e]-c[t]}),h=0;h<n;++h)c[h]=e[u[h]];for(h=0;h<n;++h)e[h]=c[h]}}u.prototype={constructor:u,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else n=this._?(t=h(this._),e.P=null,(e.N=t).P=t.L=e,t):(e.P=e.N=null,this._=e,null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(l(this,n),n=(t=n).U),n.C=!1,i.C=!0,c(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(c(this,n),n=(t=n).U),n.C=!1,i.C=!0,l(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i=t.U,r=t.L,a=t.R,o=r?a?h(a):r:a;if(i?i.L===t?i.L=o:i.R=o:this._=o,r&&a?(n=o.C,o.C=t.C,((o.L=r).U=o)!==a?(i=o.U,o.U=t.U,t=o.R,i.L=t,(o.R=a).U=o):(o.U=i,t=(i=o).R)):(n=t.C,t=o),t&&(t.U=i),!n)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,l(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,c(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,l(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,c(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,l(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,c(this,i),t=this._;break}}while(e.C=!0,i=(t=i).U,!t.C);t&&(t.C=!1)}}};var p,g=[];function m(){n(this),this.x=this.y=this.arc=this.site=this.cy=null}function x(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,a=n.site;if(i!==a){var o=r[0],s=r[1],l=i[0]-o,u=i[1]-s,c=a[0]-o,e=a[1]-s,n=2*(l*e-u*c);if(!(-P<=n)){var i=l*l+u*u,a=c*c+e*e,u=(e*i-u*a)/n,n=(l*a-c*i)/n,h=g.pop()||new m;h.arc=t,h.site=r,h.x=u+o,h.y=(h.cy=n+s)+Math.sqrt(u*u+n*n),t.circle=h;for(var f=null,d=D._;d;)if(h.y<d.y||h.y===d.y&&h.x<=d.x){if(!d.L){f=d.P;break}d=d.L}else{if(!d.R){f=d;break}d=d.R}D.insert(f,h),f||(p=h)}}}}function w(t){var e=t.circle;e&&(e.P||(p=e.N),D.remove(e),g.push(e),n(e),t.circle=null)}var r=[];function a(){n(this),this.edge=this.site=this.circle=null}function M(t){var e=r.pop()||new a;return e.site=t,e}function v(t){w(t),L.remove(t),r.push(t),n(t)}function y(t){for(var e,n,i,r,a=t[0],o=t[1],s=L._;s;)if(i=k(s,o)-a,B<i)s=s.L;else{if(r=a-function(t,e){var n=t.N;if(n)return k(n,e);t=t.site;return t[1]===e?t[0]:1/0}(s,o),!(B<r)){-B<i?(e=s.P,n=s):-B<r?n=(e=s).N:e=n=s;break}if(!s.R){e=s;break}s=s.R}T[(m=t).index]={site:m,halfedges:[]};var l,u,c,h,f,d,p,g,m,v,y=M(t);if(L.insert(e,y),e||n){if(e===n)return w(e),n=M(e.site),L.insert(y,n),y.edge=n.edge=b(e.site,y.site),x(e),void x(n);n?(w(e),w(n),u=(l=e.site)[0],v=l[1],c=t[0]-u,p=t[1]-v,f=(h=n.site)[0]-u,d=h[1]-v,_(n.edge,l,h,v=[(d*(g=c*c+p*p)-p*(m=f*f+d*d))/(p=2*(c*d-p*f))+u,(c*m-f*g)/p+v]),y.edge=b(l,t,null,v),n.edge=b(t,h,null,v),x(e),x(n)):y.edge=b(e.site,y.site)}}function k(t,e){var n=t.site,i=n[0],r=n[1],a=r-e;if(!a)return i;var o=t.P;if(!o)return-1/0;var s=(n=o.site)[0],l=n[1],t=l-e;if(!t)return s;o=s-i,n=1/a-1/t,e=o/t;return n?(-e+Math.sqrt(e*e-2*n*(o*o/(-2*t)-l+t/2+r-a/2)))/n+i:(i+s)/2}var L,T,D,A,B=1e-6,P=1e-12;function E(t,e){return e[1]-t[1]||e[0]-t[0]}function O(t,e){var n,i,r,a,o,s,l=t.sort(E).pop();for(A=[],T=new Array(t.length),L=new u,D=new u;;)if(r=p,l&&(!r||l[1]<r.y||l[1]===r.y&&l[0]<r.x))l[0]===n&&l[1]===i||(y(l),n=l[0],i=l[1]),l=t.pop();else{if(!r)break;!function(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],a=t.P,o=t.N,s=[t];v(t);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<B&&Math.abs(i-l.circle.cy)<B;)a=l.P,s.unshift(l),v(l),l=a;s.unshift(l),w(l);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<B&&Math.abs(i-u.circle.cy)<B;)o=u.N,s.push(u),v(u),u=o;s.push(u),w(u);for(var c=s.length,h=1;h<c;++h)u=s[h],l=s[h-1],_(u.edge,l.site,u.site,r);l=s[0],(u=s[c-1]).edge=b(l.site,u.site,null,r),x(l),x(u)}(r.arc)}d(),e&&(f(a=+e[0][0],o=+e[0][1],s=+e[1][0],e=+e[1][1]),function(t,e,n,i){var r,a,o,s,l,u,c,h,f,d,p=T.length,g=!0;for(w=0;w<p;++w)if(r=T[w]){for(a=r.site,o=(s=r.halfedges).length;o--;)A[s[o]]||s.splice(o,1);for(o=0,l=s.length;o<l;)f=r,c=(u=(d=A[s[o]])[+(d.left===f.site)])[0],h=u[1],f=(d=S(r,A[s[++o%l]]))[0],d=d[1],(Math.abs(c-f)>B||Math.abs(h-d)>B)&&(s.splice(o,0,A.push(C(a,u,Math.abs(c-t)<B&&B<i-h?[t,Math.abs(f-t)<B?d:i]:Math.abs(h-i)<B&&B<n-c?[Math.abs(d-i)<B?f:n,i]:Math.abs(c-n)<B&&B<h-e?[n,Math.abs(f-n)<B?d:e]:Math.abs(h-e)<B&&B<c-t?[Math.abs(d-e)<B?f:t,e]:null))-1),++l);l&&(g=!1)}if(g){for(var m,v,y,b,_,x=1/0,w=0,g=null;w<p;++w)(r=T[w])&&(m=(m=(a=r.site)[0]-t)*m+(m=a[1]-e)*m)<x&&(x=m,g=r);g&&(b=[n,i],_=[n,e],g.halfedges.push(A.push(C(a=g.site,v=[t,e],y=[t,i]))-1,A.push(C(a,y,b))-1,A.push(C(a,b,_))-1,A.push(C(a,_,v))-1))}for(w=0;w<p;++w)(r=T[w])&&(r.halfedges.length||delete T[w])}(a,o,s,e)),this.edges=A,this.cells=T,L=D=A=T=null}O.prototype={constructor:O,polygons:function(){var n=this.edges;return this.cells.map(function(e){var t=e.halfedges.map(function(t){return S(e,n[t])});return t.data=e.site.data,t})},triangles:function(){var f=[],d=this.edges;return this.cells.forEach(function(t,e){if(i=(n=t.halfedges).length)for(var n,i,r,a,o,s,l=t.site,u=-1,c=d[n[i-1]],h=c.left===l?c.right:c.left;++u<i;)r=h,h=(c=d[n[u]]).left===l?c.right:c.left,r&&h&&e<r.index&&e<h.index&&(o=r,s=h,((a=l)[0]-s[0])*(o[1]-a[1])-(a[0]-o[0])*(s[1]-a[1])<0)&&f.push([l.data,r.data,h.data])}),f},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(n,i,t){for(var e,r,a=this,o=a._found||0,s=a.cells.length;!(r=a.cells[o]);)if(++o>=s)return null;for(var l=n-r.site[0],u=i-r.site[1],c=l*l+u*u;r=a.cells[e=o],o=null,r.halfedges.forEach(function(t){var e=a.edges[t],t=e.left;!(t!==r.site&&t||(t=e.right))||(e=(e=n-t[0])*e+(e=i-t[1])*e)<c&&(c=e,o=t.index)}),null!==o;);return a._found=e,null==t||c<=t*t?r.site:null}},t.voronoi=function(){var r=o,a=s,e=null;function n(i){return new O(i.map(function(t,e){var n=[Math.round(r(t,e,i)/B)*B,Math.round(a(t,e,i)/B)*B];return n.index=e,n.data=t,n}),e)}return n.polygons=function(t){return n(t).polygons()},n.links=function(t){return n(t).links()},n.triangles=function(t){return n(t).triangles()},n.x=function(t){return arguments.length?(r="function"==typeof t?t:i(+t),n):r},n.y=function(t){return arguments.length?(a="function"==typeof t?t:i(+t),n):a},n.extent=function(t){return arguments.length?(e=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],n):e&&[[e[0][0],e[0][1]],[e[1][0],e[1][1]]]},n.size=function(t){return arguments.length?(e=null==t?null:[[0,0],[+t[0],+t[1]]],n):e&&[e[1][0]-e[0][0],e[1][1]-e[0][1]]},n},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(i.d3=i.d3||{})},{}],41:[function(t,e,n){var i,r;i=this,r=function(t,D,A,B,P,E){"use strict";function O(t){return function(){return t}}function I(t,e,n){this.target=t,this.type=e,this.transform=n}function F(t,e,n){this.k=t,this.x=e,this.y=n}F.prototype={constructor:F,scale:function(t){return 1===t?this:new F(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new F(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var j=new F(1,0,0);function e(t){for(;!t.__zoom;)if(!(t=t.parentNode))return j;return t.__zoom}function N(){P.event.stopImmediatePropagation()}function R(){P.event.preventDefault(),P.event.stopImmediatePropagation()}function W(){return!P.event.ctrlKey&&!P.event.button}function H(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function z(){return this.__zoom||j}function q(){return-P.event.deltaY*(1===P.event.deltaMode?.05:P.event.deltaMode?1:.002)}function G(){return navigator.maxTouchPoints||"ontouchstart"in this}function U(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],n=t.invertY(e[1][1])-n[1][1];return t.translate(i<r?(i+r)/2:Math.min(0,i)||Math.max(0,r),a<n?(a+n)/2:Math.min(0,a)||Math.max(0,n))}e.prototype=F.prototype,t.zoom=function(){var f,o,s=W,u=H,d=U,r=q,e=G,a=[0,1/0],p=[[-1/0,-1/0],[1/0,1/0]],l=250,c=B.interpolateZoom,n=D.dispatch("start","zoom","end"),h=500,g=150,m=0;function v(t){t.property("__zoom",z).on("wheel.zoom",C).on("mousedown.zoom",S).on("dblclick.zoom",M).filter(e).on("touchstart.zoom",k).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",T).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(t,e){return(e=Math.max(a[0],Math.min(a[1],e)))===t.k?t:new F(e,t.x,t.y)}function b(t,e,n){var i=e[0]-n[0]*t.k,n=e[1]-n[1]*t.k;return i===t.x&&n===t.y?t:new F(t.k,i,n)}function _(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function x(t,n,l){t.on("start.zoom",function(){w(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).end()}).tween("zoom",function(){var t=arguments,i=w(this,t),e=u.apply(this,t),r=null==l?_(e):"function"==typeof l?l.apply(this,t):l,a=Math.max(e[1][0]-e[0][0],e[1][1]-e[0][1]),e=this.__zoom,o="function"==typeof n?n.apply(this,t):n,s=c(e.invert(r).concat(a/e.k),o.invert(r).concat(a/o.k));return function(t){var e,n;t=1===t?o:(e=s(t),new F(n=a/e[2],r[0]-e[0]*n,r[1]-e[1]*n)),i.zoom(null,t)}})}function w(t,e,n){return!n&&t.__zooming||new i(t,e)}function i(t,e){this.that=t,this.args=e,this.active=0,this.extent=u.apply(t,e),this.taps=0}function C(){if(s.apply(this,arguments)){var t=w(this,arguments),e=this.__zoom,n=Math.max(a[0],Math.min(a[1],e.k*Math.pow(2,r.apply(this,arguments)))),i=P.mouse(this);if(t.wheel)t.mouse[0][0]===i[0]&&t.mouse[0][1]===i[1]||(t.mouse[1]=e.invert(t.mouse[0]=i)),clearTimeout(t.wheel);else{if(e.k===n)return;t.mouse=[i,e.invert(i)],E.interrupt(this),t.start()}R(),t.wheel=setTimeout(function(){t.wheel=null,t.end()},g),t.zoom("mouse",d(b(y(e,n),t.mouse[0],t.mouse[1]),t.extent,p))}}function S(){var n,t,e,i,r;!o&&s.apply(this,arguments)&&(n=w(this,arguments,!0),t=P.select(P.event.view).on("mousemove.zoom",function(){{var t,e;R(),n.moved||(t=P.event.clientX-i,e=P.event.clientY-r,n.moved=m<t*t+e*e)}n.zoom("mouse",d(b(n.that.__zoom,n.mouse[0]=P.mouse(n.that),n.mouse[1]),n.extent,p))},!0).on("mouseup.zoom",function(){t.on("mousemove.zoom mouseup.zoom",null),A.dragEnable(P.event.view,n.moved),R(),n.end()},!0),e=P.mouse(this),i=P.event.clientX,r=P.event.clientY,A.dragDisable(P.event.view),N(),n.mouse=[e,this.__zoom.invert(e)],E.interrupt(this),n.start())}function M(){var t,e,n,i;s.apply(this,arguments)&&(t=this.__zoom,e=P.mouse(this),i=t.invert(e),n=t.k*(P.event.shiftKey?.5:2),i=d(b(y(t,n),e,i),u.apply(this,arguments),p),R(),0<l?P.select(this).transition().duration(l).call(x,i,e):P.select(this).call(v.transform,i))}function k(){if(s.apply(this,arguments)){var t,e,n,i,r=P.event.touches,a=r.length,o=w(this,arguments,P.event.changedTouches.length===a);for(N(),e=0;e<a;++e)n=r[e],i=[i=P.touch(this,r,n.identifier),this.__zoom.invert(i),n.identifier],o.touch0?o.touch1||o.touch0[2]===i[2]||(o.touch1=i,o.taps=0):(o.touch0=i,t=!0,o.taps=1+!!f);f=f&&clearTimeout(f),t&&(o.taps<2&&(f=setTimeout(function(){f=null},h)),E.interrupt(this),o.start())}}function L(){if(this.__zooming){var t,e=w(this,arguments),n=P.event.changedTouches,i=n.length;for(R(),f=f&&clearTimeout(f),t=e.taps=0;t<i;++t)c=n[t],h=P.touch(this,n,c.identifier),e.touch0&&e.touch0[2]===c.identifier?e.touch0[0]=h:e.touch1&&e.touch1[2]===c.identifier&&(e.touch1[0]=h);if(c=e.that.__zoom,e.touch1)var r=e.touch0[0],a=e.touch0[1],o=e.touch1[0],s=e.touch1[1],l=(l=o[0]-r[0])*l+(l=o[1]-r[1])*l,u=(u=s[0]-a[0])*u+(u=s[1]-a[1])*u,c=y(c,Math.sqrt(l/u)),h=[(r[0]+o[0])/2,(r[1]+o[1])/2],s=[(a[0]+s[0])/2,(a[1]+s[1])/2];else{if(!e.touch0)return;h=e.touch0[0],s=e.touch0[1]}e.zoom("touch",d(b(c,h,s),e.extent,p))}}function T(){if(this.__zooming){var t,e,n,i=w(this,arguments),r=P.event.changedTouches,a=r.length;for(N(),o&&clearTimeout(o),o=setTimeout(function(){o=null},h),t=0;t<a;++t)e=r[t],i.touch0&&i.touch0[2]===e.identifier?delete i.touch0:i.touch1&&i.touch1[2]===e.identifier&&delete i.touch1;i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0?i.touch0[1]=this.__zoom.invert(i.touch0[0]):(i.end(),2!==i.taps||(n=P.select(this).on("dblclick.zoom"))&&n.apply(this,arguments))}}return v.transform=function(t,e,n){var i=t.selection?t.selection():t;i.property("__zoom",z),t!==i?x(t,e,n):i.interrupt().each(function(){w(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},v.scaleBy=function(t,e,n){v.scaleTo(t,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)},n)},v.scaleTo=function(t,a,o){v.transform(t,function(){var t=u.apply(this,arguments),e=this.__zoom,n=null==o?_(t):"function"==typeof o?o.apply(this,arguments):o,i=e.invert(n),r="function"==typeof a?a.apply(this,arguments):a;return d(b(y(e,r),n,i),t,p)},o)},v.translateBy=function(t,e,n){v.transform(t,function(){return d(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),u.apply(this,arguments),p)})},v.translateTo=function(t,i,r,a){v.transform(t,function(){var t=u.apply(this,arguments),e=this.__zoom,n=null==a?_(t):"function"==typeof a?a.apply(this,arguments):a;return d(j.translate(n[0],n[1]).scale(e.k).translate("function"==typeof i?-i.apply(this,arguments):-i,"function"==typeof r?-r.apply(this,arguments):-r),t,p)},a)},i.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this).emit("start"),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){P.customEvent(new I(v,t,this.that.__zoom),n.apply,n,[t,this.that,this.args])}},v.wheelDelta=function(t){return arguments.length?(r="function"==typeof t?t:O(+t),v):r},v.filter=function(t){return arguments.length?(s="function"==typeof t?t:O(!!t),v):s},v.touchable=function(t){return arguments.length?(e="function"==typeof t?t:O(!!t),v):e},v.extent=function(t){return arguments.length?(u="function"==typeof t?t:O([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),v):u},v.scaleExtent=function(t){return arguments.length?(a[0]=+t[0],a[1]=+t[1],v):[a[0],a[1]]},v.translateExtent=function(t){return arguments.length?(p[0][0]=+t[0][0],p[1][0]=+t[1][0],p[0][1]=+t[0][1],p[1][1]=+t[1][1],v):[[p[0][0],p[0][1]],[p[1][0],p[1][1]]]},v.constrain=function(t){return arguments.length?(d=t,v):d},v.duration=function(t){return arguments.length?(l=+t,v):l},v.interpolate=function(t){return arguments.length?(c=t,v):c},v.on=function(){var t=n.on.apply(n,arguments);return t===n?v:t},v.clickDistance=function(t){return arguments.length?(m=(t=+t)*t,v):Math.sqrt(m)},v},t.zoomIdentity=j,t.zoomTransform=e,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?r(n,t("d3-dispatch"),t("d3-drag"),t("d3-interpolate"),t("d3-selection"),t("d3-transition")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-drag","d3-interpolate","d3-selection","d3-transition"],r):r((i=i||self).d3=i.d3||{},i.d3,i.d3,i.d3,i.d3,i.d3)},{"d3-dispatch":18,"d3-drag":19,"d3-interpolate":27,"d3-selection":34,"d3-transition":39}],42:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("d3-array"),r=t("d3-axis"),a=t("d3-brush"),o=t("d3-chord"),s=t("d3-collection"),l=t("d3-color"),u=t("d3-contour"),c=t("d3-dispatch"),h=t("d3-drag"),f=t("d3-dsv"),d=t("d3-ease"),p=t("d3-fetch"),g=t("d3-force"),m=t("d3-format"),v=t("d3-geo"),y=t("d3-hierarchy"),b=t("d3-interpolate"),_=t("d3-path"),x=t("d3-polygon"),w=t("d3-quadtree"),C=t("d3-random"),S=t("d3-scale"),M=t("d3-scale-chromatic"),k=t("d3-selection"),L=t("d3-shape"),T=t("d3-time"),D=t("d3-time-format"),A=t("d3-timer"),B=t("d3-transition"),P=t("d3-voronoi"),E=t("d3-zoom");Object.keys(i).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return i[t]}})}),Object.keys(r).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return r[t]}})}),Object.keys(a).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return a[t]}})}),Object.keys(o).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return o[t]}})}),Object.keys(s).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return s[t]}})}),Object.keys(l).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return l[t]}})}),Object.keys(u).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return u[t]}})}),Object.keys(c).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return c[t]}})}),Object.keys(h).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return h[t]}})}),Object.keys(f).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return f[t]}})}),Object.keys(d).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return d[t]}})}),Object.keys(p).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return p[t]}})}),Object.keys(g).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return g[t]}})}),Object.keys(m).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return m[t]}})}),Object.keys(v).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return v[t]}})}),Object.keys(y).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return y[t]}})}),Object.keys(b).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return b[t]}})}),Object.keys(_).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return _[t]}})}),Object.keys(x).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return x[t]}})}),Object.keys(w).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return w[t]}})}),Object.keys(C).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return C[t]}})}),Object.keys(S).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return S[t]}})}),Object.keys(M).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return M[t]}})}),Object.keys(k).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return k[t]}})}),Object.keys(L).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return L[t]}})}),Object.keys(T).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return T[t]}})}),Object.keys(D).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return D[t]}})}),Object.keys(A).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return A[t]}})}),Object.keys(B).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return B[t]}})}),Object.keys(P).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return P[t]}})}),Object.keys(E).forEach(function(t){"default"!==t&&Object.defineProperty(n,t,{enumerable:!0,get:function(){return E[t]}})}),n.version="5.15.0"},{"d3-array":11,"d3-axis":12,"d3-brush":13,"d3-chord":14,"d3-collection":15,"d3-color":16,"d3-contour":17,"d3-dispatch":18,"d3-drag":19,"d3-dsv":20,"d3-ease":21,"d3-fetch":22,"d3-force":23,"d3-format":24,"d3-geo":25,"d3-hierarchy":26,"d3-interpolate":27,"d3-path":28,"d3-polygon":29,"d3-quadtree":30,"d3-random":31,"d3-scale":33,"d3-scale-chromatic":32,"d3-selection":34,"d3-shape":35,"d3-time":37,"d3-time-format":36,"d3-timer":38,"d3-transition":39,"d3-voronoi":40,"d3-zoom":41}],43:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var l=t("./wrap-idb-value.js");const o=["get","getKey","getAll","getAllKeys","count"],s=["put","add","delete","clear"],u=new Map;function r(t,e){if(t instanceof IDBDatabase&&!(e in t)&&"string"==typeof e){if(u.get(e))return u.get(e);const i=e.replace(/FromIndex$/,""),r=e!==i,a=s.includes(i);if(i in(r?IDBIndex:IDBObjectStore).prototype&&(a||o.includes(i))){t=async function(t,...e){t=this.transaction(t,a?"readwrite":"readonly");let n=t.store;return r&&(n=n.index(e.shift())),(await Promise.all([n[i](...e),a&&t.done]))[0]};return u.set(e,t),t}}}l.replaceTraps(i=>({...i,get:(t,e,n)=>r(t,e)||i.get(t,e,n),has:(t,e)=>!!r(t,e)||i.has(t,e)})),n.unwrap=l.unwrap,n.wrap=l.wrap,n.deleteDB=function(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),l.wrap(n).then(()=>{})},n.openDB=function(t,e,{blocked:n,upgrade:i,blocking:r,terminated:a}={}){const o=indexedDB.open(t,e),s=l.wrap(o);return i&&o.addEventListener("upgradeneeded",t=>{i(l.wrap(o.result),t.oldVersion,t.newVersion,l.wrap(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),s.then(t=>{a&&t.addEventListener("close",()=>a()),r&&t.addEventListener("versionchange",()=>r())}).catch(()=>{}),s}},{"./wrap-idb-value.js":44}],44:[function(t,e,n){"use strict";const i=(e,t)=>t.some(t=>e instanceof t);let r,a;const o=new WeakMap,s=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap;let h={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return s.get(t);if("objectStoreNames"===e)return t.objectStoreNames||l.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return p(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t}};function f(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(a=a||[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]).includes(n)?function(...t){return n.apply(g(this),t),p(o.get(this))}:function(...t){return p(n.apply(g(this),t))}:function(t,...e){e=n.call(g(this),t,...e);return l.set(e,t.sort?t.sort():[t]),p(e)}}function d(t){return"function"==typeof t?f(t):(t instanceof IDBTransaction&&(a=t,s.has(a)||(e=new Promise((t,e)=>{const n=()=>{a.removeEventListener("complete",i),a.removeEventListener("error",r),a.removeEventListener("abort",r)},i=()=>{t(),n()},r=()=>{e(a.error||new DOMException("AbortError","AbortError")),n()};a.addEventListener("complete",i),a.addEventListener("error",r),a.addEventListener("abort",r)}),s.set(a,e))),i(t,r=r||[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])?new Proxy(t,h):t);var a,e}function p(t){if(t instanceof IDBRequest)return function(a){const t=new Promise((t,e)=>{const n=()=>{a.removeEventListener("success",i),a.removeEventListener("error",r)},i=()=>{t(p(a.result)),n()},r=()=>{e(a.error),n()};a.addEventListener("success",i),a.addEventListener("error",r)});return t.then(t=>{t instanceof IDBCursor&&o.set(t,a)}).catch(()=>{}),c.set(t,a),t}(t);if(u.has(t))return u.get(t);var e=d(t);return e!==t&&(u.set(t,e),c.set(e,t)),e}const g=t=>c.get(t);n.instanceOfAny=i,n.replaceTraps=function(t){h=t(h)},n.reverseTransformCache=c,n.unwrap=g,n.wrap=p},{}],45:[function(t,m,v){!function(g){!function(){"use strict";var t="object"==typeof self&&self.self===self&&self||"object"==typeof g&&g.global===g&&g||this,e=9007199254740991;function i(t){return"number"==typeof t&&t==t&&t!==1/0&&t!==-1/0}function r(t){return"number"==typeof t&&Math.abs(t)<=e}var n=/(hundred|thousand|(m|b|tr|quadr)illion)$/,a=/teen$/,o=/y$/,s=/(zero|one|two|three|four|five|six|seven|eight|nine|ten|eleven|twelve)$/,l={zero:"zeroth",one:"first",two:"second",three:"third",four:"fourth",five:"fifth",six:"sixth",seven:"seventh",eight:"eighth",nine:"ninth",ten:"tenth",eleven:"eleventh",twelve:"twelfth"};function u(t){return n.test(t)||a.test(t)?t+"th":o.test(t)?t.replace(o,"ieth"):s.test(t)?t.replace(s,c):t}function c(t,e){return l[e]}var h=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],f=["zero","ten","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"];function d(t,e){var n=parseInt(t,10);if(!i(n))throw new TypeError("Not a finite number: "+t+" ("+typeof t+")");if(!r(n))throw new RangeError("Input is not a safe number, its either too large or too small.");return n=function t(e){var n,i,r=arguments[1];return 0===e?r?r.join(" ").replace(/,$/,""):"zero":(r=r||[],e<0&&(r.push("minus"),e=Math.abs(e)),e<20?(n=0,i=h[e]):e<100?(n=e%10,i=f[Math.floor(e/10)],n&&(i+="-"+h[n],n=0)):e<1e3?(n=e%100,i=t(Math.floor(e/100))+" hundred"):e<1e6?(n=e%1e3,i=t(Math.floor(e/1e3))+" thousand,"):e<1e9?(n=e%1e6,i=t(Math.floor(e/1e6))+" million,"):e<1e12?(n=e%1e9,i=t(Math.floor(e/1e9))+" billion,"):e<1e15?(n=e%1e12,i=t(Math.floor(e/1e12))+" trillion,"):e<=9007199254740992&&(n=e%1e15,i=t(Math.floor(e/1e15))+" quadrillion,"),r.push(i),t(n,r))}(n),e?u(n):n}var p={toOrdinal:function(t){var e=parseInt(t,10);if(!i(e))throw new TypeError("Not a finite number: "+t+" ("+typeof t+")");if(!r(e))throw new RangeError("Input is not a safe number, its either too large or too small.");var n=String(e),t=Math.abs(e%100),e=11<=t&&t<=13,t=n.charAt(n.length-1);return n+(e?"th":"1"===t?"st":"2"===t?"nd":"3"===t?"rd":"th")},toWords:d,toWordsOrdinal:function(t){return u(d(t))}};void 0!==v?(v=void 0!==m&&m.exports?m.exports=p:v).numberToWords=p:t.numberToWords=p}()}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(t,e,n){"use strict";e.exports=t("./src/index")},{"./src/index":55}],47:[function(t,e,n){"use strict";e.exports=r;var i=/\/|\./;function r(t,e){i.test(t)||(t="google/protobuf/"+t+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),r[t]=e}r("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),r("duration",{Duration:e={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),r("timestamp",{Timestamp:e}),r("empty",{Empty:{fields:{}}}),r("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),r("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),r("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),r.get=function(t){return r[t]||null}},{}],48:[function(t,e,n){"use strict";var n=n,f=t("./enum"),d=t("./util");function o(t,e,n,i){if(e.resolvedType)if(e.resolvedType instanceof f){t("switch(d%s){",i);for(var r=e.resolvedType.values,a=Object.keys(r),o=0;o<a.length;++o)e.repeated&&r[a[o]]===e.typeDefault&&t("default:"),t("case%j:",a[o])("case %i:",r[a[o]])("m%s=%j",i,r[a[o]])("break");t("}")}else t('if(typeof d%s!=="object")',i)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,n,i);else{var s=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",i,i);break;case"uint64":s=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,s)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,s?"true":"");break;case"bytes":t('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length)",i)("m%s=d%s",i,i);break;case"string":t("m%s=String(d%s)",i,i);break;case"bool":t("m%s=Boolean(d%s)",i,i)}}return t}function p(t,e,n,i){if(e.resolvedType)e.resolvedType instanceof f?t("d%s=o.enums===String?types[%i].values[m%s]:m%s",i,n,i,i):t("d%s=types[%i].toObject(m%s,o)",i,n,i);else{var r=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":r=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,r?"true":"",i);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:t("d%s=m%s",i,i)}}return t}n.fromObject=function(t){var e=t.fieldsArray,n=d.codegen(["d"],t.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!e.length)return n("return new this.ctor");n("var m=new this.ctor");for(var i=0;i<e.length;++i){var r=e[i].resolve(),a=d.safeProp(r.name);r.map?(n("if(d%s){",a)('if(typeof d%s!=="object")',a)("throw TypeError(%j)",r.fullName+": object expected")("m%s={}",a)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",a),o(n,r,i,a+"[ks[i]]")("}")("}")):r.repeated?(n("if(d%s){",a)("if(!Array.isArray(d%s))",a)("throw TypeError(%j)",r.fullName+": array expected")("m%s=[]",a)("for(var i=0;i<d%s.length;++i){",a),o(n,r,i,a+"[i]")("}")("}")):(r.resolvedType instanceof f||n("if(d%s!=null){",a),o(n,r,i,a),r.resolvedType instanceof f||n("}"))}return n("return m")},n.toObject=function(t){var e=t.fieldsArray.slice().sort(d.compareFieldsById);if(!e.length)return d.codegen()("return {}");for(var n=d.codegen(["m","o"],t.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],r=[],a=[],o=0;o<e.length;++o)e[o].partOf||(e[o].resolve().repeated?i:e[o].map?r:a).push(e[o]);if(i.length){for(n("if(o.arrays||o.defaults){"),o=0;o<i.length;++o)n("d%s=[]",d.safeProp(i[o].name));n("}")}if(r.length){for(n("if(o.objects||o.defaults){"),o=0;o<r.length;++o)n("d%s={}",d.safeProp(r[o].name));n("}")}if(a.length){for(n("if(o.defaults){"),o=0;o<a.length;++o){var s,l=a[o],u=d.safeProp(l.name);l.resolvedType instanceof f?n("d%s=o.enums===String?%j:%j",u,l.resolvedType.valuesById[l.typeDefault],l.typeDefault):l.long?n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",u)("}else")("d%s=o.longs===String?%j:%i",u,l.typeDefault.toString(),l.typeDefault.toNumber()):l.bytes?(s="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]",n("if(o.bytes===String)d%s=%j",u,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",u,s)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",u,u)("}")):n("d%s=%j",u,l.typeDefault)}n("}")}for(var c=!1,o=0;o<e.length;++o){var l=e[o],h=t._fieldsArray.indexOf(l),u=d.safeProp(l.name);l.map?(c||(c=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",u,u)("d%s={}",u)("for(var j=0;j<ks2.length;++j){"),p(n,l,h,u+"[ks2[j]]")("}")):l.repeated?(n("if(m%s&&m%s.length){",u,u)("d%s=[]",u)("for(var j=0;j<m%s.length;++j){",u),p(n,l,h,u+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",u,l.name),p(n,l,h,u),l.partOf&&n("if(o.oneofs)")("d%s=%j",d.safeProp(l.partOf.name),l.name)),n("}")}return n("return d")}},{"./enum":51,"./util":73}],49:[function(t,e,n){"use strict";e.exports=function(t){var e=u.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(t){return t.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");t.group&&e("if((t&7)===4)")("break");e("switch(t>>>3){");for(var n=0;n<t.fieldsArray.length;++n){var i=t._fieldsArray[n].resolve(),r=i.resolvedType instanceof s?"int32":i.type,a="m"+u.safeProp(i.name);e("case %i:",i.id),i.map?(e("if(%s===util.emptyObject)",a)("%s={}",a)("var c2 = r.uint32()+r.pos"),void 0!==l.defaults[i.keyType]?e("k=%j",l.defaults[i.keyType]):e("k=null"),void 0!==l.defaults[r]?e("value=%j",l.defaults[r]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",i.keyType)("case 2:"),void 0===l.basic[r]?e("value=types[%i].decode(r,r.uint32())",n):e("value=r.%s()",r),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==l.long[i.keyType]?e('%s[typeof k==="object"?util.longToHash(k):k]=value',a):e("%s[k]=value",a)):i.repeated?(e("if(!(%s&&%s.length))",a,a)("%s=[]",a),void 0!==l.packed[r]&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",a,r)("}else"),void 0===l.basic[r]?e(i.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",a,n):e("%s.push(r.%s())",a,r)):void 0===l.basic[r]?e(i.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",a,n):e("%s=r.%s()",a,r),e("break")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<t._fieldsArray.length;++n){var o=t._fieldsArray[n];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})","missing required '"+o.name+"'")}return e("return m")};var s=t("./enum"),l=t("./types"),u=t("./util")},{"./enum":51,"./types":72,"./util":73}],50:[function(t,e,n){"use strict";e.exports=function(t){for(var e,n=h.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),i=t.fieldsArray.slice().sort(h.compareFieldsById),r=0;r<i.length;++r){var a=i[r].resolve(),o=t._fieldsArray.indexOf(a),s=a.resolvedType instanceof u?"int32":a.type,l=c.basic[s];e="m"+h.safeProp(a.name),a.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",e,a.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",e)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(a.id<<3|2)>>>0,8|c.mapKey[a.keyType],a.keyType),void 0===l?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,e):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,s,e),n("}")("}")):a.repeated?(n("if(%s!=null&&%s.length){",e,e),a.packed&&void 0!==c.packed[s]?n("w.uint32(%i).fork()",(a.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",e)("w.%s(%s[i])",s,e)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",e),void 0===l?f(n,a,o,e+"[i]"):n("w.uint32(%i).%s(%s[i])",(a.id<<3|l)>>>0,s,e)),n("}")):(a.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",e,a.name),void 0===l?f(n,a,o,e):n("w.uint32(%i).%s(%s)",(a.id<<3|l)>>>0,s,e))}return n("return w")};var u=t("./enum"),c=t("./types"),h=t("./util");function f(t,e,n,i){return e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,i,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,i,(e.id<<3|2)>>>0)}},{"./enum":51,"./types":72,"./util":73}],51:[function(t,e,n){"use strict";e.exports=a;var s=t("./object");((a.prototype=Object.create(s.prototype)).constructor=a).className="Enum";var i=t("./namespace"),r=t("./util");function a(t,e,n,i,r){if(s.call(this,t,n),e&&"object"!=typeof e)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=r||{},this.reserved=void 0,e)for(var a=Object.keys(e),o=0;o<a.length;++o)"number"==typeof e[a[o]]&&(this.valuesById[this.values[a[o]]=e[a[o]]]=a[o])}a.fromJSON=function(t,e){t=new a(t,e.values,e.options,e.comment,e.comments);return t.reserved=e.reserved,t},a.prototype.toJSON=function(t){t=!!t&&Boolean(t.keepComments);return r.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},a.prototype.add=function(t,e,n){if(!r.isString(t))throw TypeError("name must be a string");if(!r.isInteger(e))throw TypeError("id must be an integer");if(void 0!==this.values[t])throw Error("duplicate name '"+t+"' in "+this);if(this.isReservedId(e))throw Error("id "+e+" is reserved in "+this);if(this.isReservedName(t))throw Error("name '"+t+"' is reserved in "+this);if(void 0!==this.valuesById[e]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+e+" in "+this);this.values[t]=e}else this.valuesById[this.values[t]=e]=t;return this.comments[t]=n||null,this},a.prototype.remove=function(t){if(!r.isString(t))throw TypeError("name must be a string");var e=this.values[t];if(null==e)throw Error("name '"+t+"' does not exist in "+this);return delete this.valuesById[e],delete this.values[t],delete this.comments[t],this},a.prototype.isReservedId=function(t){return i.isReservedId(this.reserved,t)},a.prototype.isReservedName=function(t){return i.isReservedName(this.reserved,t)}},{"./namespace":59,"./object":60,"./util":73}],52:[function(t,e,n){"use strict";e.exports=o;var s=t("./object");((o.prototype=Object.create(s.prototype)).constructor=o).className="Field";var i,r=t("./enum"),l=t("./types"),u=t("./util"),c=/^required|optional|repeated$/;function o(t,e,n,i,r,a,o){if(u.isObject(i)?(o=r,a=i,i=r=void 0):u.isObject(r)&&(o=a,a=r,r=void 0),s.call(this,t,a),!u.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!u.isString(n))throw TypeError("type must be a string");if(void 0!==i&&!c.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==r&&!u.isString(r))throw TypeError("extend must be a string");this.rule=i&&"optional"!==i?i:void 0,this.type=n,this.id=e,this.extend=r||void 0,this.required="required"===i,this.optional=!this.required,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!u.Long&&void 0!==l.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}o.fromJSON=function(t,e){return new o(t,e.id,e.type,e.rule,e.extend,e.options,e.comment)},Object.defineProperty(o.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),o.prototype.setOption=function(t,e,n){return"packed"===t&&(this._packed=null),s.prototype.setOption.call(this,t,e,n)},o.prototype.toJSON=function(t){t=!!t&&Boolean(t.keepComments);return u.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},o.prototype.resolve=function(){return this.resolved?this:(void 0===(this.typeDefault=l.defaults[this.type])&&(this.resolvedType=(this.declaringField||this).parent.lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof r&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof r)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long?(this.typeDefault=u.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault)):this.bytes&&"string"==typeof this.typeDefault&&(u.base64.test(this.typeDefault)?u.base64.decode(this.typeDefault,t=u.newBuffer(u.base64.length(this.typeDefault)),0):u.utf8.write(this.typeDefault,t=u.newBuffer(u.utf8.length(this.typeDefault)),0),this.typeDefault=t),this.map?this.defaultValue=u.emptyObject:this.repeated?this.defaultValue=u.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),s.prototype.resolve.call(this));var t},o.d=function(n,i,r,a){return"function"==typeof i?i=u.decorateType(i).name:i&&"object"==typeof i&&(i=u.decorateEnum(i).name),function(t,e){u.decorateType(t.constructor).add(new o(e,n,i,r,{default:a}))}},o._configure=function(t){i=t}},{"./enum":51,"./object":60,"./types":72,"./util":73}],53:[function(t,e,n){"use strict";var i=e.exports=t("./index-minimal");i.build="light",i.load=function(t,e,n){return(e="function"==typeof e?(n=e,new i.Root):e||new i.Root).load(t,n)},i.loadSync=function(t,e){return(e=e||new i.Root).loadSync(t)},i.encoder=t("./encoder"),i.decoder=t("./decoder"),i.verifier=t("./verifier"),i.converter=t("./converter"),i.ReflectionObject=t("./object"),i.Namespace=t("./namespace"),i.Root=t("./root"),i.Enum=t("./enum"),i.Type=t("./type"),i.Field=t("./field"),i.OneOf=t("./oneof"),i.MapField=t("./mapfield"),i.Service=t("./service"),i.Method=t("./method"),i.Message=t("./message"),i.wrappers=t("./wrappers"),i.types=t("./types"),i.util=t("./util"),i.ReflectionObject._configure(i.Root),i.Namespace._configure(i.Type,i.Service,i.Enum),i.Root._configure(i.Type),i.Field._configure(i.Type)},{"./converter":48,"./decoder":49,"./encoder":50,"./enum":51,"./field":52,"./index-minimal":54,"./mapfield":56,"./message":57,"./method":58,"./namespace":59,"./object":60,"./oneof":61,"./root":65,"./service":69,"./type":71,"./types":72,"./util":73,"./verifier":76,"./wrappers":77}],54:[function(t,e,n){"use strict";var i=n;function r(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=t("./writer"),i.BufferWriter=t("./writer_buffer"),i.Reader=t("./reader"),i.BufferReader=t("./reader_buffer"),i.util=t("./util/minimal"),i.rpc=t("./rpc"),i.roots=t("./roots"),i.configure=r,r()},{"./reader":63,"./reader_buffer":64,"./roots":66,"./rpc":67,"./util/minimal":75,"./writer":78,"./writer_buffer":79}],55:[function(t,e,n){"use strict";e=e.exports=t("./index-light");e.build="full",e.tokenize=t("./tokenize"),e.parse=t("./parse"),e.common=t("./common"),e.Root._configure(e.Type,e.parse,e.common)},{"./common":47,"./index-light":53,"./parse":62,"./tokenize":70}],56:[function(t,e,n){"use strict";e.exports=a;var o=t("./field");((a.prototype=Object.create(o.prototype)).constructor=a).className="MapField";var i=t("./types"),s=t("./util");function a(t,e,n,i,r,a){if(o.call(this,t,e,i,void 0,void 0,r,a),!s.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(t,e){return new a(t,e.id,e.keyType,e.type,e.options,e.comment)},a.prototype.toJSON=function(t){t=!!t&&Boolean(t.keepComments);return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===i.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return o.prototype.resolve.call(this)},a.d=function(n,i,r){return"function"==typeof r?r=s.decorateType(r).name:r&&"object"==typeof r&&(r=s.decorateEnum(r).name),function(t,e){s.decorateType(t.constructor).add(new a(e,n,i,r))}}},{"./field":52,"./types":72,"./util":73}],57:[function(t,e,n){"use strict";e.exports=r;var i=t("./util/minimal");function r(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)this[e[n]]=t[e[n]]}r.create=function(t){return this.$type.create(t)},r.encode=function(t,e){return this.$type.encode(t,e)},r.encodeDelimited=function(t,e){return this.$type.encodeDelimited(t,e)},r.decode=function(t){return this.$type.decode(t)},r.decodeDelimited=function(t){return this.$type.decodeDelimited(t)},r.verify=function(t){return this.$type.verify(t)},r.fromObject=function(t){return this.$type.fromObject(t)},r.toObject=function(t,e){return this.$type.toObject(t,e)},r.prototype.toJSON=function(){return this.$type.toObject(this,i.toJSONOptions)}},{"./util/minimal":75}],58:[function(t,e,n){"use strict";e.exports=i;var l=t("./object");((i.prototype=Object.create(l.prototype)).constructor=i).className="Method";var u=t("./util");function i(t,e,n,i,r,a,o,s){if(u.isObject(r)?(o=r,r=a=void 0):u.isObject(a)&&(o=a,a=void 0),void 0!==e&&!u.isString(e))throw TypeError("type must be a string");if(!u.isString(n))throw TypeError("requestType must be a string");if(!u.isString(i))throw TypeError("responseType must be a string");l.call(this,t,o),this.type=e||"rpc",this.requestType=n,this.requestStream=!!r||void 0,this.responseType=i,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=s}i.fromJSON=function(t,e){return new i(t,e.type,e.requestType,e.responseType,e.requestStream,e.responseStream,e.options,e.comment)},i.prototype.toJSON=function(t){t=!!t&&Boolean(t.keepComments);return u.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0])},i.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),l.prototype.resolve.call(this))}},{"./object":60,"./util":73}],59:[function(t,e,n){"use strict";e.exports=c;var i=t("./object");((c.prototype=Object.create(i.prototype)).constructor=c).className="Namespace";var r,a,o,s=t("./field"),l=t("./util");function u(t,e){if(t&&t.length){for(var n={},i=0;i<t.length;++i)n[t[i].name]=t[i].toJSON(e);return n}}function c(t,e){i.call(this,t,e),this.nested=void 0,this._nestedArray=null}function h(t){return t._nestedArray=null,t}c.fromJSON=function(t,e){return new c(t,e.options).addJSON(e.nested)},c.arrayToJSON=u,c.isReservedId=function(t,e){if(t)for(var n=0;n<t.length;++n)if("string"!=typeof t[n]&&t[n][0]<=e&&t[n][1]>e)return!0;return!1},c.isReservedName=function(t,e){if(t)for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1},Object.defineProperty(c.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),c.prototype.toJSON=function(t){return l.toObject(["options",this.options,"nested",u(this.nestedArray,t)])},c.prototype.addJSON=function(t){if(t)for(var e,n=Object.keys(t),i=0;i<n.length;++i)e=t[n[i]],this.add((void 0!==e.fields?r:void 0!==e.values?o:void 0!==e.methods?a:void 0!==e.id?s:c).fromJSON(n[i],e));return this},c.prototype.get=function(t){return this.nested&&this.nested[t]||null},c.prototype.getEnum=function(t){if(this.nested&&this.nested[t]instanceof o)return this.nested[t].values;throw Error("no such enum: "+t)},c.prototype.add=function(t){if(!(t instanceof s&&void 0!==t.extend||t instanceof r||t instanceof o||t instanceof a||t instanceof c))throw TypeError("object must be a valid nested object");if(this.nested){var e=this.get(t.name);if(e){if(!(e instanceof c&&t instanceof c)||e instanceof r||e instanceof a)throw Error("duplicate name '"+t.name+"' in "+this);for(var n=e.nestedArray,i=0;i<n.length;++i)t.add(n[i]);this.remove(e),this.nested||(this.nested={}),t.setOptions(e.options,!0)}}else this.nested={};return(this.nested[t.name]=t).onAdd(this),h(this)},c.prototype.remove=function(t){if(!(t instanceof i))throw TypeError("object must be a ReflectionObject");if(t.parent!==this)throw Error(t+" is not a member of "+this);return delete this.nested[t.name],Object.keys(this.nested).length||(this.nested=void 0),t.onRemove(this),h(this)},c.prototype.define=function(t,e){if(l.isString(t))t=t.split(".");else if(!Array.isArray(t))throw TypeError("illegal path");if(t&&t.length&&""===t[0])throw Error("path must be relative");for(var n=this;0<t.length;){var i=t.shift();if(n.nested&&n.nested[i]){if(!((n=n.nested[i])instanceof c))throw Error("path conflicts with non-namespace objects")}else n.add(n=new c(i))}return e&&n.addJSON(e),n},c.prototype.resolveAll=function(){for(var t=this.nestedArray,e=0;e<t.length;)t[e]instanceof c?t[e++].resolveAll():t[e++].resolve();return this.resolve()},c.prototype.lookup=function(t,e,n){if("boolean"==typeof e?(n=e,e=void 0):e&&!Array.isArray(e)&&(e=[e]),l.isString(t)&&t.length){if("."===t)return this.root;t=t.split(".")}else if(!t.length)return this;if(""===t[0])return this.root.lookup(t.slice(1),e);var i=this.get(t[0]);if(i){if(1===t.length){if(!e||-1<e.indexOf(i.constructor))return i}else if(i instanceof c&&(i=i.lookup(t.slice(1),e,!0)))return i}else for(var r=0;r<this.nestedArray.length;++r)if(this._nestedArray[r]instanceof c&&(i=this._nestedArray[r].lookup(t,e,!0)))return i;return null===this.parent||n?null:this.parent.lookup(t,e)},c.prototype.lookupType=function(t){var e=this.lookup(t,[r]);if(!e)throw Error("no such type: "+t);return e},c.prototype.lookupEnum=function(t){var e=this.lookup(t,[o]);if(!e)throw Error("no such Enum '"+t+"' in "+this);return e},c.prototype.lookupTypeOrEnum=function(t){var e=this.lookup(t,[r,o]);if(!e)throw Error("no such Type or Enum '"+t+"' in "+this);return e},c.prototype.lookupService=function(t){var e=this.lookup(t,[a]);if(!e)throw Error("no such Service '"+t+"' in "+this);return e},c._configure=function(t,e,n){r=t,a=e,o=n}},{"./field":52,"./object":60,"./util":73}],60:[function(t,e,n){"use strict";(e.exports=r).className="ReflectionObject";var i,o=t("./util");function r(t,e){if(!o.isString(t))throw TypeError("name must be a string");if(e&&!o.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(r.prototype,{root:{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}}),r.prototype.toJSON=function(){throw Error()},r.prototype.onAdd=function(t){this.parent&&this.parent!==t&&this.parent.remove(this),this.parent=t,this.resolved=!1;t=t.root;t instanceof i&&t._handleAdd(this)},r.prototype.onRemove=function(t){t=t.root;t instanceof i&&t._handleRemove(this),this.parent=null,this.resolved=!1},r.prototype.resolve=function(){return this.resolved||this.root instanceof i&&(this.resolved=!0),this},r.prototype.getOption=function(t){if(this.options)return this.options[t]},r.prototype.setOption=function(t,e,n){return n&&this.options&&void 0!==this.options[t]||((this.options||(this.options={}))[t]=e),this},r.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var i,r,a=this.parsedOptions;return n?(r=a.find(function(t){return Object.prototype.hasOwnProperty.call(t,e)}))?(i=r[e],o.setProperty(i,n,t)):((r={})[e]=o.setProperty({},n,t),a.push(r)):((r={})[e]=t,a.push(r)),this},r.prototype.setOptions=function(t,e){if(t)for(var n=Object.keys(t),i=0;i<n.length;++i)this.setOption(n[i],t[n[i]],e);return this},r.prototype.toString=function(){var t=this.constructor.className,e=this.fullName;return e.length?t+" "+e:t},r._configure=function(t){i=t}},{"./util":73}],61:[function(t,e,n){"use strict";e.exports=o;var r=t("./object");((o.prototype=Object.create(r.prototype)).constructor=o).className="OneOf";var i=t("./field"),a=t("./util");function o(t,e,n,i){if(Array.isArray(e)||(n=e,e=void 0),r.call(this,t,n),void 0!==e&&!Array.isArray(e))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=i}function s(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)t.fieldsArray[e].parent||t.parent.add(t.fieldsArray[e])}o.fromJSON=function(t,e){return new o(t,e.oneof,e.options,e.comment)},o.prototype.toJSON=function(t){t=!!t&&Boolean(t.keepComments);return a.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},o.prototype.add=function(t){if(!(t instanceof i))throw TypeError("field must be a Field");return t.parent&&t.parent!==this.parent&&t.parent.remove(t),this.oneof.push(t.name),this.fieldsArray.push(t),s(t.partOf=this),this},o.prototype.remove=function(t){if(!(t instanceof i))throw TypeError("field must be a Field");var e=this.fieldsArray.indexOf(t);if(e<0)throw Error(t+" is not a member of "+this);return this.fieldsArray.splice(e,1),-1<(e=this.oneof.indexOf(t.name))&&this.oneof.splice(e,1),t.partOf=null,this},o.prototype.onAdd=function(t){r.prototype.onAdd.call(this,t);for(var e=0;e<this.oneof.length;++e){var n=t.get(this.oneof[e]);n&&!n.partOf&&(n.partOf=this).fieldsArray.push(n)}s(this)},o.prototype.onRemove=function(t){for(var e,n=0;n<this.fieldsArray.length;++n)(e=this.fieldsArray[n]).parent&&e.parent.remove(e);r.prototype.onRemove.call(this,t)},o.d=function(){for(var n=new Array(arguments.length),t=0;t<arguments.length;)n[t]=arguments[t++];return function(t,e){a.decorateType(t.constructor).add(new o(e,n)),Object.defineProperty(t,e,{get:a.oneOfGetter(n),set:a.oneOfSetter(n)})}}},{"./field":52,"./object":60,"./util":73}],62:[function(t,e,n){"use strict";(e.exports=J).filename=null,J.defaults={keepCase:!1};var A=t("./tokenize"),B=t("./root"),P=t("./type"),E=t("./field"),O=t("./mapfield"),I=t("./oneof"),F=t("./enum"),j=t("./service"),N=t("./method"),R=t("./types"),W=t("./util"),H=/^[1-9][0-9]*$/,z=/^-?[1-9][0-9]*$/,q=/^0[x][0-9a-fA-F]+$/,G=/^-?0[x][0-9a-fA-F]+$/,U=/^0[0-7]+$/,$=/^-?0[0-7]+$/,K=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,Y=/^[a-zA-Z_][a-zA-Z_0-9]*$/,V=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,X=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function J(t,e,n){e instanceof B||(n=e,e=new B);var i,r,a,o,l,s=(n=n||J.defaults).preferTrailingComment||!1,u=A(t,n.alternateCommentMode||!1),c=u.next,h=u.push,f=u.peek,d=u.skip,p=u.cmnt,g=!0,m=!1,v=e,y=n.keepCase?function(t){return t}:W.camelCase;function b(t,e,n){var i=J.filename;return n||(J.filename=null),Error("illegal "+(e||"token")+" '"+t+"' ("+(i?i+", ":"")+"line "+u.line+")")}function _(){var t,e=[];do{if('"'!==(t=c())&&"'"!==t)throw b(t)}while(e.push(c()),d(t),'"'===(t=f())||"'"===t);return e.join("")}function x(e){var n=c();switch(n){case"'":case'"':return h(n),_();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(t,e){var n=1;"-"===t.charAt(0)&&(n=-1,t=t.substring(1));switch(t){case"inf":case"INF":case"Inf":return n*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(H.test(t))return n*parseInt(t,10);if(q.test(t))return n*parseInt(t,16);if(U.test(t))return n*parseInt(t,8);if(K.test(t))return n*parseFloat(t);throw b(t,"number",e)}(n,!0)}catch(t){if(e&&V.test(n))return n;throw b(n,"value")}}function w(t,e){for(var n;!e||'"'!==(n=f())&&"'"!==n?t.push([n=C(c()),d("to",!0)?C(c()):n]):t.push(_()),d(",",!0););d(";")}function C(t,e){switch(t){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!e&&"-"===t.charAt(0))throw b(t,"id");if(z.test(t))return parseInt(t,10);if(G.test(t))return parseInt(t,16);if($.test(t))return parseInt(t,8);throw b(t,"id")}function S(t,e){switch(e){case"option":return L(t,e),d(";"),1;case"message":return function(t,e){if(!Y.test(e=c()))throw b(e,"type name");var n=new P(e);M(n,function(t){if(!S(n,t))switch(t){case"map":!function(t){d("<");var e=c();if(void 0===R.mapKey[e])throw b(e,"type");d(",");var n=c();if(!V.test(n))throw b(n,"type");d(">");var i=c();if(!Y.test(i))throw b(i,"name");d("=");var r=new O(y(i),C(c()),e,n);M(r,function(t){if("option"!==t)throw b(t);L(r,t),d(";")},function(){D(r)}),t.add(r)}(n);break;case"required":case"optional":case"repeated":k(n,t);break;case"oneof":!function(t,e){if(!Y.test(e=c()))throw b(e,"name");var n=new I(y(e));M(n,function(t){"option"===t?(L(n,t),d(";")):(h(t),k(n,"optional"))}),t.add(n)}(n,t);break;case"extensions":w(n.extensions||(n.extensions=[]));break;case"reserved":w(n.reserved||(n.reserved=[]),!0);break;default:if(!m||!V.test(t))throw b(t);h(t),k(n,"optional")}}),t.add(n)}(t,e),1;case"enum":return function(t,e){if(!Y.test(e=c()))throw b(e,"name");var n=new F(e);M(n,function(t){switch(t){case"option":L(n,t),d(";");break;case"reserved":w(n.reserved||(n.reserved=[]),!0);break;default:!function(t,e){if(!Y.test(e))throw b(e,"name");d("=");var n=C(c(),!0),i={};M(i,function(t){if("option"!==t)throw b(t);L(i,t),d(";")},function(){D(i)}),t.add(e,n,i.comment)}(n,t)}}),t.add(n)}(t,e),1;case"service":return function(t,e){if(!Y.test(e=c()))throw b(e,"service name");var n=new j(e);M(n,function(t){if(!S(n,t)){if("rpc"!==t)throw b(t);!function(t,e){var n=p(),i=e;if(!Y.test(e=c()))throw b(e,"name");var r,a,o,s=e;d("("),d("stream",!0)&&(a=!0);if(!V.test(e=c()))throw b(e);r=e,d(")"),d("returns"),d("("),d("stream",!0)&&(o=!0);if(!V.test(e=c()))throw b(e);e=e,d(")");var l=new N(s,i,r,e,a,o);l.comment=n,M(l,function(t){if("option"!==t)throw b(t);L(l,t),d(";")}),t.add(l)}(n,t)}}),t.add(n)}(t,e),1;case"extend":return function(e,t){if(!V.test(t=c()))throw b(t,"reference");var n=t;M(null,function(t){switch(t){case"required":case"repeated":case"optional":k(e,t,n);break;default:if(!m||!V.test(t))throw b(t);h(t),k(e,"optional",n)}})}(t,e),1}}function M(t,e,n){var i,r=u.line;if(t&&("string"!=typeof t.comment&&(t.comment=p()),t.filename=J.filename),d("{",!0)){for(;"}"!==(i=c());)e(i);d(";",!0)}else n&&n(),d(";"),t&&("string"!=typeof t.comment||s)&&(t.comment=p(r)||t.comment)}function k(t,e,n){var i=c();if("group"!==i){if(!V.test(i))throw b(i,"type");var r=c();if(!Y.test(r))throw b(r,"name");r=y(r),d("=");var a=new E(r,C(c()),i,e,n);M(a,function(t){if("option"!==t)throw b(t);L(a,t),d(";")},function(){D(a)}),t.add(a),m||!a.repeated||void 0===R.packed[i]&&void 0!==R.basic[i]||a.setOption("packed",!1,!0)}else!function(t,e){var n=c();if(!Y.test(n))throw b(n,"name");var i=W.lcFirst(n);n===i&&(n=W.ucFirst(n));d("=");var r=C(c()),a=new P(n);a.group=!0;e=new E(i,r,n,e);e.filename=J.filename,M(a,function(t){switch(t){case"option":L(a,t),d(";");break;case"required":case"optional":case"repeated":k(a,t);break;default:throw b(t)}}),t.add(a).add(e)}(t,e)}function L(t,e){var n=d("(",!0);if(!V.test(e=c()))throw b(e,"name");var i=e,r=i;n&&(d(")"),r=i="("+i+")",e=f(),X.test(e)&&(a=e.substr(1),i+=e,c())),d("=");var a,i=function t(e,n){if(d("{",!0)){for(var i={};!d("}",!0);){if(!Y.test(l=c()))throw b(l,"name");var r,a=l;"{"===f()?r=t(e,n+"."+l):(d(":"),"{"===f()?r=t(e,n+"."+l):(r=x(!0),T(e,n+"."+l,r)));var o=i[a];o&&(r=[].concat(o).concat(r)),i[a]=r,d(",",!0)}return i}var s=x(!0);T(e,n,s);return s}(t,i);r=r,i=i,a=a,(t=t).setParsedOption&&t.setParsedOption(r,i,a)}function T(t,e,n){t.setOption&&t.setOption(e,n)}function D(t){if(d("[",!0)){for(;L(t,"option"),d(",",!0););d("]")}return t}for(;null!==(l=c());)switch(l){case"package":if(!g)throw b(l);!function(){if(void 0!==i)throw b("package");if(i=c(),!V.test(i))throw b(i,"name");v=v.define(i),d(";")}();break;case"import":if(!g)throw b(l);!function(){var t,e=f();switch(e){case"weak":t=a=a||[],c();break;case"public":c();default:t=r=r||[]}e=_(),d(";"),t.push(e)}();break;case"syntax":if(!g)throw b(l);!function(){if(d("="),o=_(),!(m="proto3"===o)&&"proto2"!==o)throw b(o,"syntax");d(";")}();break;case"option":L(v,l),d(";");break;default:if(S(v,l)){g=!1;continue}throw b(l)}return J.filename=null,{package:i,imports:r,weakImports:a,syntax:o,root:e}}},{"./enum":51,"./field":52,"./mapfield":56,"./method":58,"./oneof":61,"./root":65,"./service":69,"./tokenize":70,"./type":71,"./types":72,"./util":73}],63:[function(t,e,n){"use strict";e.exports=l;var i,r=t("./util/minimal"),a=r.LongBits,o=r.utf8;function s(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function l(t){this.buf=t,this.pos=0,this.len=t.length}function u(){return r.Buffer?function(t){return(l.create=function(t){return r.Buffer.isBuffer(t)?new i(t):h(t)})(t)}:h}var c,h="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new l(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new l(t);throw Error("illegal buffer")};function f(){var t=new a(0,0),e=0;if(!(4<this.len-this.pos)){for(;e<3;++e){if(this.pos>=this.len)throw s(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,4<this.len-this.pos){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw s(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function d(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw s(this,8);return new a(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}l.create=u(),l.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,l.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return c}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return d(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|d(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var t=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var t=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},l.prototype.bytes=function(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw s(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,n):e===n?new this.buf.constructor(0):this._slice.call(this.buf,e,n)},l.prototype.string=function(){var t=this.bytes();return o.read(t,0,t.length)},l.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw s(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},l._configure=function(t){i=t,l.create=u(),i._configure();var e=r.Long?"toLong":"toNumber";r.merge(l.prototype,{int64:function(){return f.call(this)[e](!1)},uint64:function(){return f.call(this)[e](!0)},sint64:function(){return f.call(this).zzDecode()[e](!1)},fixed64:function(){return p.call(this)[e](!0)},sfixed64:function(){return p.call(this)[e](!1)}})}},{"./util/minimal":75}],64:[function(t,e,n){"use strict";e.exports=a;var i=t("./reader");(a.prototype=Object.create(i.prototype)).constructor=a;var r=t("./util/minimal");function a(t){i.call(this,t)}a._configure=function(){r.Buffer&&(a.prototype._slice=r.Buffer.prototype.slice)},a.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},a._configure()},{"./reader":63,"./util/minimal":75}],65:[function(t,e,n){"use strict";e.exports=l;var i=t("./namespace");((l.prototype=Object.create(i.prototype)).constructor=l).className="Root";var r,d,p,a=t("./field"),o=t("./enum"),s=t("./oneof"),g=t("./util");function l(t){i.call(this,"",t),this.deferred=[],this.files=[]}function m(){}l.fromJSON=function(t,e){return e=e||new l,t.options&&e.setOptions(t.options),e.addJSON(t.nested)},l.prototype.resolvePath=g.path.resolve,l.prototype.fetch=g.fetch,l.prototype.load=function t(e,a,r){"function"==typeof a&&(r=a,a=void 0);var o=this;if(!r)return g.asPromise(t,o,e,a);var s=r===m;function l(t,e){if(r){var n=r;if(r=null,s)throw t;n(t,e)}}function u(t){var e=t.lastIndexOf("google/protobuf/");if(-1<e){e=t.substring(e);if(e in p)return e}return null}function c(t,e){try{if(g.isString(e)&&"{"===e.charAt(0)&&(e=JSON.parse(e)),g.isString(e)){d.filename=t;var n,i=d(e,o,a),r=0;if(i.imports)for(;r<i.imports.length;++r)(n=u(i.imports[r])||o.resolvePath(t,i.imports[r]))&&h(n);if(i.weakImports)for(r=0;r<i.weakImports.length;++r)(n=u(i.weakImports[r])||o.resolvePath(t,i.weakImports[r]))&&h(n,!0)}else o.setOptions(e.options).addJSON(e.nested)}catch(t){l(t)}s||f||l(null,o)}function h(n,i){if(!(-1<o.files.indexOf(n)))if(o.files.push(n),n in p)s?c(n,p[n]):(++f,setTimeout(function(){--f,c(n,p[n])}));else if(s){var t;try{t=g.fs.readFileSync(n).toString("utf8")}catch(t){return void(i||l(t))}c(n,t)}else++f,o.fetch(n,function(t,e){--f,r&&(t?i?f||l(null,o):l(t):c(n,e))})}var f=0;g.isString(e)&&(e=[e]);for(var n,i=0;i<e.length;++i)(n=o.resolvePath("",e[i]))&&h(n);if(s)return o;f||l(null,o)},l.prototype.loadSync=function(t,e){if(!g.isNode)throw Error("not supported");return this.load(t,e,m)},l.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(t){return"'extend "+t.extend+"' in "+t.parent.fullName}).join(", "));return i.prototype.resolveAll.call(this)};var u=/^[A-Z]/;function c(t,e){var n=e.parent.lookup(e.extend);if(n){var i=new a(e.fullName,e.id,e.type,e.rule,void 0,e.options);return(i.declaringField=e).extensionField=i,n.add(i),1}}l.prototype._handleAdd=function(t){if(t instanceof a)void 0===t.extend||t.extensionField||c(0,t)||this.deferred.push(t);else if(t instanceof o)u.test(t.name)&&(t.parent[t.name]=t.values);else if(!(t instanceof s)){if(t instanceof r)for(var e=0;e<this.deferred.length;)c(0,this.deferred[e])?this.deferred.splice(e,1):++e;for(var n=0;n<t.nestedArray.length;++n)this._handleAdd(t._nestedArray[n]);u.test(t.name)&&(t.parent[t.name]=t)}},l.prototype._handleRemove=function(t){var e;if(t instanceof a)void 0!==t.extend&&(t.extensionField?(t.extensionField.parent.remove(t.extensionField),t.extensionField=null):-1<(e=this.deferred.indexOf(t))&&this.deferred.splice(e,1));else if(t instanceof o)u.test(t.name)&&delete t.parent[t.name];else if(t instanceof i){for(var n=0;n<t.nestedArray.length;++n)this._handleRemove(t._nestedArray[n]);u.test(t.name)&&delete t.parent[t.name]}},l._configure=function(t,e,n){r=t,d=e,p=n}},{"./enum":51,"./field":52,"./namespace":59,"./oneof":61,"./util":73}],66:[function(t,e,n){"use strict";e.exports={}},{}],67:[function(t,e,n){"use strict";n.Service=t("./rpc/service")},{"./rpc/service":68}],68:[function(t,e,n){"use strict";e.exports=i;var s=t("../util/minimal");function i(t,e,n){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");s.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(n)}((i.prototype=Object.create(s.EventEmitter.prototype)).constructor=i).prototype.rpcCall=function t(n,e,i,r,a){if(!r)throw TypeError("request must be specified");var o=this;if(!a)return s.asPromise(t,o,n,e,i,r);if(o.rpcImpl)try{return o.rpcImpl(n,e[o.requestDelimited?"encodeDelimited":"encode"](r).finish(),function(t,e){if(t)return o.emit("error",t,n),a(t);if(null!==e){if(!(e instanceof i))try{e=i[o.responseDelimited?"decodeDelimited":"decode"](e)}catch(t){return o.emit("error",t,n),a(t)}return o.emit("data",e,n),a(null,e)}o.end(!0)})}catch(t){return o.emit("error",t,n),void setTimeout(function(){a(t)},0)}else setTimeout(function(){a(Error("already ended"))},0)},i.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{"../util/minimal":75}],69:[function(t,e,n){"use strict";e.exports=o;var i=t("./namespace");((o.prototype=Object.create(i.prototype)).constructor=o).className="Service";var a=t("./method"),s=t("./util"),l=t("./rpc");function o(t,e){i.call(this,t,e),this.methods={},this._methodsArray=null}function r(t){return t._methodsArray=null,t}o.fromJSON=function(t,e){var n=new o(t,e.options);if(e.methods)for(var i=Object.keys(e.methods),r=0;r<i.length;++r)n.add(a.fromJSON(i[r],e.methods[i[r]]));return e.nested&&n.addJSON(e.nested),n.comment=e.comment,n},o.prototype.toJSON=function(t){var e=i.prototype.toJSON.call(this,t),n=!!t&&Boolean(t.keepComments);return s.toObject(["options",e&&e.options||void 0,"methods",i.arrayToJSON(this.methodsArray,t)||{},"nested",e&&e.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(o.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}}),o.prototype.get=function(t){return this.methods[t]||i.prototype.get.call(this,t)},o.prototype.resolveAll=function(){for(var t=this.methodsArray,e=0;e<t.length;++e)t[e].resolve();return i.prototype.resolve.call(this)},o.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);return t instanceof a?r((this.methods[t.name]=t).parent=this):i.prototype.add.call(this,t)},o.prototype.remove=function(t){if(t instanceof a){if(this.methods[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.methods[t.name],t.parent=null,r(this)}return i.prototype.remove.call(this,t)},o.prototype.create=function(t,e,n){for(var i,r=new l.Service(t,e,n),a=0;a<this.methodsArray.length;++a){var o=s.lcFirst((i=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");r[o]=s.codegen(["r","c"],s.isReserved(o)?o+"_":o)("return this.rpcCall(m,q,s,r,c)")({m:i,q:i.resolvedRequestType.ctor,s:i.resolvedResponseType.ctor})}return r}},{"./method":58,"./namespace":59,"./rpc":67,"./util":73}],70:[function(t,e,n){"use strict";e.exports=a;var M=/[\s{}=;:[\],'"()<>]/g,k=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,L=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,T=/^ *[*/]+ */,D=/^\s*\*?\/*/,A=/\n/g,B=/\s/,i=/\\(.?)/g,r={0:"\0",r:"\r",n:"\n",t:"\t"};function P(t){return t.replace(i,function(t,e){switch(e){case"\\":case"":return e;default:return r[e]||""}})}function a(l,u){l=l.toString();var c=0,h=l.length,f=1,s=null,d=null,p=0,g=!1,m=!1,v=[],y=null;function b(t){return Error("illegal "+t+" (line "+f+")")}function _(t){return l.charAt(t)}function x(t,e,n){s=l.charAt(t++),p=f,g=!1,m=n;var i,r=t-(u?2:3);do{if(--r<0||"\n"===(i=l.charAt(r))){g=!0;break}}while(" "===i||"\t"===i);for(var a=l.substring(t,e).split(A),o=0;o<a.length;++o)a[o]=a[o].replace(u?D:T,"").trim();d=a.join("\n").trim()}function w(t){var e=C(t),e=l.substring(t,e);return/^\s*\/{1,2}/.test(e)}function C(t){for(var e=t;e<h&&"\n"!==_(e);)e++;return e}function i(){if(0<v.length)return v.shift();if(y)return function(){var t="'"===y?L:k;t.lastIndex=c-1;var e=t.exec(l);if(!e)throw b("string");return c=t.lastIndex,S(y),y=null,P(e[1])}();var t,e,n,i,r,a=0===c;do{if(c===h)return null;for(t=!1;B.test(n=_(c));)if("\n"===n&&(a=!0,++f),++c===h)return null;if("/"===_(c)){if(++c===h)throw b("comment");if("/"===_(c))if(u){if(r=!1,w(i=c))for(r=!0;(c=C(c))!==h&&w(++c););else c=Math.min(h,C(c)+1);r&&x(i,c,a),f++,t=!0}else{for(r="/"===_(i=c+1);"\n"!==_(++c);)if(c===h)return null;++c,r&&x(i,c-1,a),++f,t=!0}else{if("*"!==(n=_(c)))return"/";i=c+1,r=u||"*"===_(i);do{if("\n"===n&&++f,++c===h)throw b("comment")}while(e=n,n=_(c),"*"!==e||"/"!==n);++c,r&&x(i,c-2,a),t=!0}}}while(t);var o=c;if(M.lastIndex=0,!M.test(_(o++)))for(;o<h&&!M.test(_(o));)++o;var s=l.substring(c,c=o);return'"'!==s&&"'"!==s||(y=s),s}function S(t){v.push(t)}function r(){if(!v.length){var t=i();if(null===t)return null;S(t)}return v[0]}return Object.defineProperty({next:i,peek:r,push:S,skip:function(t,e){var n=r();if(n===t)return i(),!0;if(!e)throw b("token '"+n+"', '"+t+"' expected");return!1},cmnt:function(t){var e=null;return void 0===t?p===f-1&&(u||"*"===s||g)&&(e=m?d:null):(p<t&&r(),p!==t||g||!u&&"/"!==s||(e=m?null:d)),e}},"line",{get:function(){return f}})}a.unescape=P},{}],71:[function(t,e,n){"use strict";e.exports=b;var o=t("./namespace");((b.prototype=Object.create(o.prototype)).constructor=b).className="Type";var s=t("./enum"),l=t("./oneof"),u=t("./field"),c=t("./mapfield"),h=t("./service"),r=t("./message"),a=t("./reader"),f=t("./writer"),d=t("./util"),p=t("./encoder"),g=t("./decoder"),m=t("./verifier"),v=t("./converter"),y=t("./wrappers");function b(t,e){o.call(this,t,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function i(t){return t._fieldsById=t._fieldsArray=t._oneofsArray=null,delete t.encode,delete t.decode,delete t.verify,t}Object.defineProperties(b.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var n=this.fields[t[e]],i=n.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=d.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=d.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=b.generateConstructor(this)())},set:function(t){var e=t.prototype;e instanceof r||((t.prototype=new r).constructor=t,d.merge(t.prototype,e)),t.$type=t.prototype.$type=this,d.merge(t,r,!0),this._ctor=t;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();for(var i={},n=0;n<this.oneofsArray.length;++n)i[this._oneofsArray[n].resolve().name]={get:d.oneOfGetter(this._oneofsArray[n].oneof),set:d.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(t.prototype,i)}}}),b.generateConstructor=function(t){for(var e,n=d.codegen(["p"],t.name),i=0;i<t.fieldsArray.length;++i)(e=t._fieldsArray[i]).map?n("this%s={}",d.safeProp(e.name)):e.repeated&&n("this%s=[]",d.safeProp(e.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},b.fromJSON=function(t,e){var n=new b(t,e.options);n.extensions=e.extensions,n.reserved=e.reserved;for(var i=Object.keys(e.fields),r=0;r<i.length;++r)n.add((void 0!==e.fields[i[r]].keyType?c:u).fromJSON(i[r],e.fields[i[r]]));if(e.oneofs)for(i=Object.keys(e.oneofs),r=0;r<i.length;++r)n.add(l.fromJSON(i[r],e.oneofs[i[r]]));if(e.nested)for(i=Object.keys(e.nested),r=0;r<i.length;++r){var a=e.nested[i[r]];n.add((void 0!==a.id?u:void 0!==a.fields?b:void 0!==a.values?s:void 0!==a.methods?h:o).fromJSON(i[r],a))}return e.extensions&&e.extensions.length&&(n.extensions=e.extensions),e.reserved&&e.reserved.length&&(n.reserved=e.reserved),e.group&&(n.group=!0),e.comment&&(n.comment=e.comment),n},b.prototype.toJSON=function(t){var e=o.prototype.toJSON.call(this,t),n=!!t&&Boolean(t.keepComments);return d.toObject(["options",e&&e.options||void 0,"oneofs",o.arrayToJSON(this.oneofsArray,t),"fields",o.arrayToJSON(this.fieldsArray.filter(function(t){return!t.declaringField}),t)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",e&&e.nested||void 0,"comment",n?this.comment:void 0])},b.prototype.resolveAll=function(){for(var t=this.fieldsArray,e=0;e<t.length;)t[e++].resolve();for(var n=this.oneofsArray,e=0;e<n.length;)n[e++].resolve();return o.prototype.resolveAll.call(this)},b.prototype.get=function(t){return this.fields[t]||this.oneofs&&this.oneofs[t]||this.nested&&this.nested[t]||null},b.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);if(t instanceof u&&void 0===t.extend){if((this._fieldsById||this.fieldsById)[t.id])throw Error("duplicate id "+t.id+" in "+this);if(this.isReservedId(t.id))throw Error("id "+t.id+" is reserved in "+this);if(this.isReservedName(t.name))throw Error("name '"+t.name+"' is reserved in "+this);return t.parent&&t.parent.remove(t),(this.fields[t.name]=t).message=this,t.onAdd(this),i(this)}return t instanceof l?(this.oneofs||(this.oneofs={}),(this.oneofs[t.name]=t).onAdd(this),i(this)):o.prototype.add.call(this,t)},b.prototype.remove=function(t){if(t instanceof u&&void 0===t.extend){if(!this.fields||this.fields[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.fields[t.name],t.parent=null,t.onRemove(this),i(this)}if(t instanceof l){if(!this.oneofs||this.oneofs[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.oneofs[t.name],t.parent=null,t.onRemove(this),i(this)}return o.prototype.remove.call(this,t)},b.prototype.isReservedId=function(t){return o.isReservedId(this.reserved,t)},b.prototype.isReservedName=function(t){return o.isReservedName(this.reserved,t)},b.prototype.create=function(t){return new this.ctor(t)},b.prototype.setup=function(){for(var t=this.fullName,e=[],n=0;n<this.fieldsArray.length;++n)e.push(this._fieldsArray[n].resolve().resolvedType);this.encode=p(this)({Writer:f,types:e,util:d}),this.decode=g(this)({Reader:a,types:e,util:d}),this.verify=m(this)({types:e,util:d}),this.fromObject=v.fromObject(this)({types:e,util:d}),this.toObject=v.toObject(this)({types:e,util:d});var i=y[t];return i&&((t=Object.create(this)).fromObject=this.fromObject,this.fromObject=i.fromObject.bind(t),t.toObject=this.toObject,this.toObject=i.toObject.bind(t)),this},b.prototype.encode=function(t,e){return this.setup().encode(t,e)},b.prototype.encodeDelimited=function(t,e){return this.encode(t,e&&e.len?e.fork():e).ldelim()},b.prototype.decode=function(t,e){return this.setup().decode(t,e)},b.prototype.decodeDelimited=function(t){return t instanceof a||(t=a.create(t)),this.decode(t,t.uint32())},b.prototype.verify=function(t){return this.setup().verify(t)},b.prototype.fromObject=function(t){return this.setup().fromObject(t)},b.prototype.toObject=function(t,e){return this.setup().toObject(t,e)},b.d=function(e){return function(t){d.decorateType(t,e)}}},{"./converter":48,"./decoder":49,"./encoder":50,"./enum":51,"./field":52,"./mapfield":56,"./message":57,"./namespace":59,"./oneof":61,"./reader":63,"./service":69,"./util":73,"./verifier":76,"./wrappers":77,"./writer":78}],72:[function(t,e,n){"use strict";var n=n,t=t("./util"),r=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function i(t,e){var n=0,i={};for(e|=0;n<t.length;)i[r[n+e]]=t[n++];return i}n.basic=i([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),n.defaults=i([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",t.emptyArray,null]),n.long=i([0,0,0,1,1],7),n.mapKey=i([0,0,0,5,5,0,0,0,1,1,0,2],2),n.packed=i([1,5,0,0,0,5,5,0,0,0,1,1,0])},{"./util":73}],73:[function(n,t,e){"use strict";var i,r,a=t.exports=n("./util/minimal"),o=n("./roots");a.codegen=n("@protobufjs/codegen"),a.fetch=n("@protobufjs/fetch"),a.path=n("@protobufjs/path"),a.fs=a.inquire("fs"),a.toArray=function(t){if(t){for(var e=Object.keys(t),n=new Array(e.length),i=0;i<e.length;)n[i]=t[e[i++]];return n}return[]},a.toObject=function(t){for(var e={},n=0;n<t.length;){var i=t[n++],r=t[n++];void 0!==r&&(e[i]=r)}return e};var s=/\\/g,l=/"/g;a.isReserved=function(t){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(t)},a.safeProp=function(t){return!/^[$\w_]+$/.test(t)||a.isReserved(t)?'["'+t.replace(s,"\\\\").replace(l,'\\"')+'"]':"."+t},a.ucFirst=function(t){return t.charAt(0).toUpperCase()+t.substring(1)};var u=/_([a-z])/g;a.camelCase=function(t){return t.substring(0,1)+t.substring(1).replace(u,function(t,e){return e.toUpperCase()})},a.compareFieldsById=function(t,e){return t.id-e.id},a.decorateType=function(t,e){if(t.$type)return e&&t.$type.name!==e&&(a.decorateRoot.remove(t.$type),t.$type.name=e,a.decorateRoot.add(t.$type)),t.$type;e=new(i=i||n("./type"))(e||t.name);return a.decorateRoot.add(e),e.ctor=t,Object.defineProperty(t,"$type",{value:e,enumerable:!1}),Object.defineProperty(t.prototype,"$type",{value:e,enumerable:!1}),e};var c=0;a.decorateEnum=function(t){if(t.$type)return t.$type;var e=new(r=r||n("./enum"))("Enum"+c++,t);return a.decorateRoot.add(e),Object.defineProperty(t,"$type",{value:e,enumerable:!1}),e},a.setProperty=function(t,e,n){if("object"!=typeof t)throw TypeError("dst must be an object");if(!e)throw TypeError("path must be specified");return function t(e,n,i){var r=n.shift();return 0<n.length?e[r]=t(e[r]||{},n,i):((n=e[r])&&(i=[].concat(n).concat(i)),e[r]=i),e}(t,e=e.split("."),n)},Object.defineProperty(a,"decorateRoot",{get:function(){return o.decorated||(o.decorated=new(n("./root")))}})},{"./enum":51,"./root":65,"./roots":66,"./type":71,"./util/minimal":75,"@protobufjs/codegen":3,"@protobufjs/fetch":5,"@protobufjs/path":8}],74:[function(t,e,n){"use strict";e.exports=r;var i=t("../util/minimal");function r(t,e){this.lo=t>>>0,this.hi=e>>>0}var a=r.zero=new r(0,0);a.toNumber=function(){return 0},a.zzEncode=a.zzDecode=function(){return this},a.length=function(){return 1};r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(t){if(0===t)return a;var e=t<0,n=(t=e?-t:t)>>>0,t=(t-n)/4294967296>>>0;return e&&(t=~t>>>0,n=~n>>>0,4294967295<++n&&(n=0,4294967295<++t&&(t=0))),new r(n,t)},r.from=function(t){if("number"==typeof t)return r.fromNumber(t);if(i.isString(t)){if(!i.Long)return r.fromNumber(parseInt(t,10));t=i.Long.fromString(t)}return t.low||t.high?new r(t.low>>>0,t.high>>>0):a},r.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,t=~this.hi>>>0;return-(e+4294967296*(t=!e?t+1>>>0:t))}return this.lo+4294967296*this.hi},r.prototype.toLong=function(t){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var o=String.prototype.charCodeAt;r.fromHash=function(t){return"\0\0\0\0\0\0\0\0"===t?a:new r((o.call(t,0)|o.call(t,1)<<8|o.call(t,2)<<16|o.call(t,3)<<24)>>>0,(o.call(t,4)|o.call(t,5)<<8|o.call(t,6)<<16|o.call(t,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},r.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},r.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0==n?0==e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}},{"../util/minimal":75}],75:[function(n,t,a){!function(t){"use strict";var i=a;function r(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;++r)void 0!==t[i[r]]&&n||(t[i[r]]=e[i[r]]);return t}function e(t){function n(t,e){if(!(this instanceof n))return new n(t,e);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,n):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),e&&r(this,e)}return(n.prototype=Object.create(Error.prototype)).constructor=n,Object.defineProperty(n.prototype,"name",{get:function(){return t}}),n.prototype.toString=function(){return this.name+": "+this.message},n}i.asPromise=n("@protobufjs/aspromise"),i.base64=n("@protobufjs/base64"),i.EventEmitter=n("@protobufjs/eventemitter"),i.float=n("@protobufjs/float"),i.inquire=n("@protobufjs/inquire"),i.utf8=n("@protobufjs/utf8"),i.pool=n("@protobufjs/pool"),i.LongBits=n("./longbits"),i.isNode=Boolean(void 0!==t&&t&&t.process&&t.process.versions&&t.process.versions.node),i.global=i.isNode&&t||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},i.isString=function(t){return"string"==typeof t||t instanceof String},i.isObject=function(t){return t&&"object"==typeof t},i.isset=i.isSet=function(t,e){var n=t[e];return!(null==n||!t.hasOwnProperty(e))&&("object"!=typeof n||0<(Array.isArray(n)?n:Object.keys(n)).length)},i.Buffer=function(){try{var t=i.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(t){return"number"==typeof t?i.Buffer?i._Buffer_allocUnsafe(t):new i.Array(t):i.Buffer?i._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(t){return t?i.LongBits.from(t).toHash():i.LongBits.zeroHash},i.longFromHash=function(t,e){t=i.LongBits.fromHash(t);return i.Long?i.Long.fromBits(t.lo,t.hi,e):t.toNumber(Boolean(e))},i.merge=r,i.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},i.newError=e,i.ProtocolError=e("ProtocolError"),i.oneOfGetter=function(t){for(var n={},e=0;e<t.length;++e)n[t[e]]=1;return function(){for(var t=Object.keys(this),e=t.length-1;-1<e;--e)if(1===n[t[e]]&&void 0!==this[t[e]]&&null!==this[t[e]])return t[e]}},i.oneOfSetter=function(n){return function(t){for(var e=0;e<n.length;++e)n[e]!==t&&delete this[n[e]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var n=i.Buffer;n?(i._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,e){return new n(t,e)},i._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./longbits":74,"@protobufjs/aspromise":1,"@protobufjs/base64":2,"@protobufjs/eventemitter":4,"@protobufjs/float":6,"@protobufjs/inquire":7,"@protobufjs/pool":9,"@protobufjs/utf8":10}],76:[function(t,e,n){"use strict";e.exports=function(t){var e=l.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n=t.oneofsArray,i={};n.length&&e("var p={}");for(var r=0;r<t.fieldsArray.length;++r){var a,o=t._fieldsArray[r].resolve(),s="m"+l.safeProp(o.name);o.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",s,o.name),o.map?(e("if(!util.isObject(%s))",s)("return%j",u(o,"object"))("var k=Object.keys(%s)",s)("for(var i=0;i<k.length;++i){"),function(t,e,n){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",n)("return%j",u(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",n)("return%j",u(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",n)("return%j",u(e,"boolean key"))}}(e,o,"k[i]"),c(e,o,r,s+"[k[i]]")("}")):o.repeated?(e("if(!Array.isArray(%s))",s)("return%j",u(o,"array"))("for(var i=0;i<%s.length;++i){",s),c(e,o,r,s+"[i]")("}")):(o.partOf&&(a=l.safeProp(o.partOf.name),1===i[o.partOf.name]&&e("if(p%s===1)",a)("return%j",o.partOf.name+": multiple values"),i[o.partOf.name]=1,e("p%s=1",a)),c(e,o,r,s)),o.optional&&e("}")}return e("return null")};var o=t("./enum"),l=t("./util");function u(t,e){return t.name+": "+e+(t.repeated&&"array"!==e?"[]":t.map&&"object"!==e?"{k:"+t.keyType+"}":"")+" expected"}function c(t,e,n,i){if(e.resolvedType)if(e.resolvedType instanceof o){t("switch(%s){",i)("default:")("return%j",u(e,"enum value"));for(var r=Object.keys(e.resolvedType.values),a=0;a<r.length;++a)t("case %i:",e.resolvedType.values[r[a]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",n,i)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",i)("return%j",u(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",u(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',i)("return%j",u(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',i)("return%j",u(e,"boolean"));break;case"string":t("if(!util.isString(%s))",i)("return%j",u(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",u(e,"buffer"))}return t}},{"./enum":51,"./util":73}],77:[function(t,e,n){"use strict";var n=n,a=t("./message");n[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e=t["@type"].substring(t["@type"].lastIndexOf("/")+1),n=this.lookup(e);if(n){e="."===t["@type"].charAt(0)?t["@type"].substr(1):t["@type"];return-1===e.indexOf("/")&&(e="/"+e),this.create({type_url:e,value:n.encode(n.fromObject(t)).finish()})}}return this.fromObject(t)},toObject:function(t,e){var n,i="",r="";if(e&&e.json&&t.type_url&&t.value&&(r=t.type_url.substring(t.type_url.lastIndexOf("/")+1),i=t.type_url.substring(0,t.type_url.lastIndexOf("/")+1),(n=this.lookup(r))&&(t=n.decode(t.value))),t instanceof this.ctor||!(t instanceof a))return this.toObject(t,e);e=t.$type.toObject(t,e),t="."===t.$type.fullName[0]?t.$type.fullName.substr(1):t.$type.fullName;return e["@type"]=r=(i=""===i?"type.googleapis.com/":i)+t,e}}},{"./message":57}],78:[function(t,e,n){"use strict";e.exports=h;var i,r=t("./util/minimal"),a=r.LongBits,o=r.base64,s=r.utf8;function l(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}function u(){}function c(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function h(){this.len=0,this.head=new l(u,0,0),this.tail=this.head,this.states=null}function f(){return r.Buffer?function(){return(h.create=function(){return new i})()}:function(){return new h}}function d(t,e,n){e[n]=255&t}function p(t,e){this.len=t,this.next=void 0,this.val=e}function g(t,e,n){for(;t.hi;)e[n++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;127<t.lo;)e[n++]=127&t.lo|128,t.lo=t.lo>>>7;e[n++]=t.lo}function m(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}h.create=f(),h.alloc=function(t){return new r.Array(t)},r.Array!==Array&&(h.alloc=r.pool(h.alloc,r.Array.prototype.subarray)),h.prototype._push=function(t,e,n){return this.tail=this.tail.next=new l(t,e,n),this.len+=e,this},(p.prototype=Object.create(l.prototype)).fn=function(t,e,n){for(;127<t;)e[n++]=127&t|128,t>>>=7;e[n]=t},h.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new p((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},h.prototype.int32=function(t){return t<0?this._push(g,10,a.fromNumber(t)):this.uint32(t)},h.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},h.prototype.int64=h.prototype.uint64=function(t){t=a.from(t);return this._push(g,t.length(),t)},h.prototype.sint64=function(t){t=a.from(t).zzEncode();return this._push(g,t.length(),t)},h.prototype.bool=function(t){return this._push(d,1,t?1:0)},h.prototype.sfixed32=h.prototype.fixed32=function(t){return this._push(m,4,t>>>0)},h.prototype.sfixed64=h.prototype.fixed64=function(t){t=a.from(t);return this._push(m,4,t.lo)._push(m,4,t.hi)},h.prototype.float=function(t){return this._push(r.float.writeFloatLE,4,t)},h.prototype.double=function(t){return this._push(r.float.writeDoubleLE,8,t)};var v=r.Array.prototype.set?function(t,e,n){e.set(t,n)}:function(t,e,n){for(var i=0;i<t.length;++i)e[n+i]=t[i]};h.prototype.bytes=function(t){var e,n=t.length>>>0;return n?(r.isString(t)&&(e=h.alloc(n=o.length(t)),o.decode(t,e,0),t=e),this.uint32(n)._push(v,n,t)):this._push(d,1,0)},h.prototype.string=function(t){var e=s.length(t);return e?this.uint32(e)._push(s.write,e,t):this._push(d,1,0)},h.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new l(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this},h.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e},h._configure=function(t){i=t,h.create=f(),i._configure()}},{"./util/minimal":75}],79:[function(t,e,n){"use strict";e.exports=a;var i=t("./writer");(a.prototype=Object.create(i.prototype)).constructor=a;var r=t("./util/minimal");function a(){i.call(this)}function o(t,e,n){t.length<40?r.utf8.write(t,e,n):e.utf8Write?e.utf8Write(t,n):e.write(t,n)}a._configure=function(){a.alloc=r._Buffer_allocUnsafe,a.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var i=0;i<t.length;)e[n++]=t[i++]}},a.prototype.bytes=function(t){var e=(t=r.isString(t)?r._Buffer_from(t,"base64"):t).length>>>0;return this.uint32(e),e&&this._push(a.writeBytesBuffer,e,t),this},a.prototype.string=function(t){var e=r.Buffer.byteLength(t);return this.uint32(e),e&&this._push(o,e,t),this},a._configure()},{"./util/minimal":75,"./writer":78}],80:[function(t,e,n){t=t("./src/quickSelect");e.exports=t},{"./src/quickSelect":81}],81:[function(t,e,n){e.exports=(e,t,n=t=>t)=>{if(((t,e,n)=>{if(!Array.isArray(t))throw new Error("The first argument should be a javascript array!");if("number"!=typeof e)throw new Error("The second argument should be a javascript number!");if("function"!=typeof n)throw new Error("The third argument should be a javascript function!");if(t.length<e)throw new Error("K should not be greater than array length!")})(e,t,n),1===e.length&&0===t)return e[0];for(;;){var i=n(e[r=0,a=e.length-1,Math.floor(Math.random()*a)+r]);const o=[],s=[],l=[];for(let t=0;t<e.length;t+=1)n(e[t])<i&&o.push(e[t]),n(e[t])>i&&s.push(e[t]),n(e[t])===i&&l.push(e[t]);if(t<o.length)e=o;else{if(t<o.length+l.length)return l[0];e=s,t=t-o.length-l.length}}var r,a}},{}],82:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const u=t("d3"),i=t("./Components/BaseWidget"),o=t("./Components/Toolbar"),s=t("./Components/Plot2dPathsWidget"),l=t("./Components/MetricDistributionWidget"),c=t("./Components/ImageSelectionWidget"),r=t("./LayoutFramework"),h=t("./types"),a=t("./DataModel/DataEvents"),f=t("./Components/DetailedDistributionWidget"),d=t("./devlib/DevlibTSUtil"),p=t("idb"),g=t("protobufjs"),m=t("./DataModel/ImageStackDataRequest");n.App=class{constructor(t,e,n,i){this._container=t,this._componentList=[],this._layoutFramework=new r.LayoutFramework(t),this._dataFromPbObject=e,this._trackDerivationFunctions=n,this._pointDerivationFunctions=i,document.addEventListener(a.DataEvents.brushChange,t=>{this.onBrushChange()}),document.addEventListener(a.DataEvents.selectionToFilter,t=>{this.onSelectionToFilter()}),document.addEventListener(a.DataEvents.applyNewFilter,t=>{this.onApplyNewFilter()})}get data(){return this._data}get filteredData(){return this._filteredData}get container(){return this._container}get componentList(){return this._componentList}get layoutFramework(){return this._layoutFramework}get componentContainers(){return this._componentContainers}get dataFromPbObject(){return this._dataFromPbObject}get trackDerivationFunctions(){return this._trackDerivationFunctions}get pointDerivationFunctions(){return this._pointDerivationFunctions}get dataStore(){return this._dataStore}get imageStackDataRequest(){return this._imageStackDataRequest}async InitDataStore(){var t=await p.openDB("loon-db",void 0,{upgrade(t,e,n,i){t.objectStoreNames.contains("tracks")||t.createObjectStore("tracks"),t.objectStoreNames.contains("images")||t.createObjectStore("images")}});this._dataStore=t}InitializeLayout(t){this._componentContainers=this.layoutFramework.InitializeLayout(t),d.DevlibTSUtil.launchSpinner();for(var[e,n]of this.componentContainers)this.InitializeComponent(n,e)}InitializeComponent(e,n){let i,r,a=null;switch("string"==typeof e?r=e:(r=e.type,a=e.initArgs),r){case h.ComponentType.Plot2dPathsWidget:let t=!0;void 0!==a.squareAspectRatio&&(t=a.squareAspectRatio);i=new s.Plot2dPathsWidget(n,a.quickPickOptions,0,t);break;case h.ComponentType.MetricDistributionWidget:i=new l.MetricDistributionWidget(n,a.metricDistributionCollectionLevel);break;case h.ComponentType.ImageSelectionWidget:i=new c.ImageSelectionWidget(n,a.samplingStrat);break;case h.ComponentType.DetailedDistribution:i=new f.DetailedDistributionWidget(n,a.metricDistributionCollectionLevel,a.attributeKey);break;case h.ComponentType.Toolbar:i=new o.Toolbar(n);break;default:console.error(`Cannot Initialize Component of type: ${r}`)}this.componentList.push(i)}LoadDataset(t){this.fetchJson(`${t}.json`)}async fetchJson(t){await u.json("../../../data/"+t).then(async t=>{this.fetchPb(`${t.googleDriveId}/massOverTime.pb`,t,t.googleDriveId)})}fetchPb(o,s,l){g.load("/static/protoDefs/PbCurveList.proto",async(t,e)=>{if(t)throw t;let n=e.lookupType("pbCurveList.PbCurveList"),i;if(this.dataStore){let t=this.dataStore.transaction("tracks","readonly").objectStore("tracks");i=await t.get(l)}var r;i&&!Array.isArray(i)||(a="../../../data/"+o,i=await u.buffer(a),await this.dataStore.put("tracks",i,l)),this._imageStackDataRequest=new m.ImageStackDataRequest(s.googleDriveId),await this.imageStackDataRequest.init();for(r of this.componentList)r instanceof c.ImageSelectionWidget&&(r.imageStackDataRequest=this.imageStackDataRequest);var a=n.decode(new Uint8Array(i));this.initData(a,s)})}initData(t,e){let n=this.dataFromPbObject(t,this.trackDerivationFunctions,this.pointDerivationFunctions,e);n.ApplyDefaultFilters(),n.ApplyNewFilter();e=n.CreateFilteredCurveList();n.OnBrushChange(),this.SetData(e,n)}SetData(t,e){console.log("App.SetData: "),console.log(e),this._filteredData=t,this._data=e;for(var n of this.componentList)n instanceof i.BaseWidget&&n.SetData(t,e)}OnWindowResize(){for(var t of this.componentList)t.Resize()}onBrushChange(){this.filteredData.OnBrushChange();for(var t of this.componentList)t instanceof i.BaseWidget&&t.OnBrushChange()}onSelectionToFilter(){this.data.ConsumeFilters(this.filteredData);var t=this.filteredData.CreateFilteredCurveList();this.SetData(t,this.data)}onApplyNewFilter(){this.data.ApplyNewFilter();var t=this.data.CreateFilteredCurveList();this.data.OnBrushChange(),this.SetData(t,this.data)}}},{"./Components/BaseWidget":84,"./Components/DetailedDistributionWidget":85,"./Components/ImageSelectionWidget":88,"./Components/MetricDistributionWidget":91,"./Components/Plot2dPathsWidget":93,"./Components/Toolbar":96,"./DataModel/DataEvents":104,"./DataModel/ImageStackDataRequest":110,"./LayoutFramework":113,"./devlib/DevlibTSUtil":116,"./types":118,d3:42,idb:43,protobufjs:46}],83:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i{constructor(t,...e){this._container=t,this._componentIndex=i._componentCount,i._componentCount++,this.initProps(e),this.setWidthHeight(),this.init()}get container(){return this._container}get width(){return this._width}get height(){return this._height}get ComponentId(){return this.constructor.name+"_"+this._componentIndex}initProps(t){}init(){let t=document.createElement("div");t.textContent=`Class ${this.constructor.name} has not implement 'init' function`,t.classList.add("notImplementedWarning"),this.container.innerHTML=null,this.container.appendChild(t)}Resize(){this.setWidthHeight(),this.OnResize()}setWidthHeight(){this._width=this.container.clientWidth,this._height=this.container.clientHeight}OnResize(){this.container.innerHTML=null;let t=document.createElement("div");t.textContent=`Resized to: (${this.width}, ${this.height})
override ${this.constructor.name}.OnResizeDraw() to ensure content is resized correctly`,t.classList.add("notImplementedWarning"),this.container.appendChild(t)}}n.BaseComponent=i,i._componentCount=0},{}],84:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t("d3");var r=t("./BaseComponent");const a=t("../devlib/DevlibTSUtil"),o=t("./GroupByWidget");class s extends r.BaseComponent{constructor(t,e=!1,...n){super(t,...n),(this._canFacet=e)&&this.addFacetButton(),this.initButtonListContainer(),this._dataSuperset=null,document.addEventListener("groupByChanged",t=>{this.showingFacetPopup&&this.drawFacetedData(t.detail.flatFacetList)}),this._showingFacetPopup=!1}get data(){return this._data}get dataSuperset(){return this._dataSuperset}get fullData(){return this._dataSuperset?this.dataSuperset:this.data}get margin(){return this._margin}get vizWidth(){return this._vizWidth}get vizHeight(){return this._vizHeight}get canFacet(){return this._canFacet}set canFacet(t){t||this.removeFacetButton(),this._canFacet=t}get showingFacetPopup(){return this._showingFacetPopup}get buttonList(){return this._buttonList||(this._buttonList=[]),this._buttonList}get buttonListContainer(){return this._buttonListContainer}get facetButton(){return this._facetButton}get largePopupOuter(){if(this._largePopupOuter)return this._largePopupOuter;var t=document.getElementById("largePopupContainerOuter");return t?this._largePopupOuter=t:this.initLargePopup(),this._largePopupOuter}get largePopup(){if(this._largePopup)return this._largePopup;var t=document.getElementById("largePopupContainer");return t?this._largePopup=t:this.initLargePopup(),this._largePopup}get largePopupContent(){return this._largePopupContent}initProps(t){this.setMargin()}setMargin(){this._margin={top:20,right:20,bottom:20,left:20}}SetData(t,e){this._data=t,e&&(this._dataSuperset=e),0===t.GetFacetOptions().length&&(this.canFacet=!1),this.OnDataChange()}OnBrushChange(){console.log("base: OnBrushChange")}setWidthHeight(){super.setWidthHeight(),this._vizWidth=this.width-this.margin.left-this.margin.right,this._vizHeight=this.height-this.margin.top-this.margin.bottom}initButtonListContainer(){this._buttonListContainer=document.createElement("div"),this.buttonListContainer.classList.add("noDisp");let t=this.buttonListContainer.style;t.position="absolute",t.right="0px",t.top="0px",t.pointerEvents="none",t.display="flex",t.flexDirection="row-reverse",this.container.addEventListener("mouseenter",this.onMouseEnter()),this.container.addEventListener("mouseleave",this.onMouseLeave()),this.container.appendChild(this.buttonListContainer);for(var e of this.buttonList)this.buttonListContainer.appendChild(e)}addFacetButton(){this._facetButton=this.AddButton("layer-group","Facet chart by conditions",()=>{this.drawFacetContent()})}AddButton(t,e,n,i){let r=a.DevlibTSUtil.getIconButton(t,n,i);return r.title=e,r.style.pointerEvents="all",this.buttonList.unshift(r),r}removeFacetButton(){this.facetButton&&this.buttonListContainer.removeChild(this.facetButton)}onMouseEnter(){return()=>a.DevlibTSUtil.show(this.buttonListContainer)}onMouseLeave(){return()=>a.DevlibTSUtil.hide(this.buttonListContainer)}drawFacetContent(){this.largePopup.innerHTML=null,a.DevlibTSUtil.show(this.largePopupOuter),this._showingFacetPopup=!0;const t=new o.GroupByWidget(i.select(this.largePopup));t.updateGroupByOptions(this.data,!0);let e=document.createElement("div");e.classList.add("largePopupContent"),this.largePopup.appendChild(e),this._largePopupContent=e,this.drawFacetedData(t.getFlatFacetList())}drawFacetedData(t){this.drawFacetedDataDefault(t,"500px","250px")}drawFacetedDataDefault(t,e,n){this.largePopupContent&&(this.largePopupContent.innerHTML=null);for(var i of t)this.drawSingleFacetedData(i.name.join(" "),i.data,e,n)}drawSingleFacetedData(t,e,n,i){let r=document.createElement("div");r.classList.add("outerFacetContainer"),r.style.width=n,r.style.height=i;let a=document.createElement("div");a.classList.add("facetTitle"),a.innerText=t,r.appendChild(a);let o=document.createElement("div");o.classList.add("facetContainer"),r.appendChild(o),this.largePopupContent.appendChild(r),this.initSubWidget(o,t,e)}initSubWidget(t,e,n){let i=this.Clone(t);i.canFacet=!1,i.SetData(n,this.data)}initLargePopup(){let t=document.createElement("div");t.id="largePopupContainerOuter",t.classList.add("largePopupContainerOuter"),t.addEventListener("click",()=>{a.DevlibTSUtil.hide(this.largePopupOuter),this._showingFacetPopup=!1});let e=document.createElement("div");e.id="largePopupContainer",e.classList.add("largePopupContainer"),e.addEventListener("click",t=>{t.stopPropagation()}),this._largePopup=e,t.appendChild(e),a.DevlibTSUtil.hide(t),document.body.appendChild(t),this._largePopupOuter=t}}n.BaseWidget=s},{"../devlib/DevlibTSUtil":116,"./BaseComponent":83,"./GroupByWidget":86,d3:42}],85:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t("d3");var i=t("./BaseWidget");const a=t("../types");class o extends i.BaseWidget{constructor(t,e,n,i=!1){super(t,!0),this._metricDistributionCollectionLevel=e,this._attributeKey=n,this.setLabel(),this._isClone=i}Clone(t){return new o(t,this.metricDistributionCollectionLevel,this.attributeKey,!0)}get isClone(){return this._isClone}get metricDistributionCollectionLevel(){return this._metricDistributionCollectionLevel}get attributeKey(){return this._attributeKey}get pointCollection(){return this._pointCollection}get fullPointCollection(){return this._fullPointCollection}get randomNoiseList(){return this._randomNoiseList}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get svgSelect(){return this._svgSelect}get mainGroupSelect(){return this._mainGroupSelect}get canvasElement(){return this._canvasElement}get totalBoxplotContainerSelectOutline(){return this._totalBoxplotContainerSelectOutline}get totalBoxplotContainerSelect(){return this._totalBoxplotContainerSelect}get filteredBoxplotContainerSelectOutline(){return this._filteredBoxplotContainerSelectOutline}get filteredBoxplotContainerSelect(){return this._filteredBoxplotContainerSelect}get brushGroupSelect(){return this._brushGroupSelect}get boxplotStatsPopupSelect(){return this._boxplotStatsPopupSelect}set boxplotStatsPopupSelect(t){this._boxplotStatsPopupSelect=t}get axisPadding(){return this._axisPadding}get xAxisGroupSelect(){return this._xAxisGroupSelect}get xLabelTextSelect(){return this._xLabelTextSelect}get brush(){return this._brush}get totalBoxplotStats(){return this._totalBoxplotStats}get filteredBoxplotStats(){return this._filteredBoxplotStats}get scatterplotPadding(){return this._scatterplotPadding}get betweenBoxplotPadding(){return this._betweenBoxplotPadding}setMargin(){this._margin={top:6,right:8,bottom:56,left:8}}init(){this._scatterplotPadding=8;const t=r.select(this.container);this._canvasElement=t.append("xhtml:canvas").attr("width",this.vizWidth).attr("height",this.vizHeight-2*this.scatterplotPadding).attr("style",`position: absolute;
                transform: translate(${this.margin.left}px, ${this.margin.top+this.scatterplotPadding}px);`).node(),this._svgSelect=t.append("svg").attr("width",this.width).attr("height",this.height).attr("style","z-index: 0;"),this._boxplotStatsPopupSelect=t.append("div").classed("boxplotStatsPopup",!0),this.hideBoxplotStatsPopup(),this._mainGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.scatterplotPadding})`),this._totalBoxplotContainerSelectOutline=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("boxplot-container",!0),this._totalBoxplotContainerSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("boxplot-container",!0),this._filteredBoxplotContainerSelectOutline=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("boxplot-container",!0),this._filteredBoxplotContainerSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("boxplot-container",!0),this._brushGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("brushContainer",!0),this._axisPadding=4,this._xAxisGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.vizHeight+this.axisPadding})`).classed("labelColor",!0),this._betweenBoxplotPadding=4}setLabel(){this._xLabelTextSelect=this.svgSelect.append("text").classed("axisLabel",!0).classed("labelColor",!0).classed("noDisp",!0).text(this.attributeKey),this.positionLabels()}positionLabels(){var t=32+this.axisPadding;this.xLabelTextSelect.attr("transform",`translate(${this.margin.left+this.vizWidth/2}, ${this.margin.top+this.vizHeight+t})`)}OnDataChange(){switch(this.metricDistributionCollectionLevel){case a.MetricDistributionCollectionLevel.Point:this._pointCollection=this.data,this._fullPointCollection=this.fullData;break;case a.MetricDistributionCollectionLevel.Curve:this._pointCollection=this.data.curveCollection,this._fullPointCollection=this.fullData.curveCollection;break;default:throw new Error("DetailedDistribution needs a valid MetricDistributionCollectionLevel")}this._randomNoiseList=[];for(let t=0;t<this.pointCollection.length;t++)this.randomNoiseList.push(Math.random());this.updateTotalBoxplotStats(),this.updateScales(),this.draw(),this.showLabel()}updateTotalBoxplotStats(){var t=this.pointCollection.Array.map(t=>t.get(this.attributeKey)).filter(t=>!isNaN(t)).sort((t,e)=>t-e);this._totalBoxplotStats=o.calculateBoxplotStats(t)}updateFilteredBoxplotStats(){var t=this.pointCollection.Array.filter(t=>t.inBrush).map(t=>t.get(this.attributeKey)).filter(t=>!isNaN(t)).sort((t,e)=>t-e);this._filteredBoxplotStats=o.calculateBoxplotStats(t)}static calculateBoxplotStats(t){var e=r.median(t),n=r.quantile(t,.25),i=r.quantile(t,.75),t=i-n;return{median:e,quartileRange:[n,i],whiskerRange:[n-1.5*t,i+1.5*t]}}updateScales(){let t;t=this.isClone?this.fullPointCollection:this.pointCollection;var e=t.getMinMax(this.attributeKey),e=r.max(e,t=>Math.abs(t));this._scaleX=r.scaleLinear().domain([-e,e]).range([0,this.vizWidth]),this._scaleY=r.scaleLinear().domain([0,1]).range([this.vizHeight-2*this.scatterplotPadding,0])}draw(){var t,n=this.pointCollection.Array.filter(t=>!isNaN(t.get(this.attributeKey)));const i=this.canvasElement.getContext("2d");i.clearRect(0,0,this.vizWidth,this.vizHeight-2*this.scatterplotPadding),i.fillStyle="black",i.globalAlpha=.6;for(let e=0;e<n.length;e++){let t=n[e];var r=this.scaleX(t.get(this.attributeKey)),a=this.scaleY(this.randomNoiseList[e]);i.beginPath();i.arc(r,a,.5,0,2*Math.PI),i.fill()}this.data.brushApplied?(t=(this.vizHeight-this.betweenBoxplotPadding)/2,this.drawBoxplot(this.totalBoxplotContainerSelectOutline,this.totalBoxplotStats,0,t,!0),this.drawBoxplot(this.totalBoxplotContainerSelect,this.totalBoxplotStats,0,t),this.drawBoxplot(this.filteredBoxplotContainerSelectOutline,this.filteredBoxplotStats,t+this.betweenBoxplotPadding,t,!0,!0),this.drawBoxplot(this.filteredBoxplotContainerSelect,this.filteredBoxplotStats,t+this.betweenBoxplotPadding,t,!1,!0),this.filteredBoxplotContainerSelectOutline.classed("noDisp",!1),this.filteredBoxplotContainerSelect.classed("noDisp",!1)):(this.drawBoxplot(this.totalBoxplotContainerSelectOutline,this.totalBoxplotStats,0,this.vizHeight,!0),this.drawBoxplot(this.totalBoxplotContainerSelect,this.totalBoxplotStats,0,this.vizHeight),this.filteredBoxplotContainerSelectOutline.classed("noDisp",!0),this.filteredBoxplotContainerSelect.classed("noDisp",!0)),this.drawAxis(),this.positionLabels()}drawFacetedData(t){this.drawFacetedDataDefault(t,"95%","120px")}showLabel(){this.xLabelTextSelect.classed("noDisp",!1)}drawBoxplot(t,e,n,i,r=!1,a=!1){t.selectAll(".boxplotMedianLine").data([e.median]).join("line").attr("x1",t=>this.scaleX(t)).attr("y1",n).attr("x2",t=>this.scaleX(t)).attr("y2",n+i).classed("boxplotMedianLine",!0).classed("outline",r).classed("selection",a),t.selectAll("rect").data([e.quartileRange]).join("rect").classed("IQR-Box",!0).classed("selection",a).classed("outline",r).attr("x",t=>this.scaleX(t[0])).attr("y",n).attr("width",t=>this.scaleX(t[1])-this.scaleX(t[0])).attr("height",i).on("mouseover",()=>{this.showBoxplotStatsPopup(e,t)}).on("mouseout",()=>{this.hideBoxplotStatsPopup()});var o=n+i/2;t.selectAll(".boxplotWhiskers").data([[e.whiskerRange[0],e.quartileRange[0]],[e.whiskerRange[1],e.quartileRange[1]]]).join("line").attr("x1",t=>this.scaleX(t[0])).attr("y1",o).attr("x2",t=>this.scaleX(t[1])).attr("y2",o).classed("selection",a).classed("outline",r).classed("boxplotWhiskers",!0);o=i*(1-.66)/2;t.selectAll(".boxplotWhiskerEnds").data(e.whiskerRange).join("line").attr("x1",t=>this.scaleX(t)).attr("y1",n+o).attr("x2",t=>this.scaleX(t)).attr("y2",n+i-o).classed("selection",a).classed("outline",r).classed("boxplotWhiskerEnds",!0)}showBoxplotStatsPopup(t,e){this.boxplotStatsPopupSelect.html(null);e=e.node().getBoundingClientRect();this.boxplotStatsPopupSelect.attr("style",`left: ${(e.left+e.right)/2}px; top:${e.bottom}px`),this.boxplotStatsPopupSelect.append("div").attr("id","boxplotStatsPopup-q1").text("Q1: "+t.quartileRange[0].toFixed(4)),this.boxplotStatsPopupSelect.append("div").attr("id","boxplotStatsPopup-median").text("Median: "+t.median.toFixed(4)),this.boxplotStatsPopupSelect.append("div").attr("id","boxplotStatsPopup-q3").text("Q3: "+t.quartileRange[1].toFixed(4)),this.boxplotStatsPopupSelect.classed("noDisp",!1)}hideBoxplotStatsPopup(){this.boxplotStatsPopupSelect.classed("noDisp",!0)}drawAxis(){this.xAxisGroupSelect.attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.vizHeight+this.axisPadding})`).call(r.axisBottom(this.scaleX))}OnResize(){this.svgSelect.attr("width",this.width).attr("height",this.height),r.select(this.canvasElement).attr("width",this.vizWidth).attr("height",this.vizHeight-2*this.scatterplotPadding),this.updateScales(),this.draw()}OnBrushChange(){this.updateFilteredBoxplotStats(),this.draw()}}n.DetailedDistributionWidget=o},{"../types":118,"./BaseWidget":84,d3:42}],86:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const o=t("d3"),s=t("./OptionSelect"),l=t("../devlib/DevlibTSUtil");class c{constructor(t){this._outerContainer=t,this._mainContainer=this.outerContainer.append("div").classed("groupByMainContainer",!0),this._innerComponentId="groupByInnerContainer_"+c._componentCount+"_",c._componentCount++,this._groupByInnerConainerIdList=[],this.addComponentId(),this.drawLines([0]),this.addGroupByLine()}get outerContainer(){return this._outerContainer}get innerComponentId(){return this._innerComponentId}get mainContainer(){return this._mainContainer}get groupByOuterContainerList(){return this._groupByOuterContainerList}get data(){return this._data}set data(t){this._data=t}get groupByInnerConainerIdList(){return this._groupByInnerConainerIdList}get groupByOptionSelectList(){return this._groupByOptionSelectList}get currentSelectionIndexList(){return this.groupByOptionSelectList.map(t=>t.currentSelectionIndex)}drawLines(i){this._groupByOuterContainerList=this.mainContainer.selectAll(".groupByElementContainer").data(this.groupByInnerConainerIdList).join("div").classed("groupByElementContainer",!0),this.groupByOuterContainerList.html(null),this.groupByOuterContainerList.append("div").classed("groupByContainer",!0).classed("smallText",!0).attr("id",t=>t);const a=this;this.groupByOuterContainerList.each(function(t,e){let n,i;i=0===e?(n="plus",()=>a.addGroupByLine()):(n="minus",()=>a.removeGroupByLine(e));let r=l.DevlibTSUtil.getIconButton(n,i);r.classList.add("compact"),o.select(this).node().appendChild(r)}),this._groupByOptionSelectList=[];for(let n=0;n<this.groupByInnerConainerIdList.length;n++){var r=this.groupByInnerConainerIdList[n];let t;t=n<i.length?i[n]:this.getFirstUnselectedOption(i);let e;e=0===n?"Group by":"and";r=new s.OptionSelect(r,e,t);this.groupByOptionSelectList.push(r)}this.data&&this.updateGroupByOptions(this.data)}getFirstUnselectedOption(t){let e;e=this.data?this.data.GetFacetOptions().length:0;let n=0;for(;t.includes(n)&&n<=e;)n++;return n}addGroupByLine(){var t=this.currentSelectionIndexList;this.addComponentId()&&this.drawLines(t)}addComponentId(){var t=this.groupByInnerConainerIdList.length;if(this.data&&this.data.GetFacetOptions().length===t)return!1;t=this.innerComponentId+t;return this.groupByInnerConainerIdList.push(t),!0}removeGroupByLine(t){const e=this.currentSelectionIndexList;e.splice(t,1),1<this.groupByInnerConainerIdList.length&&this.groupByInnerConainerIdList.pop(),this.drawLines(e)}updateGroupByOptions(t,e=!1){var n=(this._data=t).GetFacetOptions();for(let e=0;e<this.groupByOptionSelectList.length;e++){let t=[];for(var i of n){i={displayName:i.name,callback:()=>this.onGroupSelection()};t.push(i)}this.groupByOptionSelectList[e].onDataChange(t)}e||this.onGroupSelection()}onGroupSelection(){var t=this.getFlatFacetList(),e=this.getColorLookup(),e=new CustomEvent("groupByChanged",{detail:{groupIndex:this.currentSelectionIndexList,flatFacetList:t,colorLookup:e}});document.dispatchEvent(e)}getFlatFacetList(){let e=[{name:[],data:this.data}];for(let t=0;t<this.currentSelectionIndexList.length;t++){var a=this.currentSelectionIndexList[t];let r=[];for(let{name:n,data:i}of e){let t=i.GetFacetOptions()[a],e=t.GetFacets();e=e.map(t=>{let e=n.map(t=>t);return e.push(...t.name),{name:e,data:t.data}}),r.push(...e)}e=r}return e}getColorLookup(){const t=new Map;if(!this.data.defaultFacetAxisTicks)return t;var{yAxisTicks:e,xAxisTicks:n}=this.data.defaultFacetAxisTicks,e=1===this.currentSelectionIndexList[0]?n:e;const i=c.getControlNames();var r,a=c.getControlColor();const{scheme:o,skipIndices:s}=c.getColorScheme();let l=0;for(r of e){for(;s.has(l);)l++,l%=o.length;var u=i.has(r)?a:o[l++];t.set(r,u)}return t}static getControlNames(){return new Set(["DMSO","Ethanol","0.0 um"])}static getControlColor(){return"grey"}static getColorScheme(){return{scheme:o.schemeSet1,skipIndices:new Set([5,8])}}static getColor(t,e){for(var n of t)if(e.has(n))return e.get(n);return"grey"}}n.GroupByWidget=c,c._componentCount=0},{"../devlib/DevlibTSUtil":116,"./OptionSelect":92,d3:42}],87:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const u=t("d3");var i=t("./BaseWidget");const f=t("../devlib/DevlibAlgo"),r=t("../devlib/DevlibTSUtil");class l extends i.BaseWidget{constructor(t,e,n=!0,i=!1,r=!1){super(t,!0,n,i),this._valueKey=e,this.setLabel(),this._isClone=r}Clone(t){return new l(t,this.valueKey,!1,!1)}get isClone(){return this._isClone}initProps(t){super.initProps(),this._canBrush=t[0],this._includeExemplarTrackButton=t[1]}get valueKey(){return this._valueKey}get sortedData(){return this._sortedData}get svgSelect(){return this._svgSelect}get mainGroupSelect(){return this._mainGroupSelect}get totalHistogramGroupSelect(){return this._totalHistogramGroupSelect}get brushedHistogramGroupSelect(){return this._brushedHistogramGroupSelect}get totalKDEGroupSelect(){return this._totalKDEGroupSelect}get brushedKDEGroupSelect(){return this._brushedKDEGroupSelect}get canBrush(){return this._canBrush}get brushGroupSelect(){return this._brushGroupSelect}get axisGroupSelect(){return this._axisGroupSelect}get labelTextSelect(){return this._labelTextSelect}get scaleX(){return this._scaleX}get scaleYHistogramAbsolute(){return this._scaleYHistogramAbsolute}get scaleYHistogramRelative(){return this._scaleYHistogramRelative}get scaleYKdeAbsolute(){return this._scaleYKdeAbsolute}get scaleYKdeRelative(){return this._scaleYKdeRelative}get allBins(){return this._allBins}get brushedBins(){return this._brushedBins}set brushedBins(t){this._brushedBins=t}get allPathPoints(){return this._allPathPoints}get maxDensityAll(){return this._maxDensityAll}get brushedPathPoints(){return this._brushedPathPoints}get brushedPointsLength(){return this._brushedPointsLength}get axisPadding(){return this._axisPadding}get brush(){return this._brush}get useHistogramButton(){return this._useHistogramButton}get useKDEButton(){return this._useKDEButton}static get useKdeInsteadOfHistogram(){return l._useKdeInsteadOfHistogram}static set useKdeInsteadOfHistogram(t){l._useKdeInsteadOfHistogram=t;t=new Event("switchBetweenKdeAndHistogram");document.dispatchEvent(t)}get useAbsoluteButton(){return this._useAbsoluteButton}get useRelativeButton(){return this._useRelativeButton}static get useAbsoluteScaling(){return l._useAbsoluteScaling}static set useAbsoluteScaling(t){l._useAbsoluteScaling=t;t=new Event("switchBetweenAbsoluteAndRelativeScaling");document.dispatchEvent(t)}get includeExemplarTrackButton(){return this._includeExemplarTrackButton}set includeExemplarTrackButton(t){this._includeExemplarTrackButton=t}setMargin(){this._margin={top:6,right:8,bottom:50,left:8}}init(){this.initKDEHIstogramToggle(),this.initAbsoluteRelativeToggle(),this.includeExemplarTrackButton&&this.initExemplarTrackButton(),this._svgSelect=u.select(this.container).append("svg").attr("width",this.width).attr("height",this.height),this._mainGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),this.canBrush&&(this._brushGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("brushContainer",!0),this._brush=u.brushX().extent([[0,0],[this.vizWidth,this.vizHeight]]).on("end",()=>{this.brushHandler()}),this.brushGroupSelect.call(this.brush)),this._totalHistogramGroupSelect=this.mainGroupSelect.append("g"),this._brushedHistogramGroupSelect=this.mainGroupSelect.append("g"),this._totalKDEGroupSelect=this.mainGroupSelect.append("g"),this._brushedKDEGroupSelect=this.mainGroupSelect.append("g"),this._axisPadding=2,this._axisGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.vizHeight+this.axisPadding})`).classed("labelColor",!0),document.addEventListener("exemplarAttributeChange",t=>{t.detail===this.valueKey?this.container.classList.add("selected"):this.container.classList.remove("selected")})}initKDEHIstogramToggle(){this._useHistogramButton=this.AddButton("chart-bar","Change to histograms",()=>{l.useKdeInsteadOfHistogram=!1}),this._useKDEButton=this.AddButton("chart-area","Change to kernel density plots",()=>{l.useKdeInsteadOfHistogram=!0}),l.useKdeInsteadOfHistogram?r.DevlibTSUtil.hide(this.useKDEButton):r.DevlibTSUtil.hide(this.useHistogramButton),document.addEventListener("switchBetweenKdeAndHistogram",t=>{l.useKdeInsteadOfHistogram?(r.DevlibTSUtil.show(this.useHistogramButton),r.DevlibTSUtil.hide(this.useKDEButton)):(r.DevlibTSUtil.hide(this.useHistogramButton),r.DevlibTSUtil.show(this.useKDEButton)),this.OnDataChange()})}initAbsoluteRelativeToggle(){this._useAbsoluteButton=this.AddButton("hashtag","Change to absolute comparison of selections.",()=>{l.useAbsoluteScaling=!0}),this._useRelativeButton=this.AddButton("percent","Change to relative comparison of selections.",()=>{l.useAbsoluteScaling=!1}),l.useAbsoluteScaling?r.DevlibTSUtil.hide(this.useAbsoluteButton):r.DevlibTSUtil.hide(this.useRelativeButton),document.addEventListener("switchBetweenAbsoluteAndRelativeScaling",t=>{this.container.classList.contains("noDisp")||(l.useAbsoluteScaling?(r.DevlibTSUtil.show(this.useRelativeButton),r.DevlibTSUtil.hide(this.useAbsoluteButton)):(r.DevlibTSUtil.hide(this.useRelativeButton),r.DevlibTSUtil.show(this.useAbsoluteButton)),l.useKdeInsteadOfHistogram?this.drawAllKDE(!1):this.drawAllHistograms([],!0))})}initExemplarTrackButton(){this.AddButton("rocket","Sample new exemplars from this attribute.",async()=>{let t=new CustomEvent("launchExemplarCurve",{detail:this.valueKey});r.DevlibTSUtil.launchSpinner(),await r.DevlibTSUtil.makeAsync(()=>document.dispatchEvent(t))})}setLabel(){var t=32+this.axisPadding;this._labelTextSelect=this.svgSelect.append("text").attr("transform",`translate(${this.margin.left+this.vizWidth/2}, ${this.margin.top+this.vizHeight+t})`).classed("axisLabel",!0).classed("labelColor",!0).text(this.valueKey)}OnDataChange(){if(!this.container.classList.contains("noDisp")){var e=this.data.Array.filter(t=>!isNaN(t.get(this.valueKey)));if(this._allBins=this.calculateBins(e),this.updateScales(e.length),l._useKdeInsteadOfHistogram){let t=[...e];const n=this.valueKey;this._sortedData=t.sort((t,e)=>u.ascending(t.get(n),e.get(n))),this._allPathPoints=this.kde(this.sortedData),this._maxDensityAll=u.max(this.allPathPoints,t=>t[1]),this.drawAllKDE(!1),this.removeHistograms()}else this.drawAllHistograms(e),this.removeKDEs();this.drawAxis()}}calculateBins(t){return l.calculateBins(t,this.valueKey,this.fullData)}static calculateBins(e,n,i,t,r=!1){let a;a=t||Math.round(Math.sqrt(i.length))/3;i=i.getMinMax(n);let o=u.scaleLinear().domain(i),s;s=r?u.range(i[0],i[1],(i[1]-i[0])/a):(o=o.nice(a),o.ticks(a));i=u.histogram().domain(o.domain()).thresholds(s).value(t=>t.get(n))(e),e=i[i.length-1];if(e.x0===e.x1){let t=i[i.length-2];if(t)for(var l of e)t.push(l)}return i}removeHistograms(){this.totalHistogramGroupSelect.html(null),this.brushedHistogramGroupSelect.html(null)}drawAllHistograms(n,t=!1){if(!this.container.classList.contains("noDisp")){if(!t){let e=n.filter(t=>t.inBrush);n.length===e.length?(this.brushedHistogramGroupSelect.html(null),this._brushedBins=[]):this._brushedBins=this.calculateBins(e);var i=u.max(this.allBins,t=>t.length/n.length),t=u.max(this.brushedBins,t=>t.length/e.length);this._scaleYHistogramRelative=u.scaleLinear().domain([0,u.max([i,t])]).range([0,this.vizHeight])}this.drawHistogram(this.totalHistogramGroupSelect,this.allBins),this.drawHistogram(this.brushedHistogramGroupSelect,this.brushedBins,!0)}}drawHistogram(e,n,i=!1){if(0!==n.length){n=this.getHistogramSkyline(n);let t=u.line().x(t=>t[0]).y(t=>t[1]).defined(t=>null!==t[0]);e.selectAll("path").data([t(n)]).join("path").classed("kdePath",!0).classed("inBrush",i).transition().attr("d",t=>t)}else e.html(null)}getHistogramSkyline(t,e=18){let n=[];if(1===t.length){var i=(this.vizWidth-e)/2,e=(this.vizWidth+e)/2;return n.push([i,this.vizHeight]),n.push([i,0]),n.push([e,0]),n.push([e,this.vizHeight]),n}var r,a=u.sum(t,t=>t.length);for(r of t){var o=this.scaleX(r.x0);let t;t=l.useAbsoluteScaling?this.scaleYHistogramAbsolute(r.length):this.scaleYHistogramRelative(r.length/a);var s=this.vizHeight-t;n.push([o,s]),0===r.length&&n.push([null,null]);o=this.scaleX(r.x1);n.push([o,s])}return n.unshift([0,this.vizHeight]),n.push([this.vizWidth,this.vizHeight]),n}removeKDEs(){this.totalKDEGroupSelect.html(null),this.brushedKDEGroupSelect.html(null)}drawAllKDE(t){var e=this.sortedData.filter(t=>t.inBrush);this._brushedPathPoints=this.kde(e),this._brushedPointsLength=e.length;let n=this.maxDensityAll;l.useAbsoluteScaling||(e=u.max(this.brushedPathPoints,t=>t[1]),n=u.max([n,e])),this._scaleYKdeRelative=u.scaleLinear().domain([0,n]).range([this.vizHeight,0]),t&&!l.useAbsoluteScaling||this.drawKDE(this.sortedData.length,this.allPathPoints,!1,this.totalKDEGroupSelect),this.brushedPointsLength===this.sortedData.length?this.brushedKDEGroupSelect.html(null):this.drawKDE(this.brushedPointsLength,this.brushedPathPoints,!0,this.brushedKDEGroupSelect)}drawKDE(e,t,n,i){let r;r=l.useAbsoluteScaling?t=>this.scaleYKdeRelative(e/this.sortedData.length*t[1]):t=>this.scaleYKdeRelative(t[1]);let a=u.line().x(t=>this.scaleX(t[0])).y(r);i.selectAll("path").data([a(t)]).join("path").classed("kdePath",!0).classed("inBrush",n).transition().attr("d",t=>t)}kde(i){const r=this.epanechnikov;var a,[t,e]=this.scaleX.domain(),o=.01*(e-t);let s=[];for(a of this.scaleX.ticks(100)){var l=f.DevlibAlgo.compareProperty(a,t=>t.get(this.valueKey));let t;var u=f.DevlibAlgo.BinarySearchIndex(i,l);t="number"==typeof u?u:([l,u]=u,void 0!==l?l:u);let n=0;for(let e=t+1;e<i.length;e++){let t=i[e];var c=(a-t.get(this.valueKey))/o;if(1<Math.abs(c))break;n+=r(c)}for(let e=t;0<=e;e--){let t=i[e];var h=(a-t.get(this.valueKey))/o;if(1<Math.abs(h))break;n+=r(h)}s.push([a,n/i.length])}return s.unshift([t,0]),s.push([e,0]),s}epanechnikov(t){return Math.abs(t)<=1?.75*(1-t*t):0}updateScales(t){var e=this.allBins[0].x0,n=this.allBins[this.allBins.length-1].x1;this._scaleX=u.scaleLinear().domain([e,n]).range([0,this.vizWidth]);n=u.max(this.allBins,t=>t.length);this._scaleYHistogramAbsolute=u.scaleLinear().domain([0,n]).range([0,this.vizHeight])}MoveBrush(t){t&&(t[0]=this.scaleX(t[0]),t[1]=this.scaleX(t[1])),this.brushGroupSelect.call(this.brush.move,t)}drawAxis(){this.axisGroupSelect.call(u.axisBottom(this.scaleX).ticks(5))}OnResize(){this.OnDataChange()}brushHandler(){var t,e=u.event.selection;null!=e?([t,e]=e,t=this.scaleX.invert(t),e=this.scaleX.invert(e),e={key:this.valueKey,bound:[t,e]},this.data.addBrush(this.ComponentId,e)):this.data.removeBrush(this.ComponentId)}OnBrushChange(){var t;this.container.classList.contains("noDisp")||(l._useKdeInsteadOfHistogram?this.drawAllKDE(!0):(t=this.data.Array.filter(t=>!isNaN(t.get(this.valueKey))),this.drawAllHistograms(t)))}}n.HistogramWidget=l,l._useKdeInsteadOfHistogram=!1,l._useAbsoluteScaling=!0},{"../devlib/DevlibAlgo":114,"../devlib/DevlibTSUtil":116,"./BaseWidget":84,d3:42}],88:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const m=t("d3");var i=t("./BaseWidget");const r=t("./ImageStackWidget"),a=t("../DataModel/ImageMetaData"),v=t("../devlib/DevlibMath"),o=t("./RichTooltip"),s=t("./GroupByWidget"),l=t("../devlib/DevlibTSUtil");class u extends i.BaseWidget{constructor(t,e,n=!1){super(t,!1,e),this._isClone=n}Clone(t){return new u(t,this.samplingStratOptions,!0)}get isClone(){return this._isClone}get imageMetaData(){return this._imageMetaData}get imageStackDataRequest(){return this._imageStackDataRequest}set imageStackDataRequest(t){this._imageStackDataRequest=t}get innerContainer(){return this._innerContainer}get imageTrackContainer(){return this._imageTrackContainer}get locationSelectionContainer(){return this._locationSelectionContainer}get menuBarContainer(){return this._menuBarContainer}get legendContentContainer(){return this._legendContentContainer}get groupByWidget(){return this._groupByWidget}get locationListContainer(){return this._locationListContainer}get imageStackContainer(){return this._imageStackContainer}get imageStackWidget(){return this._imageStackWidget}get selectedLocationId(){return this._selectedLocationId}get hoveredLocationId(){return this._hoveredLocationId}get frameTooltip(){return this._frameTooltip}get frameHeight(){return this._frameHeight}get frameHeightSelected(){return this._frameHeightSelected}get frameMarginTopBot(){return this._frameMarginTopBot}get frameScaleX(){return this._frameScaleX}get frameScaleHeight(){return this._frameScaleHeight}get hoveredLocFrame(){return this._hoveredLocFrame}get selectedLocFrame(){return this._selectedLocFrame}get hoveredLocId(){return this._hoveredLocId}get samplingStratOptions(){return this._samplingStratOptions}initProps(t){super.initProps(),this._samplingStratOptions=t[0]}init(){this._frameHeight=32,this._frameHeightSelected=32,this._frameMarginTopBot=12,this._frameTooltip=new o.RichTooltip(0,0),this._selectedLocFrame=[1,1],this._hoveredLocFrame=null,this._hoveredLocId=null,this._innerContainer=m.select(this.container).append("div"),this.innerContainer.classed("imageSelectionContainer",!0),this._imageTrackContainer=m.select(this.container).append("div"),this.imageTrackContainer.classed("imageTrackContainer",!0),this._locationSelectionContainer=this.innerContainer.append("div").classed("locationSelectionContainer",!0),this._menuBarContainer=this.locationSelectionContainer.append("div").classed("menuBarContainer",!0),document.onkeydown=t=>{this.handleKeyDown(t)},this._groupByWidget=new s.GroupByWidget(this.menuBarContainer);const e=l.DevlibTSUtil.getIconButton("question-circle",()=>{var t=this.legendContentContainer.classed("noDisp");m.select(e).classed("selected",t),this.legendContentContainer.classed("noDisp",!t)},"Legend");this.menuBarContainer.node().appendChild(e),this._legendContentContainer=this.menuBarContainer.append("div").classed("legendContentContainer",!0).classed("noDisp",!0),this.legendContentContainer.append("img").attr("src","/static/assets/image-selection-legend.png"),this._locationListContainer=this.locationSelectionContainer.append("div").classed("locationListContainer",!0),this._imageStackContainer=this.innerContainer.append("div").classed("imageStackContainer",!0).classed("overflow-scroll",!0),this._imageStackWidget=new r.ImageStackWidget(this.imageStackContainer.node(),this.imageTrackContainer.node(),this.vizHeight,this.samplingStratOptions),document.addEventListener("frameHoverChange",t=>{var e=t.detail.locationId,n=t.detail.frameId,t=t.detail.cellId;this.onHoverLocationFrame(e,n,t,!1)}),document.addEventListener("locFrameClicked",t=>{var e=t.detail.locationId,t=t.detail.frameId;this.onClickLocationFrame(e,t)}),document.addEventListener("imageSelectionRedraw",t=>{this.draw()}),document.addEventListener("manualPinToggle",t=>{this.updateAllExtractedDots()}),this.OnResize()}OnDataChange(){this._imageMetaData=a.ImageMetaData.fromPointCollection(this.fullData),this._selectedLocationId=this.imageMetaData.locationList[0].locationId,this.groupByWidget.updateGroupByOptions(this.data),this._hoveredLocationId=null;var t=this.imageMetaData.locationLookup.get(this.selectedLocationId);this.imageStackWidget.SetData(this.data,this.fullData,t,this.imageStackDataRequest,!0),this.imageMetaData.updateInBrushProp(this.data),this.draw()}setImageStackWidget(i=!1){var[t,e]=this.selectedLocFrame,n=this.imageMetaData.locationLookup.get(this.selectedLocationId);this.imageStackWidget.imageLocation=n,this.imageStackDataRequest.getImage(t,e,(t,e,n)=>{this.imageStackWidget.SetImageBlob(n),this.imageStackWidget.draw(i)})}OnResize(){var t=.5*this.height,e=this.height-t;this.imageStackWidget.OnResize(t,e,this.width),this.locationSelectionContainer.classed("overflow-scroll",!0).attr("style",`max-height: ${t}px`),this.imageTrackContainer.attr("style",`max-width: ${this.width}px;
            max-height: ${e}px;
            width: ${this.width}px;
            height: ${e}px;`)}OnBrushChange(){this.imageMetaData.updateInBrushProp(this.data),this.draw(),this.imageStackWidget.OnBrushChange()}draw(){this.locationListContainer.html(null),this.drawFacetRecurse(this.groupByWidget.currentSelectionIndexList),this.drawSelectedDots()}drawFacetRecurse(t,e=0,n,i){let r;if(r=i||this.locationListContainer,0===t.length)return this.drawTerminalFacet(r,n.name.join(" "),n.data,e,0),1;let a;a=(n||this).data;i=t[0];let o=a.GetFacetOptions()[i];var s,i=o.GetFacets();let l;n&&(l=this.drawGrouperFacet(r,n.name.join(" "),e,t.length));let u=e,c=0;for(s of i){u++;var h=this.drawFacetRecurse(t.slice(1),u,s,l);c+=h}return c}drawGrouperFacet(t,e,n,i){return this.drawTitleElement(t,e,n,i),t.append("div").classed("locationListGrouper",!0)}drawTitleElement(t,e,n,i){let r=`top: ${19*(n-1)}px;`;if(0<i&&(r+=` z-index: ${i};`),this.imageStackWidget.colorLookup.has(e)){i=s.GroupByWidget.getColor([e],this.imageStackWidget.colorLookup);let t=m.hsl(i);r+=`color: ${t.darker(1).toString()};`,t.l=.95,r+=`background: ${t.toString()};`}t.append("div").text(e).classed("locationListCatTitle",!0).attr("style",r)}drawTerminalFacet(t,e,n,i,r){this.drawTitleElement(t,e,i,r);const a=t.append("ul").classed("subListContainer",!0);let o=n.locationList;if(this.imageStackWidget.inCondensedMode&&(o=o.filter(t=>this.imageStackWidget.exemplarLocations.has(t))),0!==o.length){const u=a.selectAll("li").data(o).join("li");let e;e=this.data.brushApplied?(n=m.max(this.imageMetaData.locationList,t=>t.inBrushCount),m.scaleLinear().domain([0,n]).range([0,1])):(s=m.max(this.imageMetaData.locationList,t=>t.totalCount),m.scaleLinear().domain([0,s]).range([0,1])),u.html(null).append("button").text(t=>t).classed("locationButton",!0).classed("toggleButton",!0).classed("selected",t=>t==this.selectedLocationId).attr("id",t=>"imageLocation-"+t).attr("style",t=>{t=this.imageMetaData.locationLookup.get(t),t=100*(1-(this.data.brushApplied?e(t.inBrushCount):e(t.totalCount)));return`background: linear-gradient(to left, rgba(255,255,255,0), rgba(255,255,255,0) ${t}%, #EDCAC9, ${t}%, #EDCAC9)`}).on("click",t=>{this.onClickLocation(t)});const c=u.append("div").classed("frameListContainer",!0);var s=c.node().getBoundingClientRect().width;const h=c.append("svg").attr("width",s).attr("height",t=>t===this.selectedLocationId?this.frameHeightSelected:this.frameHeight).attr("id",t=>"frameTicksViz-"+t).attr("data-locId",t=>t).on("mouseleave",()=>{this._hoveredLocId=null,this.hideFrameTooltip(),this.removeHoverDots(h),this.changeHoveredLocation(null)});const f=this.fullData.getMinMax("Frame ID");this._frameScaleX=m.scaleLinear().domain(f).range([4,s-4]);let t;t=this.data.brushApplied?m.max(this.imageMetaData.locationList,t=>m.max(t.frameList,t=>t.inBrushCount)):m.max(this.imageMetaData.locationList,t=>m.max(t.frameList,t=>t.totalCount));const d=m.scaleLinear().domain([0,t]).range([1,3]);this._frameScaleHeight=m.scaleLinear().domain([0,t]).range([1,this.frameHeight-2*this.frameMarginTopBot]),h.selectAll("line").data(t=>this.getFrameList(t)).join("line").attr("x1",t=>this.frameScaleX(t.frameId)).attr("x2",t=>this.frameScaleX(t.frameId)).attr("y1",t=>{t=this.data.brushApplied?t.inBrushCount:t.totalCount;return(this.frameHeight-this.frameScaleHeight(t))/2}).attr("y2",t=>{t=this.data.brushApplied?t.inBrushCount:t.totalCount;return this.frameHeight-(this.frameHeight-this.frameScaleHeight(t))/2}).attr("stroke-width",t=>this.data.brushApplied?d(t.inBrushCount):d(t.totalCount)).attr("stroke",t=>t.inBrush?"firebrick":"black").classed("tickMark",!0);var l=h.nodes();for(let t=0;t<l.length;t++){const p=l[t],g=+p.dataset.locId;this.imageStackWidget.inCondensedMode&&this.drawExtractedDots(m.select(p),g,this.imageStackWidget.exemplarFrames.get(g)),p.addEventListener("mousemove",t=>{this._hoveredLocId=g;t=t.offsetX,t=this.frameScaleX.invert(t),t=v.DevlibMath.clamp(Math.round(t),f);this.onHoverLocationFrame(g,t,null,!0)}),p.addEventListener("click",t=>{t=t.offsetX,t=this.frameScaleX.invert(t),t=v.DevlibMath.clamp(Math.round(t),f);document.dispatchEvent(new CustomEvent("locFrameClicked",{detail:{locationId:g,frameId:t}}))})}}}handleKeyDown(t){var[e,n]=this.selectedLocFrame,i=this.imageMetaData.locationLookup.get(e);let r;switch(t.keyCode){case 37:var a=i.frameList[0].frameId;r=Math.max(n-1,a),document.dispatchEvent(new CustomEvent("locFrameClicked",{detail:{locationId:e,frameId:r}}));break;case 39:a=i.frameList[i.frameList.length-1].frameId;r=Math.min(n+1,a),document.dispatchEvent(new CustomEvent("locFrameClicked",{detail:{locationId:e,frameId:r}}))}}onHoverLocationFrame(t,e,n,i){this._hoveredLocFrame=[t,e];var r,a=m.select("#frameTicksViz-"+this.hoveredLocationId);this.removeHoverDots(a),this.removeHoverBar(a);const o=m.select("#frameTicksViz-"+t);this.changeHoveredLocation(t),this.frameTooltip.Hide(),null!==e&&(i&&(a=(r=o.node().getBoundingClientRect()).right,i=r.top+r.height/2,r=this.createTooltipContent(t,e),this.frameTooltip.Show(r,a,i)),this.drawHoverDots(o,t,e),this.drawFrameRange(o,n))}drawFrameRange(t,e){if(null!==e){const o=this.fullData.curveLookup.get(e);var n=o.get("Location ID");const s=o.pointList[0];var i=s.get("Frame ID");const l=this.imageMetaData.locationLookup.get(n);var r=l.frameLookup.get(i);const u=o.pointList[o.pointList.length-1];var a=u.get("Frame ID"),e=l.frameLookup.get(a),n=this.frameScaleX(i),i=this.frameScaleX(a),a=(this.frameScaleHeight(r.inBrushCount)+this.frameHeight)/2,r=(this.frameScaleHeight(e.inBrushCount)+this.frameHeight)/2,e=this.frameHeightSelected-6,r=[[n,2+a],[n,e],[i,e],[i,2+r]];const c=m.line().x(t=>t[0]).y(t=>t[1]).curve(m.curveBasis);r=c(r);t.selectAll(".hoverBar").data([r]).join("path").attr("d",r).classed("hoverBar",!0)}else this.removeHoverBar(t)}removeHoverBar(t){t.selectAll(".hoverBar").remove()}updateAllExtractedDots(){this.imageStackWidget.inCondensedMode&&this.draw()}drawExtractedDots(t,e,n){let i=Array.from(n);n=i.map(t=>this.getDotCenters(e,t)[0]);t.selectAll(".extractDot").data(n).join("circle").classed("extractDot",!0).attr("cx",t=>t[0]).attr("cy",t=>t[1]).attr("fill","#ECECEC").attr("stroke","black").attr("r",2.5).attr("opacity",.6).attr("stroke-width",1)}drawHoverDots(t,e,n){n=this.getDotCenters(e,n);t.selectAll(".hoverDot").data(n).join("circle").classed("hoverDot",!0).attr("cx",t=>t[0]).attr("cy",t=>t[1]).attr("fill","#ECECEC").attr("stroke","black").attr("r",2.5).attr("stroke-width",1)}drawSelectedDots(){if(this.frameScaleX){var[t,e]=this.selectedLocFrame,e=this.getDotCenters(t,e);const n=m.select("#frameTicksViz-"+t);n.selectAll(".selectedDot").data(e).join("circle").classed("selectedDot",!0).attr("cx",t=>t[0]).attr("cy",t=>t[1]).attr("fill","black").attr("stroke","black").attr("r",3).attr("stroke-width",.5)}}getDotCenters(t,e){var n=this.imageMetaData.locationLookup.get(t).frameLookup.get(e),t=this.frameScaleX(e),e=this.frameScaleHeight(n.inBrushCount),n=(this.frameHeight-e)/2;return[[t,n-2-3],[t,n+e+2+3]]}removeHoverDots(t){t.selectAll(".hoverDot").remove()}removeCurrentSelectedDots(){const t=m.select("#frameTicksViz-"+this.selectedLocFrame[0]);t.selectAll(".selectedDot").remove()}onClickLocation(t){this.changeLocationSelection(t);this.setImageStackWidget(!0)}onClickLocationFrame(t,e){var[n,i]=this.selectedLocFrame;n===t&&i===e||(this.updateSelectedDots(t,e),this.onClickLocation(t),this.imageStackWidget.changeSelectedImage(e-1),this.imageStackWidget.imageTrackWidget.updateCurrentFrameIndicator(e))}updateSelectedDots(t,e){this.removeCurrentSelectedDots(),this._selectedLocFrame=[t,e],this.drawSelectedDots()}createTooltipContent(t,e){e=[["Location",t.toString()],["Frame",e.toString()]];return o.RichTooltip.createLabelValueListContent(e)}hideFrameTooltip(){this.frameTooltip.Hide()}getFrameList(t){return this.imageMetaData.locationLookup.get(t).frameList}changeLocationSelection(t){let e=m.select("#imageLocation-"+this.selectedLocationId);e.classed("selected",!1);let n=m.select("#frameTicksViz-"+this.selectedLocationId);n.attr("height",this.frameHeight),this._selectedLocationId=t;let i=m.select("#imageLocation-"+this.selectedLocationId);i.classed("selected",!0);let r=m.select("#frameTicksViz-"+this.selectedLocationId);r.attr("height",this.frameHeightSelected)}changeHoveredLocation(t){if(null!==this.hoveredLocationId){let t=m.select("#imageLocation-"+this.hoveredLocationId);if(t.classed("hovered",!1),this.hoveredLocationId!==this.selectedLocationId){let t=m.select("#frameTicksViz-"+this.hoveredLocationId);t.attr("height",this.frameHeight)}}if(this._hoveredLocationId=t,null!==this.hoveredLocationId){let t=m.select("#imageLocation-"+this.hoveredLocationId);t.classed("hovered",!0);let e=m.select("#frameTicksViz-"+this.hoveredLocationId);e.attr("height",this.frameHeightSelected)}}}n.ImageSelectionWidget=u},{"../DataModel/ImageMetaData":109,"../devlib/DevlibMath":115,"../devlib/DevlibTSUtil":116,"./BaseWidget":84,"./GroupByWidget":86,"./ImageStackWidget":89,"./RichTooltip":94,d3:42}],89:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const a=t("d3"),h=t("quickselect.js"),o=t("../Components/RichTooltip"),r=t("./ImageTrackWidget"),s=t("../DataModel/ImageStackDataRequest"),l=t("../devlib/DevlibTSUtil");n.ImageStackWidget=class{constructor(t,e,n,i){this._container=t,this._imageTrackWidget=new r.ImageTrackWidget(e,this,i),this._maxHeight=n,this.init(),this._cellHovered=0,this._selectedImgIndex=0,console.log(a),console.log(this),this._tooltip=new o.RichTooltip,this._exemplarAttribute="Avg. Mass (pg)",this._inExemplarMode=!0,this._inCondensedMode=!0,this._condensedModeCount=7,this._exemplarLocations=new Set,this._exemplarFrames=new Map,this._colorLookup=new Map,this._facetList=[],this._manuallyPinnedTracks=[],this._mousePos=null,this.setNumExemplars()}setNumExemplars(){var t=this.imageTrackWidget.currentSamplingStategy.strat;Array.isArray(t)?this._numExemplars=t.length:this._numExemplars=t,this._numExemplars+=this.imageTrackWidget.manualSampleValues.length}get container(){return this._container}get imageTrackWidget(){return this._imageTrackWidget}get maxHeight(){return this._maxHeight}get imageLocation(){return this._imageLocation}set imageLocation(t){this._imageLocation=t}get imageStackBlob(){return this._imageStackBlob}get numPixelsInTile(){var t;return(null===(t=this.imageStackDataRequest)||void 0===t?void 0:t.tileWidth)*(null===(t=this.imageStackDataRequest)||void 0===t?void 0:t.tileHeight)}get firstIndex(){return this.numPixelsInTile*this.selectedImgIndex}get imageStackLabelUrl(){return this._imageStackLabelUrl}get imageStackWidth(){return this._imageStackWidth}get imageStackHeight(){return this._imageStackHeight}get selectedImgIndex(){return this._selectedImgIndex}get innerContainer(){return this._innerContainer}get conditionLabel(){return this._conditionLabel}get locationLabel(){return this._locationLabel}get frameLabel(){return this._frameLabel}get toggleOptionsContainer(){return this._toggleOptionsContainer}get legendToggleContainer(){return this._legendToggleContainer}get showOutlineToggle(){return this._showOutlineToggle}get invertImageToggle(){return this._invertImageToggle}get legendToggleSelected(){return this._legendToggleSelected}get legendToggleFilteredOut(){return this._legendToggleFilteredOut}get legendToggleNotSelected(){return this._legendToggleNotSelected}get imageAndLegendContainer(){return this._imageAndLegendContainer}get selectedImageContainer(){return this._selectedImageContainer}get selectedImageCanvas(){return this._selectedImageCanvas}get canvasContext(){return this._canvasContext}get data(){return this._data}get fullData(){return this._fullData}get imageStackDataRequest(){return this._imageStackDataRequest}get defaultCanvasState(){return this._defaultCanvasState}get cellHovered(){return this._cellHovered}get tooltip(){return this._tooltip}get exemplarAttribute(){return this._exemplarAttribute}get inExemplarMode(){return this._inExemplarMode}get inCondensedMode(){return this._inCondensedMode}get condensedModeCount(){return this._condensedModeCount}get exemplarLocations(){return this._exemplarLocations}get exemplarFrames(){return this._exemplarFrames}get facetList(){return this._facetList}get colorLookup(){return this._colorLookup}get numExemplars(){return this._numExemplars}get manuallyPinnedTracks(){return this._manuallyPinnedTracks}get mousePos(){return this._mousePos}init(){const t=a.select(this.container),e=t.append("div").classed("locationFrameLabelContainer",!0);this._innerContainer=t.append("div").classed("innerContainer",!0);const n=e.append("h3").classed("locationFrameLabel",!0);n.node().append("Condition: "),this._conditionLabel=n.append("span").classed("locationFrameLabelValue",!0),n.node().append("Location: "),this._locationLabel=n.append("span").classed("locationFrameLabelValue",!0),n.node().append("Frame: "),this._frameLabel=n.append("span").classed("locationFrameLabelValue",!0),this.innerContainer.append("div").attr("style","flex-grow: 1;"),this._toggleOptionsContainer=this.innerContainer.append("div").classed("toggleOptions",!0).classed("smallText",!0);var i="imageToggle-outlines";this._showOutlineToggle=this.toggleOptionsContainer.append("input").attr("type","checkbox").on("change",()=>{this.OnBrushChange()}).attr("id",i),this.toggleOptionsContainer.append("label").attr("for",i).text("Show Outlines"),this.showOutlineToggle.node().checked=!0;const r="imageToggle-invert";this._invertImageToggle=this.toggleOptionsContainer.append("input").attr("type","checkbox").on("change",()=>{var t=document.getElementById(r);this.selectedImageContainer.classed("invert",t.checked),this.selectedImageCanvas.classed("invert",t.checked),this.invertCanvas()}).attr("id",r),this.toggleOptionsContainer.append("label").attr("for",r).text("Invert"),this._imageAndLegendContainer=this.innerContainer.append("div").classed("imageAndLegendContainer",!0),this._selectedImageContainer=this.imageAndLegendContainer.append("div").classed("noShrink",!0),this.innerContainer.append("div").attr("style","flex-grow: 2;"),this._selectedImageCanvas=this.selectedImageContainer.append("canvas"),this.selectedImageCanvas.node().addEventListener("mousemove",t=>{this.onCanvasMouseMove(t)}),this.selectedImageCanvas.node().addEventListener("click",t=>{this.onCanvasClick(t)}),this._canvasContext=this.selectedImageCanvas.node().getContext("2d"),this.selectedImageContainer.on("mouseleave",()=>{this._mousePos=null,this.hideSegmentHover()}),this._legendToggleContainer=this.imageAndLegendContainer.append("div").classed("toggleOptions",!0).classed("vertical",!0).classed("smallText",!0),this.legendToggleContainer.append("div").attr("style","flex-grow: 1;"),this._legendToggleSelected=this.legendToggleContainer.append("input").attr("type","checkbox").on("change",()=>{this.OnBrushChange()}).classed("noDisp",!0).attr("id","legendToggle-selected"),this.legendToggleContainer.append("label").attr("for","legendToggle-selected").classed("colorLegendLabel",!0).classed("red",!0).text("Selected"),this.legendToggleSelected.node().checked=!0,this._legendToggleFilteredOut=this.legendToggleContainer.append("input").attr("type","checkbox").on("change",()=>{this.OnBrushChange()}).classed("noDisp",!0).attr("id","legendToggle-filteredOut"),this.legendToggleContainer.append("label").attr("for","legendToggle-filteredOut").classed("colorLegendLabel",!0).classed("green",!0).text("Filtered Out"),this.legendToggleFilteredOut.node().checked=!0,this._legendToggleNotSelected=this.legendToggleContainer.append("input").attr("type","checkbox").on("change",()=>{this.OnBrushChange()}).classed("noDisp",!0).attr("id","legendToggle-notSelected"),this.legendToggleContainer.append("label").attr("for","legendToggle-notSelected").classed("colorLegendLabel",!0).classed("blue",!0).text("Not Selected"),this.legendToggleNotSelected.node().checked=!0,this.legendToggleContainer.append("div").attr("style","flex-grow: 1;"),this.imageTrackWidget.init(),document.addEventListener("samplingStrategyChange",t=>{this.setNumExemplars(),this.updateTracksCanvas(),document.dispatchEvent(new CustomEvent("imageSelectionRedraw"))}),document.addEventListener("launchExemplarCurve",t=>{this._exemplarAttribute=t.detail,this.imageTrackWidget.manualSampleValues=[],this.setNumExemplars();t=new CustomEvent("changeModeSelect",{detail:0});document.dispatchEvent(t);t=new CustomEvent("modeChange",{detail:{inCondensedMode:!0,inExemplarMode:!0}});document.dispatchEvent(t)}),document.addEventListener("modeChange",t=>{this._inExemplarMode=t.detail.inExemplarMode,this._inCondensedMode=t.detail.inCondensedMode,this.updateTracksCanvas(),document.dispatchEvent(new CustomEvent("imageSelectionRedraw")),document.dispatchEvent(new CustomEvent("exemplarAttributeChange",{detail:this.inExemplarMode?this.exemplarAttribute:null}))}),document.addEventListener("groupByChanged",async t=>{let e=a.select("#largePopupContainerOuter");(e.empty()||e.classed("noDisp"))&&(l.DevlibTSUtil.launchSpinner(),await l.DevlibTSUtil.makeAsync(()=>this._facetList=t.detail.flatFacetList),this._colorLookup=t.detail.colorLookup,this.updateTracksCanvas(),document.dispatchEvent(new CustomEvent("imageSelectionRedraw")))})}SetData(t,e,n,i,r=0){this._data=t,this._fullData=e,this._imageStackDataRequest=i,this._selectedImgIndex=0,this._imageLocation=n,document.dispatchEvent(new CustomEvent("exemplarAttributeChange",{detail:this.inExemplarMode?this.exemplarAttribute:null}))}SetImageBlob(t){this._imageStackBlob=t}draw(t=!1){this.drawSelectedImage(t),this.updateLocationFrameLabel()}OnBrushChange(){this.draw(!0),this.imageTrackWidget.OnBrushChange()}drawUpdate(){this.updateBackgroundPosition(this.selectedImgIndex),this.updateCanvas(this.inExemplarMode),this.updateLocationFrameLabel(),this.updateBasedOnMousePosition(!0)}drawSelectedImage(t=!1){this.setImageInlineStyle(this.selectedImgIndex),this.updateCanvas(t)}updateLocationFrameLabel(){var t=this.getCurrentLocationId();const e=this.fullData.inverseLocationMap.get(t);this.conditionLabel.text(e.join(" ")),this.locationLabel.text(t),this.frameLabel.text(this.getCurrentFrameId())}getCurrentLocationId(){return this.imageLocation.locationId}getCurrentFrameId(){return this.selectedImgIndex+1}invertCanvas(){this.imageTrackWidget.invertImageData(),this.OnBrushChange()}updateCanvas(t=!1){var e;this.imageStackDataRequest&&(this.selectedImageCanvas.attr("width",null===(e=this.imageStackDataRequest)||void 0===e?void 0:e.tileWidth).attr("height",null===(e=this.imageStackDataRequest)||void 0===e?void 0:e.tileHeight),this.showOutlineToggle.node().checked?null!==(e=this.imageStackDataRequest)&&void 0!==e&&e.getLabel(this.getCurrentLocationId(),this.selectedImgIndex,(t,e)=>{this.createOutlineImage(t,e),this.drawDefaultCanvas()}):this.clearCanvas(),this.drawPinnedCellMarkers(),this.imageLocation.locationId,t||this.updateTracksCanvas())}updateTracksCanvas(){let e,n=null;if(this.inExemplarMode){this.exemplarLocations.clear(),this.exemplarFrames.clear(),e=this.getExemplarCurves();let t=e.map(t=>t.data);for(var i of[t,this.manuallyPinnedTracks])for(var r of i){var a=r.get("Location ID");this.exemplarLocations.add(a),this.exemplarFrames.has(a)||this.exemplarFrames.set(a,new Set);let e=this.exemplarFrames.get(a);for(let t=0;t<this.condensedModeCount;t++){const s=this.imageTrackWidget.getPointInCondensedMode(r,t);var o=s.get("Frame ID");e.add(o)}}this.exemplarLocations.has(this.getCurrentLocationId())||(n=new CustomEvent("locFrameClicked",{detail:{locationId:t[0].get("Location ID"),frameId:t[0].pointList[0].get("Frame ID")}}))}else e=this.getCurvesBasedOnPointsAtCurrentFrame(),this.exemplarLocations.clear(),this.exemplarFrames.clear();this.imageTrackWidget.draw(e,this.manuallyPinnedTracks),n&&document.dispatchEvent(n)}getExemplarCurves(){let t=[];var n;for(n of this.facetList){var i,r,a=n.data.curveList,o=a.length,s=this.imageTrackWidget.currentSamplingStategy.strat;let e;if(Array.isArray(s))e=s;else{e=[];for(let t=0;t<s;t++)e.push(Math.random())}const c=[];for(i of e){var l=Math.round((o-1)*i),l=h(a,l,t=>t.get(this.exemplarAttribute));c.push({data:l,type:"auto"})}for(r of this.imageTrackWidget.manualSampleValues){var u=this.getClosestCurve(a,r,this.exemplarAttribute);c.push({data:u,type:"manual",anchorVal:r})}c.sort((t,e)=>t.data.get(this.exemplarAttribute)-e.data.get(this.exemplarAttribute)),t.push(...c)}return t}getClosestCurve(t,e,n){let i=null,r=1/0;for(var a of t){var o=Math.abs(a.get(n)-e);o<r&&(r=o,i=a)}return i}getCurvesBasedOnPointsAtCurrentFrame(){let t=[];var e;for(e of this.data.GetCellsAtFrame(this.getCurrentLocationId(),this.getCurrentFrameId()))t.push({data:e.parent,type:"auto"});return t}createOutlineImage(i,r){if(this.imageStackDataRequest){let n=this.canvasContext.createImageData(this.imageStackDataRequest.tileWidth,this.imageStackDataRequest.tileHeight);for(let e=r;e<r+this.imageStackDataRequest.tileHeight;e++){var a,o,s,l,u,c;for(a of i.rowList[e].row)for(let t=a.start;t<a.start+a.length;t++)this.isBorder(a.label,e,t,i)&&(o=(e-r)*this.imageStackDataRequest.tileWidth+t,o*=4,[l,s]=this.getCell(a.label,this.data),{color:c,show:u}=this.getCellColor(l),u&&([l,u,c]=c,n.data[o]=l,n.data[1+o]=u,n.data[2+o]=c,n.data[3+o]=255))}this._defaultCanvasState=n}}drawDefaultCanvas(){this.defaultCanvasState&&this.canvasContext.putImageData(this.defaultCanvasState,0,0)}drawPinnedCellMarkers(){for(var t of this.manuallyPinnedTracks){if(t.get("Location ID")!==this.getCurrentLocationId())break;for(var e of t.pointList)e.get("Frame ID")===this.getCurrentFrameId()&&this.drawCellCenter(e,3)}}clearCanvas(){this.canvasContext.clearRect(0,0,this.imageStackWidth,this.imageStackHeight),this._defaultCanvasState=this.canvasContext.createImageData(this.imageStackDataRequest.tileWidth,this.imageStackDataRequest.tileHeight)}isBorder(t,e,n,i){let r=[];r.push([e-1,n]),r.push([e+1,n]),r.push([e,n-1]),r.push([e,n+1]),r.push([e-1,n-1]),r.push([e+1,n-1]),r.push([e+1,n-1]),r.push([e-1,n+1]),r.push([e-2,n]),r.push([e+2,n]),r.push([e,n-2]),r.push([e,n+2]);for(var[a,o]of r)if(!(a<0||a>=i.rowList.length||o<0||o>=this.imageStackDataRequest.tileWidth))if(s.ImageStackDataRequest.getLabelValue(a,o,i)!==t)return!0;return!1}onCanvasMouseMove(t){this.imageStackDataRequest&&this.defaultCanvasState&&(this._mousePos={offset:[t.offsetX,t.offsetY],page:[t.pageX,t.pageY]},this.updateBasedOnMousePosition())}updateBasedOnMousePosition(r=!1){null!==this.mousePos?this.imageStackDataRequest.getLabel(this.getCurrentLocationId(),this.selectedImgIndex,(t,e)=>{var n=this.mousePos.offset[1]+e,i=this.mousePos.offset[0],n=s.ImageStackDataRequest.getLabelValue(n,i,t);n===this.cellHovered&&!r||(0===(this._cellHovered=n)?(this.drawDefaultCanvas(),this.drawPinnedCellMarkers(),this.tooltip.Hide(),i=new CustomEvent("frameHoverChange",{detail:{locationId:this.getCurrentLocationId(),frameId:this.getCurrentFrameId(),cellId:null}}),document.dispatchEvent(i)):this.showSegmentHover(t,n,e,r))}):this.hideSegmentHover()}onCanvasClick(i){this.imageStackDataRequest&&this.defaultCanvasState&&this.imageStackDataRequest.getLabel(this.getCurrentLocationId(),this.selectedImgIndex,(t,e)=>{var n=i.offsetY+e,e=i.offsetX,t=s.ImageStackDataRequest.getLabelValue(n,e,t),[t]=this.getCell(t,this.fullData);t&&(t=t.parent,this.togglePin(t))})}togglePin(t){var e;this.manuallyPinnedTracks.includes(t)?(e=this.manuallyPinnedTracks.indexOf(t),this.manuallyPinnedTracks.splice(e,1)):this.manuallyPinnedTracks.unshift(t),this.updateCanvas();t=new CustomEvent("manualPinToggle",{detail:this.manuallyPinnedTracks});document.dispatchEvent(t)}hideSegmentHover(t=!1){this.drawDefaultCanvas(),this.drawPinnedCellMarkers();let e;t&&(e=0),this.tooltip.Hide(e)}showSegmentHover(t,e,n,i=!1){this._cellHovered=e;let[r,a]=this.getCell(e,this.fullData);var o,s,l=0,u=0;let c=0,h=0;r?(o=this.selectedImageCanvas.node().getBoundingClientRect(),l=(r.get("X")+r.parent.get("xShift"))/this.imageStackDataRequest.scaleFactor,u=(r.get("Y")+r.parent.get("yShift"))/this.imageStackDataRequest.scaleFactor,c=o.x+l,h=o.y+u,o=new CustomEvent("frameHoverChange",{detail:{locationId:this.getCurrentLocationId(),frameId:this.getCurrentFrameId(),cellId:r.parent.id}}),document.dispatchEvent(o)):this.mousePos&&(c=this.mousePos.page[0],h=this.mousePos.page[1]);let f=this.canvasContext.createImageData(null===(o=this.imageStackDataRequest)||void 0===o?void 0:o.tileWidth,null===(o=this.imageStackDataRequest)||void 0===o?void 0:o.tileHeight);f.data.set(this.defaultCanvasState.data);for(let e=n;e<n+this.imageStackDataRequest.tileHeight;e++)for(s of t.rowList[e].row)if(s.label===this.cellHovered)for(let t=s.start;t<s.start+s.length;t++){var d=(e-n)*this.imageStackDataRequest.tileWidth+t;d*=4;var[p]=this.getCell(s.label,this.data),{color:g}=this.getCellColor(p),[m,p,g]=g;f.data[d]=m,f.data[1+d]=p,f.data[2+d]=g,f.data[3+d]=200}this.canvasContext.putImageData(f,0,0),this.drawPinnedCellMarkers(),this.drawCellCenter(r,5);e=this.getTooltipContent(e,r,a);let v;i&&(v=0),this.tooltip.Show(e,c,h,v)}drawCellCenter(t,e){var n;t&&(n=(t.get("X")+t.parent.get("xShift"))/this.imageStackDataRequest.scaleFactor,t=(t.get("Y")+t.parent.get("yShift"))/this.imageStackDataRequest.scaleFactor,this.canvasContext.beginPath(),this.canvasContext.arc(n,t,e,0,2*Math.PI),this.canvasContext.strokeStyle="black",this.canvasContext.stroke(),this.canvasContext.fillStyle="#FF00FF",this.canvasContext.fill())}getLabelIndexFromBigImgPixelXY(t,e,n){e=Math.round(e),n=Math.round(n);e%=null===(e=this.imageStackDataRequest)||void 0===e?void 0:e.tileWidth;return[n%(null===(n=this.imageStackDataRequest)||void 0===n?void 0:n.tileHeight)+t%(null===(t=this.imageStackDataRequest)||void 0===t?void 0:t.tilesPerFile)*(null===(t=this.imageStackDataRequest)||void 0===t?void 0:t.tileHeight),e]}getTileIndexFromBigImgPixelXY(t,e){t=Math.floor(t/(null===(t=this.imageStackDataRequest)||void 0===t?void 0:t.tileWidth));return Math.floor(e/(null===(e=this.imageStackDataRequest)||void 0===e?void 0:e.tileHeight))*(null===(e=this.imageStackDataRequest)||void 0===e?void 0:e.numberOfColumns)+t}getTooltipContent(t,e,n){var i;let r=[];if(null===(i=null===e||void 0===e?void 0:e.parent)||void 0===i?void 0:i.id){for(var a of["X","Y","Mass (pg)","Area","Mean Intensity"]){let t=e.get(a);void 0!==t&&r.push([a,t.toFixed(1)])}r.push(["Row",n.toString()]),r.push(["Segment",t.toString()])}else r.push(["Segment",t.toString()]),r.push(["No cell linked",null]);return o.RichTooltip.createLabelValueListContent(r)}getCell(t,e){return e.GetCellFromLabel(this.getCurrentLocationId(),this.getCurrentFrameId(),t)}getCellColor(t){let e=[0,0,0],n;return n=t?t.inBrush?(e=[178,34,34],this.legendToggleSelected.node().checked):(e=[70,130,180],this.legendToggleNotSelected.node().checked):(e=[119,140,77],this.legendToggleFilteredOut.node().checked),{color:e,show:n}}changeSelectedImage(t){this._selectedImgIndex=t,this.drawUpdate()}setImageInlineStyle(t,a=!0){var e;null!==(e=this.imageStackDataRequest)&&void 0!==e&&e.getImage(this.getCurrentLocationId(),t,(t,e,n,i)=>{let r=`
					background-position-x: ${-e}px;
					background-position-y: ${-t}px;
					width: ${null===(t=this.imageStackDataRequest)||void 0===t?void 0:t.tileWidth}px;
					height: ${null===(t=this.imageStackDataRequest)||void 0===t?void 0:t.tileHeight}px;
					`;i&&(r+=`background-image: url(${i});`),a&&(r+="background-color: #ebebeb;"),this.selectedImageContainer.attr("style",r)})}updateBackgroundPosition(t){this.setImageInlineStyle(t)}OnResize(t,e,n){this._maxHeight=t,this.container.setAttribute("style",`max-height: ${this.maxHeight}px;`),this.imageTrackWidget.OnResize(n,e)}}},{"../Components/RichTooltip":94,"../DataModel/ImageStackDataRequest":110,"../devlib/DevlibTSUtil":116,"./ImageTrackWidget":90,d3:42,"quickselect.js":80}],90:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const T=t("d3"),s=t("number-to-words"),C=t("../devlib/DevlibMath"),u=t("../devlib/DevlibAlgo"),b=t("../DataModel/ImageStackDataRequest"),D=t("../devlib/DevlibTSUtil"),h=t("../DataModel/CurveList"),l=t("./HistogramWidget"),c=t("./OptionSelect"),d=t("./GroupByWidget");class A{constructor(t,e,n){this._container=t,this._parentWidget=e,this._verticalPad=16,this._horizontalPad=8,this._trackToPlotPadding=48,this._exemplarMinWidth=80,this._minHeightForFavorites=120+2*this.verticalPad,this._frameLabelPositions=[],this._cellLabelPositions=[],this._exemplarYKey="Mass_norm",this._samplingStratOptions=n,this._smoothCurves=!0,this._draggingPin=!1,this._cellTimelineMargin={top:36,right:4,bottom:4,left:124},this._latestScroll=[0,0],this._scrollChangeTicking=!1,this._sourceDestCell=[],this._histogramScaleYList=[]}get container(){return this._container}get parentWidget(){return this._parentWidget}get innerContainer(){return this._innerContainer}get innerContainerW(){return this._innerContainerW}get innerContainerH(){return this._innerContainerH}get titleContainer(){return this._titleContainer}get samplingStrategySelect(){return this._samplingStrategySelect}get samplingStratOptions(){return this._samplingStratOptions}get currentSamplingStategy(){return this._currentSamplingStategy}get manualSampleValues(){return this._manualSampleValues}set manualSampleValues(t){this._manualSampleValues=t}get svgContainer(){return this._svgContainer}get cellLabelGroup(){return this._cellLabelGroup}get labelLinePad(){return this._labelLinePad}get scentedWidgetGroup(){return this._scentedWidgetGroup}get exemplarPinGroup(){return this._exemplarPinGroup}get addPinRectGroup(){return this._addPinRectGroup}get manualExemplarPinGroup(){return this._manualExemplarPinGroup}get frameLabelGroup(){return this._frameLabelGroup}get exemplarCurvesGroup(){return this._exemplarCurvesGroup}get shameRectangle(){return this._shameRectangle}get selectedImageCanvas(){return this._selectedImageCanvas}get canvasContext(){return this._canvasContext}get defaultCanvasState(){return this._defaultCanvasState}get trackList(){return this._trackList}get manuallyPinnedTracks(){return this._manuallyPinnedTracks}get minHeightForFavorites(){return this._minHeightForFavorites}get verticalPad(){return this._verticalPad}get horizontalPad(){return this._horizontalPad}get trackToPlotPadding(){return this._trackToPlotPadding}get frameLabelPositions(){return this._frameLabelPositions}get cellLabelPositions(){return this._cellLabelPositions}get conditionLabelPositions(){return this._conditionLabelPositions}get histogramScaleX(){return this._histogramScaleX}get histogramScaleYList(){return this._histogramScaleYList}get normalizedHistogramScaleY(){return this._normalizedHistogramScaleY}get cellTimelineMargin(){return this._cellTimelineMargin}get scrollChangeTicking(){return this._scrollChangeTicking}get latestScroll(){return this._latestScroll}get latestMouseCanvasOffset(){return this._latestMouseCanvasOffset}get sourceDestCell(){return this._sourceDestCell}get exemplarScaleX(){return this._exemplarScaleX}get exemplarScaleY(){return this._exemplarScaleY}get exemplarMinWidth(){return this._exemplarMinWidth}get exemplarYKey(){return this._exemplarYKey}get smoothCurves(){return this._smoothCurves}get draggingPin(){return this._draggingPin}get draggingPinElement(){return this._draggingPinElement}get needleSelection(){return this._needleSelection}get textSelection(){return this._textSelection}get initialDragCoords(){return this._initialDragCoords}get totalDragOffset(){return this._totalDragOffset}get initialPinValue(){return this._initialPinValue}get anchorPinValue(){return this._anchorPinValue}get pinMoved(){return this._pinMoved}get dragGroupIndex(){return this._dragGroupIndex}get trackHeightList(){return this._trackHeightList}get trackVerticalOffsetList(){return this._trackVerticalOffsetList}init(){const t=T.select(this.container),e=t.append("div").classed("trackModeTitleContainer",!0).classed("mediumText",!0);this._titleContainer=e.append("span");e.append("span").attr("id","exemplarSamplingStratSelection");this._samplingStrategySelect=new c.OptionSelect("exemplarSamplingStratSelection","Sampled at");let i=[];this._currentSamplingStategy=this.samplingStratOptions[0],this._manualSampleValues=[];for(let n of this.samplingStratOptions){let e;if(n.label)e=n.label;else if(Array.isArray(n.strat)){let t=n.strat.map(t=>t);n.strat.length<8&&(t=t.map(t=>0==t?"Min":.5==t?"Median":1==t?"Max":s.toOrdinal(100*t)+" percentile")),e=t.join(", ")}else e=`${n.strat} random track`,1<n.strat&&(e+="s");var r={displayName:e,callback:()=>{this._currentSamplingStategy=n,document.dispatchEvent(new CustomEvent("samplingStrategyChange",{detail:n}))}};i.push(r)}this.samplingStrategySelect.onDataChange(i),this._svgContainer=t.append("svg"),this._labelLinePad=16,this._scentedWidgetGroup=this.svgContainer.append("g").attr("transform",t=>`translate(0, ${this.cellTimelineMargin.top})`),this._exemplarPinGroup=this.svgContainer.append("g").attr("transform",t=>`translate(0, ${this.cellTimelineMargin.top})`),this._addPinRectGroup=this.svgContainer.append("g").attr("transform",t=>`translate(0, ${this.cellTimelineMargin.top})`),this._manualExemplarPinGroup=this.svgContainer.append("g").attr("transform",t=>`translate(0, ${this.cellTimelineMargin.top})`),this._cellLabelGroup=this.svgContainer.append("g").attr("transform",t=>`translate(0, ${this.cellTimelineMargin.top})`);const n=this.cellTimelineMargin.left;this._exemplarCurvesGroup=this.svgContainer.append("g").attr("transform",t=>`translate(${n}, ${this.cellTimelineMargin.top})`),this._shameRectangle=this.svgContainer.append("rect").attr("x",0).attr("y",0).attr("width",1e4).attr("height",this.cellTimelineMargin.top).attr("fill","white").attr("stroke-width",0),this._frameLabelGroup=this.svgContainer.append("g").attr("transform",t=>`translate(${this.cellTimelineMargin.left}, 0)`),this._innerContainer=t.append("div").classed("cellTimelineInnerContainer",!0).classed("overflow-scroll",!0),this.innerContainer.node().addEventListener("scroll",t=>{this.onCellTimelineScroll(t)}),this._selectedImageCanvas=this.innerContainer.append("canvas");const a=this.selectedImageCanvas.node();a.addEventListener("mousemove",t=>this.onCanvasMouseMove(t)),a.addEventListener("click",t=>this.onCanvasClick(t)),this.selectedImageCanvas.on("mouseleave",()=>this.onCanvasMouseLeave()),this._canvasContext=a.getContext("2d"),document.addEventListener("frameHoverChange",n=>{const i=n.detail.frameId;var r=n.detail.cellId,t=n.detail.rowIndex;if(null!==i&&null!==r){let e;if(this.parentWidget.inCondensedMode){let t=this.parentWidget.fullData.curveLookup.get(r);var a=t.pointList.findIndex(t=>t.get("Frame ID")===i),o=t.pointList.length-1,s=a/o;e=s*(this.parentWidget.condensedModeCount-1);n=Math.round(e),a=n/(this.parentWidget.condensedModeCount-1),o=1/o;e=Math.abs(s-a)<o?n:-1}else e=i-1;this.updateLabelsOnMouseMove(r,e,t)}else this.updateLabelsOnMouseMove("",-1,-1)}),document.addEventListener("averageCurveKeyChange",t=>{this._exemplarYKey=t.detail.yKey,this.drawExemplarGrowthCurves()}),document.addEventListener("smoothCurveChange",t=>{this._smoothCurves=t.detail,this.drawExemplarGrowthCurves()}),document.addEventListener("manualPinToggle",t=>{this.drawExemplarGrowthCurves()});const o=this;document.addEventListener("mousemove",function(t){o.onDrag(t.movementX,t.movementY)}),document.addEventListener("mouseup",function(t){o.onDragEnd()}),document.addEventListener("locFrameClicked",t=>{t=t.detail.frameId;this.updateCurrentFrameIndicator(t)})}async draw(t,e){this.canvasContext.clearRect(0,0,this.canvasContext.canvas.width,this.canvasContext.canvas.height),this.parentWidget.imageStackDataRequest&&t!==this.trackList&&(D.DevlibTSUtil.launchSpinner(),this._trackList=t,this._manuallyPinnedTracks=e,this.updateTitle(),await this.drawTrackList(),this.drawLabels(),this.drawAllPins(t),this.drawExemplarGrowthCurves())}updateTitle(){this.parentWidget.inExemplarMode?this.titleContainer.text("Exemplars of "+this.parentWidget.exemplarAttribute+" - "):this.titleContainer.text("Frame Extraction Mode")}OnBrushChange(){this.drawOutlines()}async drawTrackList(){var t=this.trackList.map(t=>t.data),e=[...this.manuallyPinnedTracks,...t];this._sourceDestCell=[];var n=await this.getBoundingBoxLists(e);this._trackHeightList=[];var i,r=T.max(n,t=>T.max(t,t=>A.rectWidth(t)));for(i of n){var a=T.max(i,t=>A.rectHeight(t));this.trackHeightList.push(a)}var o=T.min(e,t=>T.min(t.pointList,t=>t.get("Frame ID"))),s=T.max(e,t=>T.max(t.pointList,t=>t.get("Frame ID")));let l;l=this.parentWidget.inCondensedMode?this.parentWidget.condensedModeCount:s-o+1;var u=this.getMaxGroupHeight(this.trackHeightList),c=this.parentWidget.numExemplars,h=l*r+this.horizontalPad*(l+1);let f=this.verticalPad*(e.length+1);f+=200;t=T.sum(this.trackHeightList.slice(0,this.manuallyPinnedTracks.length));this.parentWidget.inExemplarMode?(s=this.trackList.length/c,f+=u*s,f+=16*s,f+=t):f+=T.sum(this.trackHeightList),this.selectedImageCanvas.attr("width",h).attr("height",f);let d=this.verticalPad;this._cellLabelPositions=[];let p=[];this._trackVerticalOffsetList=[];var g=this.manuallyPinnedTracks.length;for(let t=0;t<e.length;t++){var m=t<g,v=t-g,y=e[t],b=n[t],_=this.trackHeightList[t];this.parentWidget.inExemplarMode&&t===this.manuallyPinnedTracks.length&&0<this.manuallyPinnedTracks.length&&(d=Math.max(d,this.minHeightForFavorites)),this.trackVerticalOffsetList.push(d);var x=Math.floor(v/c),x=this.drawTrack(y,b,r,_,o,d,x,m);p.push(x),this.cellLabelPositions.push([y.id,d+_/2]),d+=_+this.verticalPad,this.parentWidget.inExemplarMode&&!m&&(v=v-v%c+g,v=u-T.sum(this.trackHeightList.slice(v,v+c)),t%c<c?d+=v/(c-1):d+=16)}if(this.parentWidget.inExemplarMode){this._conditionLabelPositions=[];var w=this.getConditionNames();for(let t=0;t<this.trackList.length;t+=c){var C=t+g,S=w[t/c],M=this.trackVerticalOffsetList[C],C=C+c-1,C=this.trackVerticalOffsetList[C]+this.trackHeightList[C];this.conditionLabelPositions.push([S,[M,C]])}}this._frameLabelPositions=[];for(let t=0;t<l;t++){var k=(t+o).toString(),L=this.horizontalPad;L+=t*(r+this.horizontalPad),L+=r/2,this._frameLabelPositions.push([k,L])}await Promise.allSettled(p),this._defaultCanvasState=this.canvasContext.getImageData(0,0,h,f),await this.drawOutlines(!1),D.DevlibTSUtil.stopSpinner()}invertImageData(){var t,e,n,i=this.defaultCanvasState.width;this.defaultCanvasState.height;let r=this.defaultCanvasState.data;for([t,e,n]of this.sourceDestCell){var a=A.rectWidth(t),o=A.rectHeight(t);for(let t=0;t<a;t++){var s=t+e[0];for(let t=0;t<o;t++){var l=4*((t+e[1])*i+s);r[l]=255-r[l],r[1+l]=255-r[1+l],r[2+l]=255-r[2+l]}}}}getMaxGroupHeight(e){if(!this.parentWidget.inExemplarMode)return 0;let n=0;for(let t=this.manuallyPinnedTracks.length;t<e.length;t+=this.parentWidget.numExemplars){var i=T.sum(e.slice(t,t+this.parentWidget.numExemplars));n=Math.max(n,i)}return n}getConditionNames(){return this.parentWidget.facetList.map(t=>t.name.join("___"))}async getBoundingBoxLists(t){const e=[],n=[];for(var i of t)if(this.parentWidget.inCondensedMode){var r=Math.min(i.length,this.parentWidget.condensedModeCount);for(let t=0;t<r;t++){var a=this.getPointInCondensedMode(i,t),a=this.getCellBoundingBox(a);n.push(a)}e.push(r)}else{for(var o of i.pointList){o=this.getCellBoundingBox(o);n.push(o)}e.push(i.pointList.length)}const s=await Promise.all(n);let l=[],u=0;for(var c of e)l.push(s.slice(u,u+c)),u+=c;return l}getPointInCondensedMode(t,e){if(1===t.pointList.length)return t.pointList[0];var n=Math.min(this.parentWidget.condensedModeCount,t.pointList.length),n=Math.min(Math.floor(e/(n-1)*t.pointList.length),t.pointList.length-1);return t.pointList[n]}async drawTrack(c,i,h,f,d,p,t,e){this.drawTrackBackgroundAndTimeRange(c,h,f,d,p,t,e);let n=[],g=[];for(let e=0;e<i.length;e++){let t;t=this.parentWidget.inCondensedMode?this.getPointInCondensedMode(c,e):c.pointList[e];var r=t.get("Frame ID")-1,r=this.parentWidget.imageStackDataRequest.getImagePromise(c.get("Location ID"),r);n.push(r)}var a=await Promise.all(n);let o=[],m=new Worker("/static/script/dist/ImageWorker.js");for(let n=0;n<a.length;n++){var[s,l,u]=a[n],v=i[n],[y,b]=v[0],_=A.rectWidth(v),x=A.rectHeight(v),w=Math.round((h-_)/2),v=Math.round((f-x)/2);let t;t=this.parentWidget.inCondensedMode?this.getPointInCondensedMode(c,n):c.pointList[n];_=t.get("Frame ID");let e;if(this.parentWidget.inCondensedMode)if(a.length===this.parentWidget.condensedModeCount)e=n;else{let t;t=1===a.length?.5:n/(a.length-1),e=t*(this.parentWidget.condensedModeCount-1)}else e=_-d;_=s+(null===(x=this.parentWidget.imageStackDataRequest)||void 0===x?void 0:x.tileHeight),x=l+(null===(x=this.parentWidget.imageStackDataRequest)||void 0===x?void 0:x.tileWidth),s=C.DevlibMath.clamp(b-v,[s,_]),w=C.DevlibMath.clamp(y-w,[l,x]),l=Math.min(h,x-w),x=Math.min(f,_-s),_=[Math.round(this.horizontalPad+e*(h+this.horizontalPad)+(h-l)/2),Math.round(p+(f-x)/2)];g.push(_),this.sourceDestCell.push([[[w,s],[w+l,s+x]],_,t]),o.push([u,w,s,l,x])}return m.postMessage(o),new Promise((e,t)=>{m.onmessage=t=>{var i=t.data;for(let n=0;n<i.length;n++){var r=i[n];let t;t=this.parentWidget.inCondensedMode?this.getPointInCondensedMode(c,n):c.pointList[n];var a=t.get("Frame ID"),o=a===this.parentWidget.getCurrentFrameId();let e=a-d;if(this.parentWidget.inCondensedMode)if(i.length===this.parentWidget.condensedModeCount)e=n;else{let t;t=1===i.length?.5:n/(i.length-1),e=t*(this.parentWidget.condensedModeCount-1)}else e=a-d;var s=this.horizontalPad+e*(h+this.horizontalPad),l=p,[u,a]=g[n];this.canvasContext.beginPath(),this.canvasContext.rect(s,l,h,f),o&&!this.parentWidget.inExemplarMode?(this.canvasContext.strokeStyle="MediumSeaGreen",this.canvasContext.lineWidth=8):(this.canvasContext.strokeStyle="grey",this.canvasContext.lineWidth=1),this.canvasContext.fillStyle="black",this.canvasContext.stroke(),this.canvasContext.fill(),this.canvasContext.closePath(),"fulfilled"===r.status&&(this.parentWidget.invertImageToggle.node().checked&&(this.canvasContext.filter="invert(1)"),this.canvasContext.drawImage(r.value,u,a),this.canvasContext.filter="")}e(),m.terminate()}})}drawTrackBackgroundAndTimeRange(t,e,n,i,r,a,o){let s;s=this.parentWidget.inCondensedMode?0:t.pointList[0].get("Frame ID")-i;var l,u=this.horizontalPad+s*(e+this.horizontalPad);s=this.parentWidget.inCondensedMode?this.parentWidget.condensedModeCount:(l=t.pointList.length-1,t.pointList[l].get("Frame ID")-i+1);i=s*(e+this.horizontalPad),e=r;this.canvasContext.beginPath();this.canvasContext.rect(u-4,e-4,i-u+1+8,n+8);let c;c=o?"rgb(180,180,180)":"rgb(240,240,240)",this.canvasContext.strokeStyle=c,this.canvasContext.fillStyle=c,this.canvasContext.stroke(),this.canvasContext.fill(),this.canvasContext.closePath();this.drawTimeRange(t,[u,i],6,r-4-6,a)}drawTimeRange(n,i,r,a,t){if(this.parentWidget.inCondensedMode){var o=this.parentWidget.fullData.getMinMax("Frame ID");let e=T.scaleLinear().domain(o).range(i),t=T.extent(n.pointList,t=>t.get("Frame ID"));var s=t.map(t=>e(t)),l=.5*r,o=r-l;this.canvasContext.beginPath(),this.canvasContext.rect(i[0],a+o/2,i[1]-i[0]+1,l),this.canvasContext.fillStyle="grey",this.canvasContext.fill(),this.canvasContext.closePath(),this.canvasContext.beginPath(),this.canvasContext.rect(s[0],a,s[1]-s[0]+1,r);n=n.get("Location ID"),n=this.parentWidget.fullData.inverseLocationMap.get(n),n=d.GroupByWidget.getColor(n,this.parentWidget.colorLookup);this.canvasContext.strokeStyle=n,this.canvasContext.fillStyle=n,this.canvasContext.stroke(),this.canvasContext.fill(),this.canvasContext.closePath()}}static rectWidth(t){return t[1][0]-t[0][0]+1}static rectHeight(t){return t[1][1]-t[0][1]+1}async getCellBoundingBox(t){var e=t.parent.get("Location ID"),n=t.get("Frame ID")-1,i=t.get("segmentLabel");this.parentWidget.numPixelsInTile;let r=[[1/0,1/0],[-1/0,-1/0]];var a,[o,s]=await this.parentWidget.imageStackDataRequest.getLabelPromise(e,n);for(let t=s;t<s+this.parentWidget.imageStackDataRequest.tileHeight;t++)for(a of o.rowList[t].row){var l,u,[c,h]=this.parentWidget.imageStackDataRequest.getTileTopLeft(n),f=h+a.start,d=h+a.start+a.length,p=c+t%this.parentWidget.imageStackDataRequest.tileHeight;a.label===i&&([[l,u],[h,c]]=r,l=Math.min(l,f),u=Math.min(u,p),h=Math.max(h,d),c=Math.max(c,p),r=[[l,u],[h,c]])}return r}onCellTimelineScroll(t){var e=this.innerContainer.node();this._latestScroll=[e.scrollLeft,e.scrollTop],this.scrollChangeTicking||(window.requestAnimationFrame(()=>{this.drawLabels(!0),this._scrollChangeTicking=!1}),this._scrollChangeTicking=!0)}onCanvasClick(t){if(this.parentWidget.imageStackDataRequest){var r=t.offsetX,t=t.offsetY,[t]=A.getClosestLabel(this.cellLabelPositions,t);let e=this.parentWidget.fullData.curveLookup.get(t),n;var[t]=A.getClosestLabel(this.frameLabelPositions,r);let i=+t-1;if(this.parentWidget.inCondensedMode){e.pointList.length<this.parentWidget.condensedModeCount&&(a=r/Number(this.selectedImageCanvas.attr("width")),i=Math.floor(a*e.pointList.length),i=Math.min(i,e.pointList.length-1));let t=this.getPointInCondensedMode(e,i);n=t.get("Frame ID")}else n=i+1;var a=e.get("Location ID"),a=new CustomEvent("locFrameClicked",{detail:{locationId:a,frameId:n}});document.dispatchEvent(a)}}onCanvasMouseMove(t){if(this.parentWidget.imageStackDataRequest){var r=t.offsetX,a=t.offsetY,[o,t]=A.getClosestLabel(this.cellLabelPositions,a);let e=this.parentWidget.fullData.curveLookup.get(o),n;var[a]=A.getClosestLabel(this.frameLabelPositions,r);let i=+a-1;if(this.parentWidget.inCondensedMode){e.pointList.length<this.parentWidget.condensedModeCount&&(s=r/Number(this.selectedImageCanvas.attr("width")),i=Math.floor(s*e.pointList.length),i=Math.min(i,e.pointList.length-1));let t=this.getPointInCondensedMode(e,i);n=t.get("Frame ID")}else n=i+1;this.parentWidget.selectedImgIndex;const l=this.parentWidget.getCurrentFrameId();var s=e.get("Location ID");if(s==this.parentWidget.getCurrentLocationId()){let n=e.pointList.find(t=>t.get("Frame ID")===l);n?this.parentWidget.imageStackDataRequest.getLabel(e.get("Location ID"),n.get("Frame ID")-1,(t,e)=>{this.parentWidget.showSegmentHover(t,n.get("segmentLabel"),e,!0)}):this.parentWidget.hideSegmentHover(!0)}else this.parentWidget.hideSegmentHover(!0);this.updateLabelsOnMouseMove(o,i,t);t=new CustomEvent("frameHoverChange",{detail:{locationId:s,frameId:n,cellId:o,rowIndex:t}});document.dispatchEvent(t)}}onCanvasMouseLeave(){this.parentWidget.hideSegmentHover(!0),this.updateLabelsOnMouseMove("",-1,-1);var t=this.parentWidget.getCurrentLocationId(),t=new CustomEvent("frameHoverChange",{detail:{locationId:t,frameId:null,cellId:null}});document.dispatchEvent(t)}static getClosestLabel(t,e){var n,i,r,a,o=u.DevlibAlgo.compareProperty(e,t=>t[1]),s=u.DevlibAlgo.BinarySearchIndex(t,o);if(void 0===s)return console.log(e),["-1",-1];let l;return l="number"==typeof s?s:([n,i]=s,void 0===n?i:void 0===i?n:([r,o]=t[n],[a,s]=t[i],e-o<s-e?n:i)),[t[l][0],l]}async drawOutlines(t=!0){if(this.defaultCanvasState&&(t&&this.canvasContext.putImageData(this.defaultCanvasState,0,0),this.parentWidget.showOutlineToggle.node().checked))for(var[r,[e,a],o]of this.sourceDestCell){var s=A.rectWidth(r),l=A.rectHeight(r),[[u,r],[c,h]]=r;let n=this.canvasContext.getImageData(e,a,s,l);var f=o.get("segmentLabel"),d=o.get("Frame ID")-1;let i=0;var[p]=await this.parentWidget.imageStackDataRequest.getLabelPromise(o.parent.get("Location ID"),d);for(let e=r;e<=h;e++)for(let t=u;t<=c;t++){var g,[m,v]=this.parentWidget.getLabelIndexFromBigImgPixelXY(d,t,e),y=b.ImageStackDataRequest.getLabelValue(m,v,p);y==f&&this.parentWidget.isBorder(y,m,v,p)&&([y,g]=this.parentWidget.data.GetCellFromLabel(o.parent.get("Location ID"),o.get("Frame ID"),f),{color:m,show:v}=this.parentWidget.getCellColor(y),v&&([y,v,m]=m,n.data[i]=y,n.data[i+1]=v,n.data[i+2]=m,n.data[i+3]=255)),i+=4}this.canvasContext.putImageData(n,e,a)}}drawLabels(t=!1){this.parentWidget.inExemplarMode?(D.DevlibTSUtil.show(this.scentedWidgetGroup.node()),D.DevlibTSUtil.show(this.exemplarPinGroup.node()),D.DevlibTSUtil.show(this.manualExemplarPinGroup.node()),D.DevlibTSUtil.show(this.addPinRectGroup.node()),e=this.drawConditionLabels(),t?this.shiftScentedWidgets():(this.drawScentedWidgets(e),this.drawAddPinRects(e))):(D.DevlibTSUtil.hide(this.scentedWidgetGroup.node()),D.DevlibTSUtil.hide(this.exemplarPinGroup.node()),D.DevlibTSUtil.hide(this.manualExemplarPinGroup.node()),D.DevlibTSUtil.hide(this.addPinRectGroup.node())),this.drawCellLabels();var e=this.cellTimelineMargin.top-6;let n=this.frameLabelPositions.filter(t=>{t=t[1]-this.latestScroll[0];return 0<=t&&t<=this.innerContainerW});this.parentWidget.inCondensedMode&&(n=n.map(t=>{let e=(+t[0]-1)/(this.parentWidget.condensedModeCount-1);return[e.toFixed(2),t[1]]}));const i=this.parentWidget.getCurrentFrameId();this.frameLabelGroup.selectAll("text").data(n).join("text").text(t=>t[0]).attr("x",t=>t[1]-this.latestScroll[0]).attr("y",e).classed("currentFrame",t=>+t[0]===i&&!this.parentWidget.inExemplarMode).classed("cellAxisLabel",!0).classed("right",!0)}drawCellLabels(){const e=this.cellTimelineMargin.left-10;let t=this.cellLabelPositions.map((t,e)=>[e,t]);var n=t.filter((t,e)=>{if(e>=this.manuallyPinnedTracks.length&&this.parentWidget.inExemplarMode)return!1;t=t[1][1]-this.latestScroll[1];return 0<=t&&t<=this.innerContainerH});this.cellLabelGroup.selectAll("text.trackLabel").data(n).join("text").classed("trackLabel",!0).text(t=>t[1][0]).attr("x",t=>t[0]<this.manuallyPinnedTracks.length?e-32:e).attr("y",t=>t[1][1]-this.latestScroll[1]).attr("transform","").attr("fill",t=>{if(t[0]<this.manuallyPinnedTracks.length){const e=this.manuallyPinnedTracks[t[0]];t=e.get("Location ID"),t=this.parentWidget.fullData.inverseLocationMap.get(t);return d.GroupByWidget.getColor(t,this.parentWidget.colorLookup)}return"black"}).classed("cellAxisLabel",!0).classed("left",!0).classed("rotated",!1);n=t.filter((t,e)=>{if(e<this.manuallyPinnedTracks.length){t=t[1][1]-this.latestScroll[1];return 0<=t&&t<=this.innerContainerH}return!1});this.cellLabelGroup.selectAll("foreignObject").data(n).join("foreignObject").attr("transform",t=>{return`translate(${e-32}, ${t[1][1]-this.latestScroll[1]-16-2})`}).attr("width",32).attr("height",32).selectAll("div").data(t=>[t]).join("xhtml:div").selectAll("button").data(t=>[t]).join("button").attr("style",t=>{if(t[0]<this.manuallyPinnedTracks.length){const e=this.manuallyPinnedTracks[t[0]];t=e.get("Location ID"),t=this.parentWidget.fullData.inverseLocationMap.get(t);return`color: ${d.GroupByWidget.getColor(t,this.parentWidget.colorLookup)};`}}).attr("title","Click to remove this favorite.").html('<i class="fas fa-star"></i>').classed("basicIconButton",!0).on("click",t=>{t=this.parentWidget.fullData.curveLookup.get(t[1][0]);this.parentWidget.togglePin(t)}),this.parentWidget.inExemplarMode||(this.cellLabelGroup.selectAll("line").remove(),this.cellLabelGroup.selectAll("text.conditionLabel").remove())}drawConditionLabels(){const e=this.cellTimelineMargin.left-this.labelLinePad;var t=e-4;return this.cellLabelGroup.selectAll("text.conditionLabel").data(this.conditionLabelPositions).join("text").classed("conditionLabel",!0).text(t=>t[0].replace("___"," ")).attr("x",e).attr("y",t=>(t[1][0]+t[1][1])/2-this.latestScroll[1]).attr("transform",t=>`rotate(-90, ${e}, ${(t[1][0]+t[1][1])/2-this.latestScroll[1]})`).attr("fill",(t,e)=>d.GroupByWidget.getColor(t[0].split("___"),this.parentWidget.colorLookup)).classed("cellAxisLabel",!0).classed("rotated",!0),this.cellLabelGroup.selectAll("line").data(this.conditionLabelPositions).join("line").attr("x1",t).attr("x2",t).attr("y1",t=>Math.max(0,t[1][0]-this.latestScroll[1])).attr("y2",t=>Math.max(0,t[1][1]-this.latestScroll[1])).attr("stroke",(t,e)=>d.GroupByWidget.getColor(t[0].split("___"),this.parentWidget.colorLookup)).attr("stroke-width","2px"),t}shiftScentedWidgets(){this.scentedWidgetGroup.attr("transform",t=>`translate(0, ${this.cellTimelineMargin.top-this.latestScroll[1]})`),this.exemplarPinGroup.attr("transform",t=>`translate(0, ${this.cellTimelineMargin.top-this.latestScroll[1]})`),this.manualExemplarPinGroup.attr("transform",t=>`translate(0, ${this.cellTimelineMargin.top-this.latestScroll[1]})`),this.addPinRectGroup.attr("transform",t=>`translate(0, ${this.cellTimelineMargin.top-this.latestScroll[1]})`),this.updateExemplarCurvesOffset()}drawAddPinRects(t){const n=this;this.addPinRectGroup.selectAll("rect").data(this.conditionLabelPositions).join("rect").attr("x",0).attr("y",0).attr("transform",t=>`translate(0, ${t[1][0]})`).attr("width",this.cellTimelineMargin.left-this.labelLinePad).attr("height",t=>t[1][1]-t[1][0]).attr("stroke-width","0px").attr("fill","tomato").attr("opacity",0).attr("style","cursor: crosshair;").on("click",function(t){var[,e]=T.mouse(this),e=n.normalizedHistogramScaleY.invert(e);n.manualSampleValues.push(e),document.dispatchEvent(new CustomEvent("samplingStrategyChange",{detail:n.currentSamplingStategy}))})}drawScentedWidgets(t){let i=[];this._histogramScaleYList=[];for(let e=0;e<this.parentWidget.facetList.length;e++){let t=this.parentWidget.facetList[e].data;var n=l.HistogramWidget.calculateBins(t.curveCollection.Array.filter(t=>!isNaN(t.get(this.parentWidget.exemplarAttribute))),this.parentWidget.exemplarAttribute,t.curveCollection,48,!0);i.push(n)}var e=T.min(i,t=>t[0].x0),r=T.max(i,t=>t[t.length-1].x1);for(let t=0;t<i.length;t++){var a=this.conditionLabelPositions[t][1],a=T.scaleLinear().domain([e,r]).range(a);this.histogramScaleYList.push(a)}var o=this.conditionLabelPositions[0][1];this._normalizedHistogramScaleY=T.scaleLinear().domain([e,r]).range([0,o[1]-o[0]]);o=T.max(i,t=>T.max(t,t=>t.length)/T.sum(t,t=>t.length));this._histogramScaleX=T.scaleLinear().domain([0,o]).range([t-4,t-52]),this.scentedWidgetGroup.selectAll("path").data(this.conditionLabelPositions).join("path").attr("d",(t,e)=>{var n=i[e];return this.getHistogramSkylinePath(n,this.histogramScaleX,this.histogramScaleYList[e])}).classed("kdePath",!0)}getHistogramSkylinePath(t,e,n){let i=[];var r,a=T.sum(t,t=>t.length);for(r of t){var o=n(r.x0),s=e(r.length/a);i.push([s,o]),0===r.length&&i.push([null,null]);o=n(r.x1);i.push([s,o])}var l=t[0].x0,t=t[t.length-1].x1;i.unshift([e.range()[0],n(l)]),i.push([e.range()[0],n(t)]);let u=T.line().x(t=>t[0]).y(t=>t[1]).defined(t=>null!==t[0]);return u(i)}clearPins(){this.exemplarPinGroup.html(null),this.manualExemplarPinGroup.html(null)}drawAllPins(e){this.clearPins();for(let t=0;t<e.length;t++){var n=Math.floor(t/this.parentWidget.numExemplars);this.drawPin(e[t],t+this.manuallyPinnedTracks.length,n)}}drawPin(e,t,n){let i=e.data.get(this.parentWidget.exemplarAttribute);var r=this.histogramScaleYList[n](i),[a,o]=this.histogramScaleX.range();let s;if("manual"===e.type){s=this.manualExemplarPinGroup;const l=this.manualExemplarPinGroup.append("line").attr("x1",o).attr("x2",a).attr("y1",r).attr("y2",r).classed("pinLine",!0).classed(e.data.id,!0);const u=this,c=o-17,h=r-8;this.manualExemplarPinGroup.append("path").classed("pinHead",!0).attr("transform",`translate(${c}, ${h})`).attr("d","M17.2,0.3c-2,0.4-2.7,1-3,1.5c-0.7,1.1,0,2.6-0.8,3c-0.1,0-0.1,0-0.2,0c-1,0-1.4,0-4,0c-2.9,0-4,0-5,0c-0.7,0-0.8-1-1-1.5C2.9,2.6,3,2.3,2.7,2C1.8,1.4,0.3,1.8,0.3,1.8s0-0.8,0,6.5c0,7.2,0,6.5,0,6.5s1.5,0.4,2.4-0.2C3,14.3,2.9,14,3.3,13.3c0.2-0.6,0.3-1.5,1-1.5c1,0,2.1,0,5,0c2.6,0,3,0,4,0s0.1,1.8,1,3c0.7,0.9,2.1,1.3,3,1.5c0-2.7,0-5.3,0-8S17.2,3,17.2,0.3z").on("mousedown",function(t){u.onDragStart(this,c,h,l,f,i,e.anchorVal,n)}).classed(e.data.id,!0);const f=this.exemplarPinGroup.append("text").attr("x",4).attr("y",r).attr("alignment-baseline","middle").classed("pinLabel",!0).classed("tinyText",!0).classed("noSelect",!0).text(this.formatPinLabel(i)).classed(e.data.id,!0)}else{s=this.exemplarPinGroup,this.exemplarPinGroup.append("line").attr("x1",o).attr("x2",a).attr("y1",r).attr("y2",r).classed("pinLine",!0).classed(e.data.id,!0);this.exemplarPinGroup.append("circle").attr("cx",o-3).attr("cy",r).attr("r",3).classed("pinHead",!0).classed(e.data.id,!0)}t=this.trackVerticalOffsetList[t]+this.trackHeightList[t]/2;s.append("line").attr("x1",a).attr("x2",a+30).attr("y1",r).attr("y2",t).classed("pinConnectLine",!0).classed(e.data.id,!0)}formatPinLabel(t){var e=Math.abs(t);return 99.5<e?Math.round(t).toString():9.5<e?t.toFixed(1):t.toFixed(2)}onDragStart(t,e,n,i,r,a,o,s){T.mouse(t);this._draggingPin=!0,this._draggingPinElement=t,this._initialDragCoords=[e,n],this._needleSelection=i,this._textSelection=r,this._totalDragOffset=[0,0],this._initialPinValue=a,this._anchorPinValue=o,this._dragGroupIndex=s,this._pinMoved=!1;T.select(t).attr("transform",`translate(${e-12}, ${n})`).classed("grabbed",!0),i.attr("transform","translate(-12, 0)"),r.text("X"),this.addPinRectGroup.selectAll("rect").classed("grabbed",!0),this.needleSelection.classed("grabbed",!0)}onDragEnd(){var t;this.draggingPin&&(this._draggingPin=!1,T.select(this.draggingPinElement).classed("grabbed",!1),this.addPinRectGroup.selectAll("rect").classed("grabbed",!1),this.needleSelection.classed("grabbed",!1),-1!==(t=this.manualSampleValues.indexOf(this.anchorPinValue))&&(this.pinMoved?this.manualSampleValues[t]=this.getCurrentDraggedValue():this.manualSampleValues.splice(t,1),document.dispatchEvent(new CustomEvent("samplingStrategyChange",{detail:this.currentSamplingStategy}))))}onDrag(t,e){if(this.draggingPin){this.totalDragOffset[1]+=e;this._pinMoved=2<Math.abs(this.totalDragOffset[1]);const i=this.normalizedHistogramScaleY(this.anchorPinValue);var n=this.normalizedHistogramScaleY.range().map(t=>t-i),e=C.DevlibMath.clamp(this.totalDragOffset[1],n),n=this.pinMoved?4:12;T.select(this.draggingPinElement).attr("transform",`translate(${this.initialDragCoords[0]+this.totalDragOffset[0]-n}, ${this.initialDragCoords[1]+e})`),this.needleSelection.attr("transform",`translate(${-n}, ${e})`),this.textSelection.attr("transform",`translate(0, ${e})`).text(this.pinMoved?this.formatPinLabel(this.getCurrentDraggedValue()):"X")}}getCurrentDraggedValue(){var t=this.totalDragOffset[1],t=this.normalizedHistogramScaleY.invert(t)-this.normalizedHistogramScaleY.invert(0),t=this.initialPinValue+t;return t=C.DevlibMath.clamp(t,this.normalizedHistogramScaleY.domain())}drawExemplarGrowthCurves(){if(this.parentWidget.inExemplarMode&&this.parentWidget.inCondensedMode){D.DevlibTSUtil.show(this.exemplarCurvesGroup.node()),this.updateExemplarCurvesOffset();let t=this.exemplarCurvesGroup.selectAll(".exemplar.plotGrouper").data(this.conditionLabelPositions).join("g").classed("exemplar",!0).classed("plotGrouper",!0).attr("transform",t=>`translate(0, ${t[1][0]})`);var s=this.innerContainer.node().getBoundingClientRect().width-Number(this.selectedImageCanvas.attr("width"))-this.trackToPlotPadding-4,s=Math.max(s,this.exemplarMinWidth);s=Math.min(s,240);var l=this.parentWidget.fullData.getMinMax("Frame ID");this._exemplarScaleX=T.scaleLinear().domain(l).range([0,s]);const f=this.exemplarYKey;var u,l=[...this.manuallyPinnedTracks,...this.trackList.map(t=>t.data)];let e=T.min(l,t=>T.min(t.pointList,t=>t.get(f))),n=T.max(l,t=>T.max(t.pointList,t=>t.get(f)));for(u of this.parentWidget.facetList){var c=u.data.getAverageCurve(f,!1,this.smoothCurves),[h,c]=T.extent(c,t=>t[1]);e=Math.min(e,h),n=Math.max(n,c)}s=this.conditionLabelPositions[0][1],l=s[1]-s[0]+1,l=Math.min(l,120);this._exemplarScaleY=T.scaleLinear().domain([e,n]).range([l,0]);let{favoriteCurves:i,exemplarCurves:r,averageCurves:a}=this.generateExemplarGrowthCurves();s=this.parentWidget.getCurrentFrameId();t.selectAll(".currentFrameLine").data((t,e)=>[e]).join("line").attr("x1",this.exemplarScaleX(s)).attr("x2",this.exemplarScaleX(s)).attr("y1",this.exemplarScaleY.range()[0]).attr("y2",this.exemplarScaleY.range()[1]).attr("stroke","black").classed("currentFrameLine",!0),t.selectAll(".averageCurve").data((t,e)=>[[a[e],t[0]]]).join("path").attr("d",t=>t[0]).attr("stroke",t=>d.GroupByWidget.getColor(t[1].split("___"),this.parentWidget.colorLookup)).classed("averageCurve",!0),t.selectAll(".exemplarCurve").data((e,n)=>r[n].map(t=>({pathString:t,label:e[0],groupIndex:n}))).join("path").attr("d",t=>t.pathString).attr("stroke",t=>d.GroupByWidget.getColor(t.label.split("___"),this.parentWidget.colorLookup)).attr("data-cellId",(t,e)=>this.trackList[e+this.parentWidget.numExemplars*t.groupIndex].data.id).classed("exemplarCurve",!0);let o=[[T.axisBottom(this.exemplarScaleX).ticks(5),l],[T.axisLeft(this.exemplarScaleY),0]];t.selectAll(".exemplarPlotAxis").data((t,e)=>o.map(t=>[t,e])).join("g").classed("exemplarPlotAxis",!0).attr("transform",t=>`translate(0, ${t[0][1]})`).each(function(t){let e;e=t[0][0],e(T.select(this))}),this.drawFavoriteGrowthCurves(i,o)}else D.DevlibTSUtil.hide(this.exemplarCurvesGroup.node())}drawFavoriteGrowthCurves(e,n){if(0!==this.manuallyPinnedTracks.length){const i=this.exemplarCurvesGroup.selectAll(".favorite.plotGrouper").data([42]).join("g").classed("favorite",!0).classed("plotGrouper",!0).classed("noDisp",!1).attr("transform",t=>`translate(0, ${this.verticalPad})`);var t=this.parentWidget.getCurrentFrameId();i.selectAll(".currentFrameLine").data((t,e)=>[e]).join("line").attr("x1",this.exemplarScaleX(t)).attr("x2",this.exemplarScaleX(t)).attr("y1",this.exemplarScaleY.range()[0]).attr("y2",this.exemplarScaleY.range()[1]).attr("stroke","black").classed("currentFrameLine",!0),i.selectAll(".exemplarCurve").data(t=>e).join("path").attr("d",t=>t).attr("stroke",(t,e)=>{const n=this.manuallyPinnedTracks[e];e=n.get("Location ID"),e=this.parentWidget.fullData.inverseLocationMap.get(e);return d.GroupByWidget.getColor(e,this.parentWidget.colorLookup)}).attr("data-cellId",(t,e)=>this.manuallyPinnedTracks[e].id).classed("exemplarCurve",!0),i.selectAll(".exemplarPlotAxis").data((t,e)=>n.map(t=>[t,e])).join("g").classed("exemplarPlotAxis",!0).attr("transform",t=>`translate(0, ${t[0][1]})`).each(function(t){let e;e=t[0][0],e(T.select(this))})}else this.exemplarCurvesGroup.selectAll(".favorite.plotGrouper").classed("noDisp",!0)}updateCurrentFrameIndicator(e){if(this.exemplarScaleX){let t=this.exemplarCurvesGroup.selectAll(".plotGrouper");t.selectAll(".currentFrameLine").data([42]).join("line").attr("x1",this.exemplarScaleX(e)).attr("x2",this.exemplarScaleX(e)).attr("y1",this.exemplarScaleY.range()[0]).attr("y2",this.exemplarScaleY.range()[1]).attr("stroke","black").classed("currentFrameLine",!0)}}updateExemplarCurvesOffset(){var t=Number(this.selectedImageCanvas.attr("width"));const e=this.cellTimelineMargin.left+t+this.trackToPlotPadding;this.exemplarCurvesGroup.attr("transform",t=>`translate(${e}, ${this.cellTimelineMargin.top-this.latestScroll[1]})`)}generateExemplarGrowthCurves(){var e,n=this.exemplarYKey;let i=T.line().x(t=>this.exemplarScaleX(t[0])).y(t=>this.exemplarScaleY(t[1])),r=[];for(e of this.manuallyPinnedTracks){let t=this.extract2DArray(e.pointList,"Frame ID",n);this.smoothCurves&&(t=h.CurveList.medianFilter(t));var a=i(t);r.push(a)}let o=[];for(let t=0;t<this.trackList.length;t+=this.parentWidget.numExemplars){let e=[];for(var s of this.trackList.slice(t,t+this.parentWidget.numExemplars)){let t=this.extract2DArray(s.data.pointList,"Frame ID",n);this.smoothCurves&&(t=h.CurveList.medianFilter(t));s=i(t);e.push(s)}o.push(e)}var t,[]=this.parentWidget.fullData.getMinMax("Frame ID");let l=T.line().x(t=>this.exemplarScaleX(t[0])).y(t=>this.exemplarScaleY(t[1])),u=[];for(t of this.parentWidget.facetList){var c=t.data.getAverageCurve(n,!1,this.smoothCurves),c=l(c);u.push(c)}return{favoriteCurves:r,exemplarCurves:o,averageCurves:u}}extract2DArray(t,e,n){return t.map(t=>[t.get(e),t.get(n)])}updateLabelsOnMouseMove(n,e,i){let r=this.cellLabelGroup.selectAll("text");if(this.parentWidget.inExemplarMode){if(this.exemplarCurvesGroup.selectAll(".exemplarCurve").classed("selected",!1),this.exemplarPinGroup.selectAll("*").classed("selected",!1),this.manualExemplarPinGroup.selectAll("*").classed("selected",!1),void 0!==i){var a;i<this.manuallyPinnedTracks.length&&(a=this.hoverNodeWithText(r.nodes(),n),r=this.frameLabelGroup.selectAll("text"),a||this.hoverNodeWithText(r.nodes(),"")),n&&(a=[...this.manuallyPinnedTracks,...this.trackList.map(t=>t.data)],this.exemplarCurvesGroup.selectAll(".exemplarCurve").data(a).classed("selected",function(t,e){return T.select(this).attr("data-cellId")===n}),this.exemplarPinGroup.selectAll("*").classed("selected",function(t,e){return T.select(this).classed(n)}),this.manualExemplarPinGroup.selectAll("*").classed("selected",function(t,e){return T.select(this).classed(n)}));let t;t=i<0?"":(o=Math.floor(i/this.parentWidget.numExemplars),this.conditionLabelPositions[o][0]),this.hoverNodeWithText(r.nodes(),t)}}else{var o=this.hoverNodeWithText(r.nodes(),n);if(r=this.frameLabelGroup.selectAll("text"),!o)return void this.hoverNodeWithText(r.nodes(),"")}r=this.frameLabelGroup.selectAll("text");let s;if(this.parentWidget.inCondensedMode){let t=e/(this.parentWidget.condensedModeCount-1);s=t.toFixed(2)}else s=(e+1).toString();this.hoverNodeWithText(r.nodes(),s)}hoverNodeWithText(t,e){let n=!1;for(var i of t){let t=i;t.textContent===e?(t.classList.add("hovered"),n=!0):t.classList.remove("hovered")}return n}OnResize(t,e){this.svgContainer.attr("height",e-=30).attr("width",t),this.shameRectangle.attr("width",t);t=t-this.cellTimelineMargin.left-this.cellTimelineMargin.right;this._innerContainerW=t;e=e-this.cellTimelineMargin.top-this.cellTimelineMargin.bottom;this._innerContainerH=e,this.innerContainer.attr("style",`max-width: ${t}px;
            max-height: ${e}px;
            width: ${t}px;
            height: ${e}px;`)}}n.ImageTrackWidget=A},{"../DataModel/CurveList":100,"../DataModel/ImageStackDataRequest":110,"../devlib/DevlibAlgo":114,"../devlib/DevlibMath":115,"../devlib/DevlibTSUtil":116,"./GroupByWidget":86,"./HistogramWidget":87,"./OptionSelect":92,d3:42,"number-to-words":45}],91:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const u=t("d3"),i=t("../devlib/DevlibTSUtil");var r=t("./BaseWidget");const a=t("../LayoutFramework"),o=t("./HistogramWidget"),s=t("./ScatterPlotWidget"),l=t("../types");class c extends r.BaseWidget{constructor(t,e,n=!1){super(t,!1,e),this._isClone=n}Clone(t){return new c(t,this.metricDistributionCollectionLevel,!0)}get isClone(){return this._isClone}get wrapperContainer(){return this._wrapperContainer}get layoutFramework(){return this._layoutFramework}get subComponentLookup(){return this._subComponentLookup}get titleContainerSelection(){return this._titleContainerSelection}get basisSelectContainerSelection(){return this._basisSelectContainerSelection}get scatterPlotSelectContainerSelection(){return this._scatterPlotSelectContainerSelection}get yAxisMatrixSelect(){return this._yAxisMatrixSelect}get xAxisMatrixSelect(){return this._xAxisMatrixSelect}get distributionPlotContainerSelection(){return this._distributionPlotContainerSelection}get scatterPlotContainerSelection(){return this._scatterPlotContainerSelection}get collapseButtonSelect(){return this._collapseButtonSelect}get expandButtonSelect(){return this._expandButtonSelect}get attributeToIndex(){return this._attributeToIndex}get basisSelectionBooleans(){return this._basisSelectionBooleans}get scatterplotSelectionBooleans(){return this._scatterplotSelectionBooleans}get histogramWidgets(){return this._histogramWidgets}get scatterPlotWidgets(){return this._scatterPlotWidgets}get pointCollection(){return this._pointCollection}get metricDistributionCollectionLevel(){return this._metricDistributionCollectionLevel}get includeExemplarTrackButton(){return this._includeExemplarTrackButton}get showingSelectionMatrix(){return this._showingSelectionMatrix}initProps(t){super.initProps(),this._metricDistributionCollectionLevel=t[0],this._showingSelectionMatrix=!1}init(){this._wrapperContainer=document.createElement("div"),this.wrapperContainer.classList.add("frame","dir-row","wrapperContainer"),this.container.appendChild(this.wrapperContainer),this._layoutFramework=new a.LayoutFramework(this.wrapperContainer,!1);var t={direction:l.Direction.row,wrap:!0,overflowScroll:!0,inside:[{direction:l.Direction.column,inside:l.MetricDistributionSubComponentTypes.Title,minSize:"100%",fraction:0},{direction:l.Direction.column,minSize:"80px",maxSize:"80px",inside:l.MetricDistributionSubComponentTypes.BasisSelect},{direction:l.Direction.column,inside:l.MetricDistributionSubComponentTypes.ScatterplotSelect},{direction:l.Direction.column,inside:l.MetricDistributionSubComponentTypes.DistributionPlot},{direction:l.Direction.column,inside:l.MetricDistributionSubComponentTypes.Scatterplot}]};this._subComponentLookup=this.layoutFramework.InitializeLayout(t),this.initSubComponents()}initSubComponents(){for(var[i,r]of this.subComponentLookup)switch(r){case l.MetricDistributionSubComponentTypes.Title:this._titleContainerSelection=this.initSubComponent(i,"titleContainer");let t;t=this.metricDistributionCollectionLevel==l.MetricDistributionCollectionLevel.Curve?"Track-Level Attributes":"Cell-Level Attributes",this.titleContainerSelection.append("div").attr("style","width: 32px"),this.titleContainerSelection.append("span").text(t).classed("attributeTitle",!0).classed("mediumText",!0);break;case l.MetricDistributionSubComponentTypes.BasisSelect:this._basisSelectContainerSelection=this.initSubComponent(i,"toggleButtonContainer");break;case l.MetricDistributionSubComponentTypes.ScatterplotSelect:let e=u.select(i).append("div").classed("matrixWrapperContainer",!0).attr("id","matrixWrapperContainer");this._yAxisMatrixSelect=this.initSubComponent(e.node(),"yAxisMatrixContainer");let n=e.append("div").classed("matrixRightWrapperContainer",!0);this._scatterPlotSelectContainerSelection=this.initSubComponent(n.node(),"matrixContainer"),this._xAxisMatrixSelect=this.initSubComponent(n.node(),"xAxisMatrixContainer");var a=[this.basisSelectContainerSelection.node().parentElement,e.node().parentElement];this.hideElements(a),this.initExpandCollapseButton(a);break;case l.MetricDistributionSubComponentTypes.DistributionPlot:this._distributionPlotContainerSelection=this.initSubComponent(i,"distributionPlotContainer"),this.distributionPlotContainerSelection.node().style.minWidth="300px",this.distributionPlotContainerSelection.node().style.maxWidth="300px";break;case l.MetricDistributionSubComponentTypes.Scatterplot:this._scatterPlotContainerSelection=this.initSubComponent(i,"scatterPlotOuterContainer"),this._scatterPlotContainerSelection.node().style.minWidth="300px",this._scatterPlotContainerSelection.node().style.maxWidth="300px"}this.resizeSubComponents()}initSubComponent(t,e){return u.select(t).append("div").classed(e,!0).attr("id",e)}hideElements(t){for(var e of t)e.classList.add("noDisp")}initExpandCollapseButton(n){this._expandButtonSelect=this.titleContainerSelection.append("button").classed("basicIconButton",!0).classed("tab",!0).classed("noDisp",!0).attr("id","MetricDistributionWidget-expandButton").attr("title","Open distribution selection widget.").on("click",()=>{if(this.showingSelectionMatrix){for(var t of n)t.classList.add("noDisp");this.expandButtonSelect.classed("selected",!1)}else{for(var e of n)e.classList.remove("noDisp");this.expandButtonSelect.classed("selected",!0)}this._showingSelectionMatrix=!this.showingSelectionMatrix});var t=i.DevlibTSUtil.getFontAwesomeIcon("cog");this.expandButtonSelect.node().appendChild(t)}OnDataChange(){switch(this.metricDistributionCollectionLevel){case l.MetricDistributionCollectionLevel.Point:this._pointCollection=this.data,this._includeExemplarTrackButton=!1;break;case l.MetricDistributionCollectionLevel.Curve:this._pointCollection=this.data.curveCollection,this._includeExemplarTrackButton=!0;break;default:throw this._pointCollection=null,this._includeExemplarTrackButton=!1,new Error("MetricDistributionCollectionLevel not set.")}this._attributeToIndex=new Map;for(var[t,e]of this.pointCollection.attributeList.entries())this.attributeToIndex.set(e,t);this.updateUIData(),this.drawBasisSelect(),this.drawScatterPlotSelectContainerSelection(),this.drawMatrixAxis(),this.expandButtonSelect.classed("noDisp",!1),this.drawHistograms(),this.drawScatterPlots(this.getScatterOptionsMatrix())}OnBrushChange(){for(var t of this.histogramWidgets)t.OnBrushChange();for(var e of this.scatterPlotWidgets)e.OnBrushChange()}updateUIData(){this._basisSelectionBooleans=[];const e=new Set(["Mass (pg)","Time (h)","Mass_norm","Track Length","Avg. Mass (pg)","Growth Rate","Exponential Growth Constant"]);var n,i;this._scatterplotSelectionBooleans=[];for([n,i]of this.pointCollection.attributeList.entries()){this.basisSelectionBooleans.push(n<15&&e.has(i));let t=[];for(var[r,a]of this.pointCollection.attributeList.entries())t.push({value:i===a,index:[n,r]});this.scatterplotSelectionBooleans.push(t)}this.drawBasisSelect()}drawBasisSelect(){let r=this,a=this.getScatterOptionsMatrix();this.basisSelectContainerSelection.selectAll("button").data(this.pointCollection.attributeList).join("button").text(t=>t).attr("title",t=>t).classed("toggleButton",!0).classed("on",(t,e)=>this.basisSelectionBooleans[e]).attr("id",t=>"MetricDistributionWidget-varSelect-"+t).on("click",function(t,e){let n=u.select(this);var i=!r.basisSelectionBooleans[e];n.classed("on",i),r.basisSelectionBooleans[e]=i,r.drawScatterPlotSelectContainerSelection(),r.drawMatrixAxis(),r.updateHistograms(),r.updateScatterPlots(a)})}drawMatrixAxis(){var t=this.getCurrentOptions();this.yAxisMatrixSelect.selectAll("button").data(t).join("button").classed("axisButton",!0).classed("y",!0).attr("style",(t,e)=>`
				width: 80px;
				height: 18px;`).text(t=>t).attr("title",t=>t).on("click",t=>{var e,t=this.attributeToIndex.get(t),t=this.scatterplotSelectionBooleans[t];let n=!0;for(e of t)this.basisSelectionBooleans[e.index[1]]&&(e.value||(n=!1),e.value=!0);if(n)for(var i of t)this.basisSelectionBooleans[i.index[1]]&&(i.value=!1);this.afterMultipleMatrixChanges()}).on("mouseenter",function(t){u.select(this).classed("hovered",!0)}).on("mouseleave",function(t){u.select(this).classed("hovered",!1)});const e=this.yAxisMatrixSelect.selectAll("svg").data([42]).join("svg").attr("width",80).attr("height",80).classed("triangleQuickSelect",!0).raise();const n=u.scaleLinear().domain([0,1]).range([4,76]);var i=[[.05,0],[1,0],[1,.95],[.05,0]],r=[[0,.05],[.95,1],[0,1],[0,.05]];const a=u.line().x(t=>n(t[0])).y(t=>n(t[1]));e.selectAll("path").data([i,r]).join("path").attr("d",t=>a(t)).classed("triangleButton",!0).on("mouseenter",function(t){u.select(this).classed("hover",!0)}).on("mouseleave",function(t){u.select(this).classed("hover",!1)}).on("click",(t,e)=>{0==e?this.toggleUpperTriangle():this.toggleLowerTriangle(),this.afterMultipleMatrixChanges()});r=-90*Math.PI/180;const o=-.5*(80+80*Math.cos(-r)+18*Math.sin(-r)),s=.5*(80*Math.sin(-r)+18*Math.cos(-r)-18);r=0*Math.PI/180;let l=2+18/Math.cos(r);this.xAxisMatrixSelect.selectAll("button").data(t).join("button").classed("axisButton",!0).classed("x",!0).attr("style",(t,e)=>`
				width: 80px;
				height: 18px;
				transform: translate( ${l*(e+1)+o}px, ${s}px) rotate(-90deg);`).text(t=>t).attr("title",t=>t).on("click",t=>{var e,n=this.attributeToIndex.get(t);let i=!0;for(e of this.scatterplotSelectionBooleans)for(var r of e){var a=r.index[0];n===r.index[1]&&this.basisSelectionBooleans[a]&&(r.value||(i=!1),r.value=!0)}if(i)for(var o of this.scatterplotSelectionBooleans)for(var s of o){var l=s.index[0];n===s.index[1]&&this.basisSelectionBooleans[l]&&(s.value=!1)}this.afterMultipleMatrixChanges()}).on("mouseenter",function(t){u.select(this).classed("hovered",!0)}).on("mouseleave",function(t){u.select(this).classed("hovered",!1)})}toggleUpperTriangle(){this.toggleTriangle(!0)}toggleLowerTriangle(){this.toggleTriangle(!1)}toggleTriangle(r){let i=!0;for(let t=0;t<this.scatterplotSelectionBooleans.length;t++)if(this.basisSelectionBooleans[t]){var a=this.scatterplotSelectionBooleans[t];let e,n;n=r?(e=t+1,a.length):(e=0,t);for(let t=e;t<n;t++)if(this.basisSelectionBooleans[t]&&!a[t].value){i=!1;break}if(!i)break}var o=!i;for(let t=0;t<this.scatterplotSelectionBooleans.length;t++)if(this.basisSelectionBooleans[t]){let e=this.scatterplotSelectionBooleans[t],n,i;i=r?(n=t+1,e.length):(n=0,t);for(let t=n;t<i;t++)this.basisSelectionBooleans[t]&&(e[t].value=o)}}getCurrentOptions(){return this.pointCollection.attributeList.filter((t,e)=>this.basisSelectionBooleans[e])}afterMultipleMatrixChanges(){this.updateMatrixCellSelections();var t=this.getScatterOptionsMatrix();this.updateHistograms(),this.updateScatterPlots(t)}updateMatrixCellSelections(){this.scatterPlotSelectContainerSelection.selectAll("div").data(this.scatterplotSelectionBooleans).join("div").selectAll("button").data(t=>t).join("button").classed("on",t=>t.value)}drawScatterPlotSelectContainerSelection(){let o=this,r=this.getScatterOptionsMatrix();this.scatterPlotSelectContainerSelection.selectAll("div").data(this.scatterplotSelectionBooleans).join("div").classed("rowContainer",!0).classed("noDisp",(t,e)=>!o.basisSelectionBooleans[e]).selectAll("button").data(t=>t).join("button").classed("squareButton",!0).classed("on",t=>t.value).classed("noDisp",(t,e)=>!o.basisSelectionBooleans[e]).attr("id",t=>"MetricDistributionWidget-scatterSelect-"+t.index[0]+"-"+t.index[1]).on("click",function(t,e){let n=u.select(this);var i=!t.value;n.classed("on",i),o.scatterplotSelectionBooleans[t.index[0]][e].value=i,e===t.index[0]?o.updateHistograms():o.updateScatterPlots(r)}).on("mouseenter",function(t){var[e,n]=t.index;let i=u.select(this);i.classed("hovered",!0);t=o.getCurrentOptions();let r=o.pointCollection.attributeList[e],a=o.pointCollection.attributeList[n];o.yAxisMatrixSelect.selectAll("button").data(t).classed("hovered",t=>t===r),o.xAxisMatrixSelect.selectAll("button").data(t).classed("hovered",t=>t===a)}).on("mouseleave",function(t){let e=u.select(this);e.classed("hovered",!1);var n=o.getCurrentOptions();o.yAxisMatrixSelect.selectAll("button").data(n).classed("hovered",!1),o.xAxisMatrixSelect.selectAll("button").data(n).classed("hovered",!1)})}drawHistograms(){let e=this;this._histogramWidgets=[];let t=this.distributionPlotContainerSelection.node().parentElement;t.classList.remove("noDisp"),this.distributionPlotContainerSelection.html(null).classed("noDisp",!1).selectAll("div").data(this.pointCollection.attributeList).join("div").classed("histogramContainer",!0).attr("id",t=>"MetricDistributionWidget-histogramContainer-"+t).each(function(t){t=new o.HistogramWidget(this,t,!0,e.includeExemplarTrackButton);e.histogramWidgets.push(t)}),this.updateHistograms()}updateHistograms(){let i=this,n=!0;this.distributionPlotContainerSelection.selectAll(".histogramContainer").data(this.pointCollection.attributeList).classed("noDisp",(t,e)=>{e=this.shouldHide(e);return e||(n=!1),e}).each(function(t,e){let n=i.histogramWidgets[e];i.shouldHide(e)||n.data||n.SetData(i.pointCollection)});let t=this.distributionPlotContainerSelection.node().parentElement;n?t.classList.add("noDisp"):t.classList.remove("noDisp")}getScatterOptionsMatrix(){let t=this.scatterplotSelectionBooleans.flat();return t=t.filter(t=>t.index[0]!==t.index[1]),t}drawScatterPlots(t){this._scatterPlotWidgets=[];let n=this,e=this.scatterPlotContainerSelection.node().parentElement;e.classList.remove("noDisp"),this.scatterPlotContainerSelection.html(null).selectAll("div").data(t).join("div").classed("scatterPlotContainer",!0).each(function(t){var e=n.pointCollection.attributeList[t.index[1]],t=n.pointCollection.attributeList[t.index[0]],t=new s.ScatterPlotWidget(this,e,t);n.scatterPlotWidgets.push(t)}),this.updateScatterPlots(t)}updateScatterPlots(t){let i=this,e=!0;this.scatterPlotContainerSelection.selectAll(".scatterPlotContainer").data(t).classed("noDisp",t=>{t=this.shouldHide(t);return t||(e=!1),t}).each(function(t,e){let n=i.scatterPlotWidgets[e];i.shouldHide(t)||n.data||n.SetData(i.pointCollection)});let n=this.scatterPlotContainerSelection.node().parentElement;e?n.classList.add("noDisp"):n.classList.remove("noDisp")}shouldHide(t){return"number"==typeof t?!this.basisSelectionBooleans[t]||!this.scatterplotSelectionBooleans[t][t].value:!this.basisSelectionBooleans[t.index[0]]||!this.basisSelectionBooleans[t.index[1]]||!t.value}OnResize(){this.resizeSubComponents()}resizeSubComponents(){this.scatterPlotContainerSelection.node().style.maxHeight=this.height+"px"}}n.MetricDistributionWidget=c},{"../LayoutFramework":113,"../devlib/DevlibTSUtil":116,"../types":118,"./BaseWidget":84,"./HistogramWidget":87,"./ScatterPlotWidget":95,d3:42}],92:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t("d3");var a;(t=a=a||{})[t.ButtonList=0]="ButtonList",t[t.Dropdown=1]="Dropdown";class i{constructor(t,e,n){this._containerSelect=r.select("#"+t),this._label=e,this._uniqueId="OptionSelectDropdown_"+i._instanceCount++,this._currentSelectionIndex=null,void 0!==n&&(this._currentSelectionIndex=n)}get data(){return this._data}get containerSelect(){return this._containerSelect}get label(){return this._label}get mode(){return this._mode}get uniqueId(){return this._uniqueId}get currentSelectionIndex(){return this._currentSelectionIndex}clearSelectedButton(){this.containerSelect.selectAll(".on").classed("on",!1)}onDataChange(t,e){if(this._data=t,console.log(t),this.containerSelect.html(null),1===this.data.length)return this.label&&this.containerSelect.append("span").classed("optionSelectLabel",!0).text(this.label),void this.containerSelect.append("span").classed("valueHeader",!0).text(this.data[0].displayName);this.updateButtons(e)}updateButtons(t){void 0!==t&&(this._currentSelectionIndex=t),this.data.length<4?this.drawQuickSelectButtons(this.currentSelectionIndex):this.drawDropDownButtons(this.currentSelectionIndex)}drawQuickSelectButtons(n){this._mode=a.ButtonList;let i=this;this.containerSelect.html(null),this.label&&this.containerSelect.append("span").classed("optionSelectLabel",!0).text(this.label),this.containerSelect.selectAll("button").data(this.data).join("button").text(t=>t.displayName).classed("toggleButton",!0).classed("on",(t,e)=>n===e).on("click",function(t,e){this.classList.contains("on")||(i._currentSelectionIndex=e,i.clearSelectedButton(),r.select(this).classed("on",!0),t.callback())})}drawDropDownButtons(n){this._mode=a.Dropdown;let i=this;this.containerSelect.html(null),this.label&&this.containerSelect.append("label").text(this.label).classed("optionSelectLabel",!0).attr("for",this.uniqueId),this.containerSelect.append("select").attr("id",this.uniqueId).classed("optionSelectSelect",!0).on("change",()=>{let t=this.containerSelect.select("#"+this.uniqueId);var e=+t.property("value");this.data[e].callback(),i._currentSelectionIndex=e}).selectAll("option").data(this.data).join("option").attr("value",(t,e)=>e).property("selected",(t,e)=>n===e).text(t=>t.displayName)}addButton(t,e){this.data.push(t),this.updateButtons(e)}removeButton(e,n=!0){if(this.data){var i=this.data.findIndex(t=>t.displayName===e);if(-1!==i){this.data.splice(i);let t;n&&this.currentSelectionIndex===i?(t=0,this.data[0].callback()):t=this.currentSelectionIndex,this.updateButtons(t)}}}replaceButton(t,e){this.removeButton(t,!1),this.addButton(e,this.currentSelectionIndex),this.currentSelectionIndex===this.data.length-1&&this.data[this.currentSelectionIndex].callback()}}n.OptionSelect=i,i._instanceCount=0},{d3:42}],93:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const m=t("d3");var i=t("./BaseWidget");const r=t("./OptionSelect"),o=t("../devlib/DevlibTSUtil"),a=t("../DataModel/DataEvents"),v=t("./GroupByWidget");class s extends i.BaseWidget{constructor(t,e,n=0,i=!0,r=!0,a=!1){super(t,!0,e,n,r),this._squareAspectRatio=i,this.addLabel(),this._facetList=[],this._colorLookup=new Map,(this._isClone=a)&&(this._inAverageMode=!1,this._inFacetMode=!1,o.DevlibTSUtil.hide(this.averageLegendSelect.node()),o.DevlibTSUtil.hide(this.selectConditionButton),o.DevlibTSUtil.hide(this.compareConditionButton)),this.swapSvgVisibility(),this.inAverageMode&&o.DevlibTSUtil.hide(this.facetButton)}Clone(t){return new s(t,this.quickPickOptions,this.quickPickOptionSelect.currentSelectionIndex,this.squareAspectRatio,!1,!0)}get isClone(){return this._isClone}initProps(t){super.initProps(),this._quickPickOptions=t[0],this._initialQuickPickOptionIndex=t[1];var e=this.quickPickOptions[this.initialQuickPickOptionIndex];this._canBrush=t[2],this._xKey=e.xKey,this._yKey=e.yKey,this._inAverageMode=e.averaged,this._inFacetMode=!0,this._tempConditionFilterState=new Map,this._smoothCurves=!0}get titleBarContainer(){return this._titleBarContainer}get svgSelect(){return this._svgSelect}get svgFacetSelect(){return this._svgFacetSelect}get mainGroupSelect(){return this._mainGroupSelect}get mainGroupFacetSelect(){return this._mainGroupFacetSelect}get yAxisFacetSelect(){return this._yAxisFacetSelect}get xAxisFacetSelect(){return this._xAxisFacetSelect}get averageLegendSelect(){return this._averageLegendSelect}get facetLegendSelect(){return this._facetLegendSelect}get canvasContainer(){return this._canvasContainer}get canvasElement(){return this._canvasElement}get averageCurveLabelContainer(){return this._averageCurveLabelContainer}get currentFrameIndicator(){return this._currentFrameIndicator}get canBrush(){return this._canBrush}get brushGroupSelect(){return this._brushGroupSelect}get xAxisGroupSelect(){return this._xAxisGroupSelect}get xLabelTextSelect(){return this._xLabelTextSelect}get yAxisGroupSelect(){return this._yAxisGroupSelect}get yLabelTextSelect(){return this._yLabelTextSelect}get quickPickContainerSelect(){return this._quickPickContainerSelect}set quickPickContainerSelect(t){this._quickPickContainerSelect=t}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get xKey(){return this._xKey}get yKey(){return this._yKey}get quickPickOptions(){return this._quickPickOptions}get initialQuickPickOptionIndex(){return this._initialQuickPickOptionIndex}get quickPickOptionSelect(){return this._quickPickOptionSelect}get squareAspectRatio(){return this._squareAspectRatio}get brush(){return this._brush}get lastXValueBrushBound(){return this._lastXValueBrushBound}get lastYValueBrushBound(){return this._lastYValueBrushBound}get inAverageMode(){return this._inAverageMode}get inFacetMode(){return this._inFacetMode}get smoothCurves(){return this._smoothCurves}get facetList(){return this._facetList}get colorLookup(){return this._colorLookup}get forceSimulation(){return this._forceSimulation}get tempConditionFilterState(){return this._tempConditionFilterState}get miniCellSelect(){return this._miniCellSelect}get selectConditionButton(){return this._selectConditionButton}get compareConditionButton(){return this._compareConditionButton}setMargin(){this._margin={top:54,right:120,bottom:62,left:64}}init(){const t=m.select(this.container);this._titleBarContainer=t.append("div").classed("titleBarContainer",!0),this._svgSelect=t.append("svg"),this._mainGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),this._svgFacetSelect=t.append("svg"),this._mainGroupFacetSelect=this.svgFacetSelect.append("g"),this._yAxisFacetSelect=this.svgFacetSelect.append("g"),this._xAxisFacetSelect=this.svgFacetSelect.append("g"),this._canvasContainer=this.mainGroupSelect.append("foreignObject").attr("width",this.vizWidth).attr("height",this.vizHeight),this._canvasElement=this.canvasContainer.append("xhtml:canvas").attr("width",this.vizWidth).attr("height",this.vizHeight).node(),this.canBrush&&(this._brushGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("brushContainer",!0).classed("noDisp",this.inAverageMode),this.initBrush()),this.svgSelect.attr("width",this.width),this.svgSelect.attr("height",this.height),this.svgFacetSelect.attr("width",this.width),this.svgFacetSelect.attr("height",this.height),this._xAxisGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.vizHeight})`).classed("labelColor",!0),this._yAxisGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("labelColor",!0),this._currentFrameIndicator=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),this._averageCurveLabelContainer=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),this._averageLegendSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left/2}, ${this.margin.top+this.vizHeight+44})`),this._facetLegendSelect=this.svgFacetSelect.append("g").attr("transform",`translate(${this.margin.left/2}, ${this.margin.top+this.vizHeight+44})`),this.drawLegend(),document.addEventListener("groupByChanged",async t=>{let e=m.select("#largePopupContainerOuter");(e.empty()||e.classed("noDisp"))&&(this._facetList=t.detail.flatFacetList,this._colorLookup=t.detail.colorLookup,this.inAverageMode&&this.OnDataChange())}),document.addEventListener("smoothCurveChange",t=>{this._smoothCurves=t.detail,this.inAverageMode&&this.OnDataChange()}),document.addEventListener("locFrameClicked",t=>{t=t.detail.frameId;this.updateCurrentFrameIndicator(t)}),this._selectConditionButton=o.DevlibTSUtil.getIconButton("th",()=>{this._inFacetMode=!0,this.selectConditionButton.classList.add("selected"),this.compareConditionButton.classList.remove("selected"),this.drawFacetContent()},"Facet"),this.selectConditionButton.title="Filter data on experimental conditions",this.selectConditionButton.style.height="100%",this.selectConditionButton.classList.add("tab"),this.titleBarContainer.node().appendChild(this.selectConditionButton),this._compareConditionButton=o.DevlibTSUtil.getIconButton("chart-line",()=>{this._inFacetMode=!1,this.selectConditionButton.classList.remove("selected"),this.compareConditionButton.classList.add("selected"),this.drawFacetContent()},"Compare"),this.compareConditionButton.title="Compare average curves across experimental conditions",this.compareConditionButton.style.height="100%",this.compareConditionButton.classList.add("tab"),this.titleBarContainer.node().appendChild(this.compareConditionButton),this.titleBarContainer.append("div").attr("style","flex-grow: 1;"),(this.inFacetMode?this.selectConditionButton:this.compareConditionButton).classList.add("selected"),this.initQuickPickOptions()}initQuickPickOptions(){var t=this.ComponentId+"-quickPickContainer";this._quickPickContainerSelect=this.titleBarContainer.append("div").classed("quickPickContainer",!0).attr("id",t),this._quickPickOptionSelect=new r.OptionSelect(t,"Axes");let n=[];for(let e of this.quickPickOptions){let t;t=e.averaged?"Averaged: "+e.yKey+" over "+e.xKey:e.yKey+" v. "+e.xKey;var i={displayName:t,callback:()=>this.changeAxes(e.xKey,e.yKey,e.averaged,e.squareAspectRatio)};n.push(i)}this.quickPickOptionSelect.onDataChange(n,this.initialQuickPickOptionIndex)}initBrush(){this._brush=m.brush().extent([[0,0],[this.vizWidth,this.vizHeight]]).on("end",()=>{this.brushHandler()}),this.brushGroupSelect.call(this.brush)}addLabel(){this._xLabelTextSelect=this.svgSelect.append("text").classed("axisLabel",!0).classed("labelColor",!0).classed("noDisp",!0),this._yLabelTextSelect=this.svgSelect.append("text").classed("axisLabel",!0).classed("labelColor",!0).classed("noDisp",!0),this.positionLabels()}positionLabels(){this.xLabelTextSelect.attr("transform",`translate(${this.margin.left+this.vizWidth/2}, ${this.margin.top+this.vizHeight+32})`);var t=this.margin.left-40,e=this.margin.top+this.vizHeight/2;this.yLabelTextSelect.attr("transform",`rotate(-90) translate(${-e}, ${t})`)}OnDataChange(){this.updateScales(),this.tempConditionFilterState.clear(),this.resetTempConditionFilter(),this.updatePaths(),this.drawAxis(),this.showLabel()}changeAxes(t,e,n,i){this._xKey=t,this._yKey=e,this._inAverageMode!==n&&((this._inAverageMode=n)?(this.margin.right=120,o.DevlibTSUtil.hide(this.facetButton),o.DevlibTSUtil.show(this.averageLegendSelect.node()),o.DevlibTSUtil.show(this.facetLegendSelect.node()),o.DevlibTSUtil.show(this.compareConditionButton),o.DevlibTSUtil.show(this.selectConditionButton)):(this.margin.right=8,this.inFacetMode&&(this._inFacetMode=!1,this.swapSvgVisibility()),o.DevlibTSUtil.show(this.facetButton),o.DevlibTSUtil.hide(this.selectConditionButton),o.DevlibTSUtil.hide(this.compareConditionButton),o.DevlibTSUtil.hide(this.averageLegendSelect.node()),o.DevlibTSUtil.hide(this.facetLegendSelect.node())),this.setWidthHeight(),this.OnResize()),this.canBrush&&(n=this.brushGroupSelect.node(),this.inAverageMode?o.DevlibTSUtil.hide(n):o.DevlibTSUtil.show(n)),this._squareAspectRatio=i,this.removeBrush(),this.OnDataChange(),document.dispatchEvent(new CustomEvent("averageCurveKeyChange",{detail:{yKey:e}}))}removeBrush(){this.brushGroupSelect.call(this.brush.move,null)}updateScales(){let t,e,n,i;if(this.inAverageMode)n=m.min(this.facetList,t=>m.min(t.data.getAverageCurve(this.yKey,!1,this.smoothCurves),t=>t[1])),i=m.max(this.facetList,t=>m.max(t.data.getAverageCurve(this.yKey,!1,this.smoothCurves),t=>t[1])),this.data.brushApplied&&(n=m.min([n,m.min(this.facetList,t=>m.min(t.data.getAverageCurve(this.yKey,!0,this.smoothCurves),t=>t[1]))]),i=m.max([i,m.max(this.facetList,t=>m.max(t.data.getAverageCurve(this.yKey,!0,this.smoothCurves),t=>t[1]))]));else{let t;t=this.isClone?this.fullData:this.data,[n,i]=t.minMaxMap.get(this.yKey)}[t,e]=this.data.minMaxMap.get(this.xKey),this.squareAspectRatio?this.makeSquareAspectRatioScales(t,e,n,i):this.makeStretchedAspectRatioScales(t,e,n,i)}makeSquareAspectRatioScales(t,e,n,i){var r,a,o;(i-n)/(e-t)<this.vizHeight/this.vizWidth?(this._scaleX=m.scaleLinear().domain([t,e]).range([0,this.vizWidth]),[r,a]=[this.scaleX(n),this.scaleX(i)],o=(this.vizHeight-(a-r))/2-r,this._scaleY=m.scaleLinear().domain([n,i]).range([a+o,r+o])):(this._scaleY=m.scaleLinear().domain([n,i]).range([this.vizHeight,0]),[o,n]=[this.scaleY(t),this.scaleY(e)],i=(this.vizWidth-(n-o))/2-o,this._scaleX=m.scaleLinear().domain([t,e]).range([n+i,o+i]))}makeStretchedAspectRatioScales(t,e,n,i){this._scaleX=m.scaleLinear().domain([t,e]).range([0,this.vizWidth]),this._scaleY=m.scaleLinear().domain([n,i]).range([this.vizHeight,0])}swapSvgVisibility(){var t;this.svgSelect.classed("noDisp",this.inFacetMode),this.svgFacetSelect.classed("noDisp",!this.inFacetMode),this.inFacetMode&&this.dataSuperset?this.resetTempConditionFilter():(t=document.getElementById("conditionFilterApplyButton"))&&o.DevlibTSUtil.hide(t)}updatePaths(){this.inAverageMode?this.inFacetMode?this.updateFacetPaths():(this.updateAveragePaths(),this.drawAxis()):this.updateAllPaths()}updateAllPaths(){let t=m.line().x((t,e)=>this.scaleX(t.get(this.xKey))).y(t=>this.scaleY(t.get(this.yKey))).defined(t=>t.inBrush);const e=this.canvasElement.getContext("2d");e.clearRect(0,0,this.vizWidth,this.vizHeight),e.strokeStyle="black",e.lineWidth=1,e.globalAlpha=.25,e.lineJoin="round";for(var n of this.data.curveList){n=new Path2D(t(n.pointList));e.stroke(n)}this.clearLabels()}updateAveragePaths(){let i=m.line().x(t=>this.scaleX(t[0])).y(t=>this.scaleY(t[1]));const r=this.canvasElement.getContext("2d");r.clearRect(0,0,this.vizWidth,this.vizHeight),r.lineJoin="round";let a=[];for(let n=this.facetList.length-1;0<=n;n--){r.globalAlpha=.85,r.lineWidth=2;let t=this.facetList[n];r.strokeStyle=v.GroupByWidget.getColor(t.name,this.colorLookup);var o,s=t.data.getAverageCurve(this.yKey,!1,this.smoothCurves);0!==s.length&&(this.data.brushApplied&&(r.save(),r.globalAlpha*=.8,r.lineWidth=1),o=new Path2D(i(s)),r.stroke(o));let e=s[s.length-1];r.restore(),this.data.brushApplied&&(0!==(o=t.data.getAverageCurve(this.yKey,!0,this.smoothCurves)).length&&(s=new Path2D(i(o)),r.stroke(s)),e=o[o.length-1]),void 0===e&&(e=null),a.unshift([t.name.join("___"),e])}this.drawLabels(a)}updateCurrentFrameIndicator(t){this.inAverageMode&&!this.inFacetMode&&void 0!==t?this.currentFrameIndicator.selectAll("line").data([42]).join("line").attr("x1",this.scaleX(t)).attr("x2",this.scaleX(t)).attr("y1",this.scaleY.range()[0]).attr("y2",this.scaleY.range()[1]).attr("stroke","black").classed("currentFrameLine",!0):this.currentFrameIndicator.selectAll("line").remove()}updateFacetPaths(){var t={top:64,left:120,right:20,bottom:48};const n=this.data.defaultFacets,i=this.fullData.defaultFacets,r=this.fullData.defaultFacetAxisTicks;var e=r.xAxisTicks.length,a=r.yAxisTicks.length,o=(this.width-t.left-t.right)/e,s=(this.height-t.top-t.bottom)/a;let l=Math.min(o,s);const u=Math.round(.08*l);l-=2*u;o=e*l+(e-1)*u,s=a*l+(a-1)*u;this.addApplyButton(m.select(this.container)),this.mainGroupFacetSelect.attr("transform",`translate(${t.left}, ${t.top})`);let c=this.mainGroupFacetSelect.selectAll("g.row").data(r.yAxisTicks).join("g").classed("row",!0).attr("transform",(t,e)=>`translate(0, ${e*(l+u)})`);this._miniCellSelect=c.selectAll("g.miniCell").data(e=>r.xAxisTicks.map(t=>[e,t])).join("g").classed("miniCell",!0).on("click",t=>{var e;this.allConditionsTrue()&&this.setAllConditionsFalse();var n=null===(e=this.tempConditionFilterState.get(t[0]))||void 0===e?void 0:e.get(t[1]);null!==(e=this.tempConditionFilterState.get(t[0]))&&void 0!==e&&e.set(t[1],!n),this.updateConditionFilterSelection()}).attr("transform",(t,e)=>`translate(${e*(l+u)}, 0)`),this.updateConditionFilterSelection();e=this.data.getMinMax("Frame ID");const h=m.scaleLinear().domain(e).range([1,l-1]);let[f,d]=this.getExtentOfGrowthCurves(n);var[a,e]=this.getExtentOfGrowthCurves(i,!0);f=Math.min(f,a),d=Math.max(d,e);const p=m.scaleLinear().domain([f,d]).range([l-1,1]);let g=m.line().x(t=>h(t[0])).y(t=>p(t[1]));this.miniCellSelect.selectAll(".miniExemplarArea").data(t=>[t]).join("path").classed("miniExemplarArea",!0).attr("d",t=>{var e=this.getGrowthLine(t,n,g,!1,!0,f);return e||this.getGrowthLine(t,i,g,!0,!0,f)}),this.miniCellSelect.selectAll(".miniExemplarCurve.allData").data(t=>[t]).join("path").classed("miniExemplarCurve",!0).classed("allData",!0).classed("active",!this.data.brushApplied).attr("stroke",t=>v.GroupByWidget.getColor(t,this.colorLookup)).attr("d",t=>{var e=this.getGrowthLine(t,n,g,!1,!1);return e||this.getGrowthLine(t,i,g,!0,!1)}),this.data.brushApplied?this.miniCellSelect.selectAll(".miniExemplarCurve.selection").data(t=>[t]).join("path").classed("miniExemplarCurve",!0).classed("selection",!0).classed("active",!0).attr("stroke",t=>v.GroupByWidget.getColor(t,this.colorLookup)).attr("d",t=>this.getGrowthLine(t,n,g,!0,!1)):this.miniCellSelect.selectAll(".miniExemplarCurve.selection").remove(),this.miniCellSelect.selectAll("rect").data(t=>[t]).join("rect").attr("width",l).attr("height",l).classed("miniBox",!0).on("mouseenter",function(t){m.select(this).classed("hovered",!0)}).on("mouseleave",function(t){m.select(this).classed("hovered",!1)}),this.yAxisFacetSelect.attr("transform",`translate(${t.left}, ${t.top})`);this.yAxisFacetSelect.selectAll("text").data([r.axisLabels[0]]).join("text").attr("text-anchor","middle").attr("dominant-baseline","hanging").attr("transform",`translate(-98, ${s/2}) rotate(-90)`).classed("mediumText",!0).text(t=>t),this.yAxisFacetSelect.selectAll("foreignObject").data(r.yAxisTicks).join("foreignObject").attr("width",70).attr("height",l).attr("transform",(t,e)=>`translate(-78, ${e*(l+u)})`).selectAll("div").data(t=>[t]).join("xhtml:div").attr("style",`height: ${l}px;`).classed("y",!0).classed("axisButtonContainer",!0).selectAll("button").data(t=>[t]).join("button").classed("basicIconButton",!0).attr("style","max-width: 70px; min-width: 70px;").attr("title",t=>t).on("click",t=>{this.allConditionsTrue()&&this.setAllConditionsFalse();let e=this.tempConditionFilterState.get(t);var n,i=!Array(...e.values()).every(t=>t);for(n of e.keys())e.set(n,i);this.updateConditionFilterSelection()}).on("mouseenter",(e,t)=>{this.miniCellSelect.selectAll("rect").data(t=>[t]).classed("hovered",t=>{var[t]=t;return t===e})}).on("mouseleave",()=>this.miniCellSelect.selectAll("rect").classed("hovered",!1)).text(t=>t);this.xAxisFacetSelect.attr("transform",`translate(${t.left}, ${t.top+s})`),this.xAxisFacetSelect.selectAll("text").data([r.axisLabels[1]]).join("text").attr("text-anchor","middle").attr("dominant-baseline","hanging").attr("transform",`translate(${o/2}, 52)`).classed("mediumText",!0).text(t=>t),this.xAxisFacetSelect.selectAll("foreignObject").data(r.xAxisTicks).join("foreignObject").attr("width",l).attr("height",36).attr("transform",(t,e)=>`translate(${e*(l+u)}, 8)`).selectAll("div").data(t=>[t]).join("xhtml:div").classed("x",!0).classed("axisButtonContainer",!0).selectAll("button").data(t=>[t]).join("button").classed("basicIconButton",!0).attr("style",`max-width: ${l}px; min-width: ${l}px; height: 36px`).attr("title",t=>t).on("click",e=>{this.allConditionsTrue()&&this.setAllConditionsFalse();const t=Array(...this.tempConditionFilterState.values()),n=t.map(t=>t.get(e));var i,r=!n.every(t=>t);for(i of t)i.set(e,r);this.updateConditionFilterSelection()}).on("mouseenter",(e,t)=>{this.miniCellSelect.selectAll("rect").data(t=>[t]).classed("hovered",t=>{var[,t]=t;return t===e})}).on("mouseleave",()=>this.miniCellSelect.selectAll("rect").classed("hovered",!1)).text(t=>t),this.yAxisFacetSelect.append("foreignObject").attr("width",70).attr("height",36).attr("transform",`translate(-78, ${8+s})`).append("xhtml:div").classed("x",!0).classed("axisButtonContainer",!0).append("button").classed("basicIconButton",!0).attr("style","max-width: 70px; min-width: 70px; height: 36px").attr("title","Select all conditions").text("All").on("click",()=>{this.allConditionsTrue()?this.setAllConditionsFalse():this.setAllConditionsTrue(),this.updateConditionFilterSelection()}).on("mouseenter",()=>this.miniCellSelect.selectAll("rect").classed("hovered",!0)).on("mouseleave",()=>this.miniCellSelect.selectAll("rect").classed("hovered",!1))}getGrowthLine(t,e,n,i,r,a){var[o,t]=t;if(!e.has(o))return"";let s=e.get(o);if(!s.has(t))return"";let l=s.get(t),u=[...l.getAverageCurve(this.yKey,i,this.smoothCurves)];return 0===u.length?"":(r&&(r=u[0],u.unshift([r[0],a]),r=u[u.length-1],u.push([r[0],a])),n(u))}getExtentOfGrowthCurves(t,n=!1){let i=1/0,r=-1/0;for(var e of t.values())for(var a of e.values()){let t,e;e=n?(t=1/0,-1/0):(o=a.getAverageCurve(this.yKey,!1,this.smoothCurves),t=m.min(o,t=>t[1]),m.max(o,t=>t[1]));var o=a.getAverageCurve(this.yKey,!0,this.smoothCurves),a=(n||this.data.brushApplied)&&0<o.length;a&&(t=Math.min(t,m.min(o,t=>t[1]))),i=Math.min(t,i),a&&(e=Math.max(e,m.max(o,t=>t[1]))),r=Math.max(e,r)}return[i,r]}addApplyButton(t){t.selectAll("div.applyButtonContainer").data([42]).join("div").classed("applyButtonContainer",!0).selectAll("button").data([42]).join("button").attr("id","conditionFilterApplyButton").text("Apply Filter").classed("devlibButton",!0).classed("big",!0).on("click",()=>{this.copyTempConditionsToModel(),o.DevlibTSUtil.hide(document.getElementById("conditionFilterApplyButton")),document.dispatchEvent(new CustomEvent(a.DataEvents.applyNewFilter))});o.DevlibTSUtil.hide(document.getElementById("conditionFilterApplyButton"))}updateConditionFilterSelection(){this.miniCellSelect.classed("inFilter",t=>{if(!this.tempConditionFilterState.has(t[0]))return!1;let e=this.tempConditionFilterState.get(t[0]);return!!e.has(t[1])&&e.get(t[1])});var t=document.getElementById("conditionFilterApplyButton");this.tempConditionsDifferent()?o.DevlibTSUtil.show(t):o.DevlibTSUtil.hide(t)}resetTempConditionFilter(){for(var[t,e]of this.dataSuperset.conditionFilterState.entries())this.tempConditionFilterState.set(t,new Map(e))}allConditionsTrue(){for(var t of this.tempConditionFilterState.values())for(var e of t.values())if(!e)return!1;return!0}setAllConditionsFalse(){for(var t of this.tempConditionFilterState.values())for(var e of t.keys())t.set(e,!1)}setAllConditionsTrue(){for(var t of this.tempConditionFilterState.values())for(var e of t.keys())t.set(e,!0)}tempConditionsDifferent(){var t,e,n,i;for(e of this.tempConditionFilterState.keys())for([n,i]of this.tempConditionFilterState.get(e).entries())if(i!==(null===(t=this.fullData.conditionFilterState.get(e))||void 0===t?void 0:t.get(n)))return!0;return!1}copyTempConditionsToModel(){var t,e,n,i;for(e of this.tempConditionFilterState.keys())for([n,i]of this.tempConditionFilterState.get(e).entries())null!==(t=this.fullData.conditionFilterState.get(e))&&void 0!==t&&t.set(n,i)}drawFacetContent(){this.inAverageMode?(this.swapSvgVisibility(),this.updatePaths()):super.drawFacetContent()}drawLabels(n){const t=n.map((t,e)=>[t[0],t[1],e]),e=t.filter((t,e)=>null!==t[1]),i=e.map(t=>[this.scaleX(t[1][0]),this.scaleY(t[1][1]),t[2]]);this.averageCurveLabelContainer.selectAll("circle").data(i).join("circle").attr("cx",t=>t[0]).attr("cy",t=>t[1]).attr("r",3).attr("fill",t=>v.GroupByWidget.getColor(n[t[2]][0].split("___"),this.colorLookup));var r=m.scaleLinear().domain([5,50]).range([9,2]).clamp(!0)(n.length);const a=i.map(t=>({x:t[0],y:t[1]}));this._forceSimulation=m.forceSimulation(a).force("contraintX",t=>{for(let t=0;t<a.length;t++)a[t].x=i[t][0]}).force("repel",m.forceCollide().radius(r)).force("attractY",m.forceY().y(t=>i[t.index][1])).on("tick",()=>{console.log("tick")}),this.forceSimulation.stop(),this.forceSimulation.tick(1e3);r=m.scaleLinear().domain([5,30]).range([12,7]).clamp(!0)(n.length);this.averageCurveLabelContainer.selectAll("text").data(a).join("text").attr("transform",t=>`translate(${t.x+12}, ${t.y})`).attr("alignment-baseline","central").text((t,e)=>n[e][0].replace("___"," ")).attr("style",`font-size: ${r}pt;`).attr("stroke",(t,e)=>v.GroupByWidget.getColor(n[i[e][2]][0].split("___"),this.colorLookup)).attr("fill",(t,e)=>v.GroupByWidget.getColor(n[i[e][2]][0].split("___"),this.colorLookup))}clearLabels(){this.averageCurveLabelContainer.html(null)}drawAxis(){this.xAxisGroupSelect.attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.vizHeight})`).call(m.axisBottom(this.scaleX).ticks(5)),this.yAxisGroupSelect.attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).call(m.axisLeft(this.scaleY).ticks(5))}drawLegend(){this.drawAverageLegend(),this.drawFacetLegend()}drawAverageLegend(){this.averageLegendSelect.append("line").attr("x1",0).attr("x2",24).attr("y1",0).attr("y2",0).attr("stroke-width",2).attr("stroke","black").attr("opacity",.85),this.averageLegendSelect.append("circle").attr("cx",24).attr("cy",0).attr("r",3).attr("fill","black").attr("opacity",.85),this.averageLegendSelect.append("text").attr("alignment-baseline","middle").attr("transform","translate(28,0)").classed("smallText",!0).text("Selected"),this.averageLegendSelect.append("line").attr("x1",103).attr("x2",127).attr("y1",0).attr("y2",0).attr("stroke-width",1).attr("stroke","black").attr("opacity",.8),this.averageLegendSelect.append("text").attr("alignment-baseline","middle").attr("transform","translate(131,0)").classed("smallText",!0).text("All")}drawFacetLegend(){this.facetLegendSelect.append("line").attr("x1",0).attr("x2",24).attr("y1",0).attr("y2",0).attr("stroke-width",2).attr("stroke","black"),this.facetLegendSelect.append("text").attr("alignment-baseline","middle").attr("transform","translate(28,0)").classed("smallText",!0).text("Selected"),this.facetLegendSelect.append("rect").attr("x",103).attr("y",0).attr("width",24).attr("height",12).attr("stroke","none").attr("fill","rgb(236, 236, 236)"),this.facetLegendSelect.append("line").attr("x1",103).attr("x2",127).attr("y1",0).attr("y2",0).attr("stroke-width",1).attr("stroke","black").attr("opacity",.6),this.facetLegendSelect.append("text").attr("alignment-baseline","middle").attr("transform","translate(131,0)").classed("smallText",!0).text("All")}showLabel(){this.xLabelTextSelect.text(this.xKey).classed("noDisp",!1),this.yLabelTextSelect.text(this.yKey).classed("noDisp",!1)}OnResize(){this.data&&(this.svgSelect.attr("width",this.width),this.svgSelect.attr("height",this.height),this.svgFacetSelect.attr("width",this.width),this.svgFacetSelect.attr("height",this.height),this.averageLegendSelect.attr("transform",`translate(${this.margin.left/2}, ${this.margin.top+this.vizHeight+44})`),this.facetLegendSelect.attr("transform",`translate(${this.margin.left/2}, ${this.margin.top+this.vizHeight+44})`),this.canvasContainer.attr("width",this.vizWidth).attr("height",this.vizHeight),m.select(this.canvasElement).attr("width",this.vizWidth).attr("height",this.vizHeight),this.updateScales(),this.updatePaths(),this.positionLabels(),this.drawAxis()),this.resizeBrush()}resizeBrush(){var t,e,n,i;this.initBrush(),null!=this.lastYValueBrushBound&&null!=this.lastXValueBrushBound&&(t=this.scaleX(this.lastXValueBrushBound[0]),e=this.scaleX(this.lastXValueBrushBound[1]),n=this.scaleY(this.lastYValueBrushBound[1]),i=this.scaleY(this.lastYValueBrushBound[0]),this.brushGroupSelect.call(this.brush.move,[[t,n],[e,i]]))}brushHandler(){var t=m.event.selection;if(null==t)return this.data.removeCurveBrush(this.ComponentId),this._lastXValueBrushBound=null,void(this._lastYValueBrushBound=null);var[[e,n],[i,t]]=t,e=this.scaleX.invert(e),i=this.scaleX.invert(i);this._lastXValueBrushBound=[e,i];i={key:this.xKey,bound:this.lastXValueBrushBound},t=this.scaleY.invert(t),n=this.scaleY.invert(n);this._lastYValueBrushBound=[t,n];n={key:this.yKey,bound:this.lastYValueBrushBound};this.data.addCurveBrush(this.ComponentId,[i,n])}OnBrushChange(){for(var t of this.facetList)t.data._averageFilteredCurveCache.clear();this.inAverageMode&&this.updateScales(),this.updatePaths()}}n.Plot2dPathsWidget=s},{"../DataModel/DataEvents":104,"../devlib/DevlibTSUtil":116,"./BaseWidget":84,"./GroupByWidget":86,"./OptionSelect":92,d3:42}],94:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const a=t("d3"),f=t("../devlib/DevlibTSUtil");n.RichTooltip=class{constructor(t=350,e=200){this._waitToShow=t,this._waitToHide=e,this._container=document.createElement("div"),f.DevlibTSUtil.hide(this.container),document.body.appendChild(this.container),this.container.classList.add("richTooltip"),this._showTimerRunning=!1,this._hideTimerRunning=!1,this.container.addEventListener("mouseleave",()=>{this.Hide()}),this.container.addEventListener("mouseenter",()=>{this.hideTimer&&this.hideTimerRunning&&(this.hideTimer.stop(),this._hideTimerRunning=!1)}),this._hideTimerRunning=!1,this._showTimerRunning=!1,this._hideCallback=()=>{f.DevlibTSUtil.hide(this.container),this.hideTimer.stop(),this._hideTimerRunning=!1}}get waitToShow(){return this._waitToShow}get waitToHide(){return this._waitToHide}get container(){return this._container}get showTimerRunning(){return this._showTimerRunning}get showTimer(){return this._showTimer}get hideTimer(){return this._hideTimer}get hideTimerRunning(){return this._hideTimerRunning}get hideCallback(){return this._hideCallback}Show(t,e,n,i){this.showTimerRunning&&this.showTimer.stop();let r;r=void 0!==i?i:this.waitToShow,this._showTimer=a.timeout(()=>this.drawTooltip(t,e,n),r),this._showTimerRunning=!0,this.hideTimerRunning&&(this.hideTimer.stop(),this._hideTimerRunning=!1)}drawTooltip(t,e,n){this._showTimerRunning=!1,this.container.innerHTML=t,this.container.style.visibility="hidden",f.DevlibTSUtil.show(this.container);var i=this.container.getBoundingClientRect(),r=document.body.getBoundingClientRect(),a=r.right-e,o=r.bottom-n,s=r.width-a,l=r.height-o,u=i.width,t=i.height,r=t/2;let[c,h]=[0,0];[c,h]=u+30<=a&&10+r<=l&&10+r<=o?this.positionRight(e,n,i,20):t+30<=o&&10+r<=a&&10+r<=s?this.positionBelow(e,n,i,20):u+30<=s&&10+r<=l&&10+r<=o?this.positionLeft(e,n,i,20):this.positionAbove(e,n,i,20),this.container.style.top=c+"px",this.container.style.left=h+"px",this.container.style.visibility="visible"}positionRight(t,e,n,i){return[e-n.height/2,t+i]}positionBelow(t,e,n,i){return[e+i,t-n.width/2]}positionLeft(t,e,n,i){return[e-n.height/2,t-i-n.width]}positionAbove(t,e,n,i){return[e-i-n.height,t-n.width/2]}Hide(e){if(this.showTimerRunning&&(this.showTimer.stop(),this._showTimerRunning=!1),!this.hideTimer||!this.hideTimerRunning){{let t;t=void 0!==e?e:this.waitToHide,this._hideTimer=a.timeout(this.hideCallback,t)}this._hideTimerRunning=!0}}static createLabelValueListContent(t){let e=document.createElement("div");return e.classList.add("tooltipInnerContainer"),a.select(e).selectAll("p").data(t).join("p").html(t=>t[1]?t[0]+": <b>"+t[1]+"</b>":"<i>"+t[0]+"</i>").classed("tooltipDisplayRow",!0),e.outerHTML}}},{"../devlib/DevlibTSUtil":116,d3:42}],95:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t("d3");class i extends t("./BaseWidget").BaseWidget{constructor(t,e,n,i=!0,r=!1){super(t,!0,i),this._xKey=e,this._yKey=n,this._isClone=r,this.setLabel()}Clone(t){return new i(t,this.xKey,this.yKey,!1,!0)}initProps(t){super.initProps(),this._canBrush=t[0]}get isClone(){return this._isClone}get xKey(){return this._xKey}get yKey(){return this._yKey}get svgSelect(){return this._svgSelect}get mainGroupSelect(){return this._mainGroupSelect}get canvasElement(){return this._canvasElement}get canBrush(){return this._canBrush}get brushGroupSelect(){return this._brushGroupSelect}get xAxisGroupSelect(){return this._xAxisGroupSelect}get xLabelTextSelect(){return this._xLabelTextSelect}get yAxisGroupSelect(){return this._yAxisGroupSelect}get yLabelTextSelect(){return this._yLabelTextSelect}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get yAxisPadding(){return this._yAxisPadding}get brush(){return this._brush}setMargin(){this._margin={top:8,right:8,bottom:56,left:80}}init(){this._svgSelect=r.select(this.container).append("svg").attr("width",this.width).attr("height",this.height),this._mainGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),this._canvasElement=this.mainGroupSelect.append("foreignObject").attr("width",this.vizWidth).attr("height",this.vizHeight).append("xhtml:canvas").attr("width",this.vizWidth).attr("height",this.vizHeight).node(),this.canBrush&&(this._brushGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("brushContainer",!0),this._brush=r.brush().extent([[0,0],[this.vizWidth,this.vizHeight]]).on("end",()=>{this.brushHandler()}),this.brushGroupSelect.call(this.brush)),this._yAxisPadding=20,this._xAxisGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top+this.vizHeight})`).classed("labelColor",!0),this._yAxisGroupSelect=this.svgSelect.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`).classed("labelColor",!0)}setLabel(){this._xLabelTextSelect=this.svgSelect.append("text").attr("transform",`translate(${this.margin.left+this.vizWidth/2}, ${this.margin.top+this.vizHeight+32})`).classed("axisLabel",!0).classed("labelColor",!0).text(this.xKey);var t=this.margin.left-32-this.yAxisPadding,e=this.margin.top+this.vizHeight/2;let n;n=1===this.yKey.length?`translate(${t}, ${e})`:`rotate(-90) translate(${-e}, ${t})`,this._yLabelTextSelect=this.svgSelect.append("text").attr("transform",n).classed("axisLabel",!0).classed("labelColor",!0).text(this.yKey)}OnDataChange(){this.updateScales(),this.drawPoints(),this.drawAxis()}drawPoints(){var n=this.data.Array.filter(t=>!isNaN(t.get(this.xKey))&&!isNaN(t.get(this.yKey)));const i=this.canvasElement.getContext("2d");i.clearRect(0,0,this.vizWidth,this.vizHeight);for(let e=0;e<n.length;e++){let t=n[e];i.fillStyle=t.inBrush?"firebrick":"black";var r=this.scaleX(t.get(this.xKey)),a=this.scaleY(t.get(this.yKey));i.beginPath();i.arc(r,a,.5,0,2*Math.PI),i.fill()}}drawFacetedData(t){this.drawFacetedDataDefault(t,"300px","300px")}updateScales(){let t;t=this.isClone?this.fullData:this.data;var e=t.getMinMax(this.xKey);this._scaleX=r.scaleLinear().domain(e).range([0,this.vizWidth]);e=t.getMinMax(this.yKey);this._scaleY=r.scaleLinear().domain(e).range([this.vizHeight,0])}drawAxis(){this.xAxisGroupSelect.call(r.axisBottom(this.scaleX).ticks(5)),this.yAxisGroupSelect.call(r.axisLeft(this.scaleY).ticks(5))}OnResize(){}brushHandler(){var t,e,n,i=r.event.selection;null!=i?([[t,n],[e,i]]=i,t=this.scaleX.invert(t),e=this.scaleX.invert(e),e={key:this.xKey,bound:[t,e]},i=this.scaleY.invert(i),n=this.scaleY.invert(n),n={key:this.yKey,bound:[i,n]},this.data.addBrush(this.ComponentId,e,n)):this.data.removeBrush(this.ComponentId)}OnBrushChange(){this.container.classList.contains("noDisp")||this.drawPoints()}}n.ScatterPlotWidget=i},{"./BaseWidget":84,d3:42}],96:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const o=t("d3"),s=t("../devlib/DevlibTSUtil");var i=t("./BaseWidget");const l=t("../DataModel/DataEvents"),r=t("idb");class a extends i.BaseWidget{constructor(t){super(t)}get uploadFileButtonWrapper(){return this._uploadFileButtonWrapper}get toolbarElements(){return this._toolbarElements}get wrapperDiv(){return this._wrapperDiv}get modalPopupDiv(){return this._modalPopupDiv}get modalBooleans(){return this._modalBooleans}get yKey(){return this._yKey}get dataStore(){return this._dataStore}initToolbarElements(){this._toolbarElements=[{type:"optionSelect",iconKeys:["bars","stream","clone"],defaultIndex:0,callback:async t=>{let e;switch(t){case 0:e=new CustomEvent("modeChange",{detail:{inCondensedMode:!0,inExemplarMode:!0}});break;case 1:e=new CustomEvent("modeChange",{detail:{inCondensedMode:!1,inExemplarMode:!0}});break;case 2:e=new CustomEvent("modeChange",{detail:{inCondensedMode:!1,inExemplarMode:!1}})}s.DevlibTSUtil.launchSpinner(),await s.DevlibTSUtil.makeAsync(()=>document.dispatchEvent(e))},tooltips:["Switch to Condensed Mode","Switch to Expanded Mode","Switch to Frame Mode"]},{type:"popupButton",iconKey:"home",callback:t=>this.onHouseClick(t),tooltip:"Return to overview screen"},{type:"popupButton",iconKey:"filter",callback:t=>this.onDataFilterClick(t),tooltip:"View and modify data filters"},{type:"popupButton",iconKey:"trash",callback:t=>this.onGarbageClick(t),tooltip:"Delete cached data"},{type:"toggleButton",iconKeys:["chart-line","bacon"],callback:t=>this.onBaconClick(t),tooltips:["Click to show raw data in line charts.","Click to smooth line charts with median filter."]}]}init(){this._wrapperDiv=document.createElement("div"),this.wrapperDiv.classList.add("wrapperDiv"),this.container.appendChild(this.wrapperDiv),this._yKey="Mass_norm",this._modalBooleans=[],this.initToolbarElements(),this.drawToolbarElements(),this.initModalPopup(),document.addEventListener("averageCurveKeyChange",t=>{this._yKey=t.detail.yKey}),r.openDB("loon-db").then(t=>this._dataStore=t)}drawToolbarElements(){for(let r of this.toolbarElements)if("single"===r.type){let t=s.DevlibTSUtil.getIconButton(r.iconKey,r.callback);t.title=r.tooltip,t.classList.add("big"),this.wrapperDiv.append(t)}else if("popupButton"===r.type){const e=this.modalBooleans.length;this.modalBooleans.push(!1);let t=s.DevlibTSUtil.getIconButton(r.iconKey,null);t.title=r.tooltip,t.classList.add("big"),this.wrapperDiv.append(t),t.onclick=()=>this.toggleModalButton(e,r)}else if("toggleButton"===r.type){let t=s.DevlibTSUtil.getIconButton(r.iconKeys[0],null);t.title=r.tooltips[0],t.classList.add("big"),this.wrapperDiv.append(t);let e=s.DevlibTSUtil.getIconButton(r.iconKeys[1],null);e.title=r.tooltips[1],e.classList.add("big"),this.wrapperDiv.append(e),s.DevlibTSUtil.hide(e),t.onclick=()=>{s.DevlibTSUtil.hide(t),s.DevlibTSUtil.show(e),r.callback(!0)},e.onclick=()=>{s.DevlibTSUtil.show(t),s.DevlibTSUtil.hide(e),r.callback(!1)}}else if("optionSelect"===r.type){let n=document.createElement("div");n.classList.add("optionSelectGrouperDiv");let i=[];for(let e=0;e<r.iconKeys.length;e++){var a=r.iconKeys[e];let t=s.DevlibTSUtil.getIconButton(a,null);t.title=r.tooltips[e],t.classList.add("big"),e===r.defaultIndex&&t.classList.add("selected"),i.push(t),n.append(t)}const o=()=>{for(var t of i)t.classList.remove("selected")};for(let e=0;e<i.length;e++){let t=i[e];t.onclick=()=>{o(),t.classList.add("selected"),r.callback(e)}}document.addEventListener("changeModeSelect",t=>{o(),i[t.detail].classList.add("selected")}),this.wrapperDiv.append(n)}}toggleModalButton(t,e){if(-1!==t&&this.modalBooleans[t])this.modalBooleans[t]=!1;else{for(let t=0;t<this.modalBooleans.length;t++)this.modalBooleans[t]=!1;-1!==t&&(this.modalBooleans[t]=!0)}var n=this.modalBooleans[t];e&&e.callback({shown:n,index:t}),n?s.DevlibTSUtil.show(this.modalPopupDiv):s.DevlibTSUtil.hide(this.modalPopupDiv)}initModalPopup(){this._modalPopupDiv=document.createElement("div"),this.modalPopupDiv.classList.add("toolbarPopup"),s.DevlibTSUtil.hide(this.modalPopupDiv),this.container.appendChild(this.modalPopupDiv)}getOffsetFromIndex(t){let e=this.wrapperDiv.querySelectorAll(":scope > .basicIconButton")[t];return e.getBoundingClientRect().top}onDataFilterClick(n){if(this.modalPopupDiv.innerHTML=null,n.shown){let t=o.select(this.modalPopupDiv);t.classed("narrow",!1),t.node().style.top=this.getOffsetFromIndex(n.index)+"px";let e=t.append("div").attr("style","display: flex; width: 100%");var i=e.append("div");const a=e.append("div");var r=e.append("div");t.append("div").attr("style","display: flex; width: 100%; flex-direction: column; align-items: flex-end;").append("button").classed("devlibButton",!0).classed("big",!0).on("click",()=>{this.toggleModalButton(n.index)}).text("Close"),this.displayFilters(i,"Current Selection","The currently highlighted selection contains data that meet all of the following conditions.",this.data.GetAllFilters(),!1,n.index);i=s.DevlibTSUtil.getIconButton("long-arrow-alt-right",()=>this.triggerSelectionToFilterEvent(n.index),"Convert ");a.attr("style","align-self: center;").node().appendChild(i),this.displayFilters(r,"Current Filters","Only show tracks that meet all of the following conditions.",this.fullData.GetAllFilters(),!0,n.index)}}displayFilters(t,e,n,i,r,a){t.classed("filterDisplayContainer",!0).append("div").text(e).classed("largeText",!0).append("div").text(n).classed("smallText",!0);let o=t.append("ul").classed("mediumText",!0).selectAll("li").data(i).join("li");o.filter(t=>"cell"===t.type).html(t=>{let e=t.filter;var n=e.bound[0].toPrecision(5),t=e.bound[1].toPrecision(5);return r?`Tracks where <b>${e.key}</b> is in range [${n}, ${t}] at least once.`:`Cell instances where <b>${e.key}</b> is in range [${n}, ${t}]`}),o.filter(t=>"track"===t.type).html(t=>{let e=t.filter;var n=e.bound[0].toPrecision(5),t=e.bound[1].toPrecision(5);return`Tracks with <b>${e.key}</b> in range [${n}, ${t}]`}),o.filter(t=>"curve"===t.type).html(t=>{let e=t.filter[0];var n=e.bound[0].toPrecision(5),i=e.bound[1].toPrecision(5);let r=t.filter[1];var a=r.bound[0].toPrecision(5),o=r.bound[1].toPrecision(5),t="Tracks where ";return t+=`<b>${e.key}</b> is in range [${n}, ${i}] and `,t+=`<b>${r.key}</b> is in range [${a}, ${o}]`,t+=" at least once."}),r&&o.append("button").classed("basicIconButton",!0).on("click",t=>{"curve"===t.type?this.fullData.removeCurveBrush(t.filterKey):"track"===t.type?this.fullData.curveCollection.removeBrush(t.filterKey):"cell"===t.type&&this.fullData.removeBrush(t.filterKey),document.dispatchEvent(new CustomEvent(l.DataEvents.applyNewFilter)),this.onDataFilterClick({shown:!0,index:a})}).html('<i class="fas fa-minus"></i>')}triggerSelectionToFilterEvent(t){document.dispatchEvent(new CustomEvent(l.DataEvents.selectionToFilter)),this.onDataFilterClick({shown:!0,index:t})}onHouseClick(n){if(this.modalPopupDiv.innerHTML=null,n.shown){let t=o.select(this.modalPopupDiv);t.classed("narrow",!0),t.node().style.top=this.getOffsetFromIndex(n.index)+"px",t.append("div").classed("largeText",!0).text("Return to overview page?");let e=t.append("div").attr("style","display: flex; flex-direction: row");e.append("button").classed("devlibButton",!0).text("Navigate Home").on("click",()=>location.href="/overview"),e.append("button").classed("devlibButton",!0).text("Stay Here").on("click",()=>this.toggleModalButton(n.index))}}onGarbageClick(e){if(this.modalPopupDiv.innerHTML=null,e.shown){let t=o.select(this.modalPopupDiv);t.classed("narrow",!0),t.node().style.top=this.getOffsetFromIndex(e.index)+"px",t.append("div").classed("largeText",!0).text("Delete Cache?"),t.append("div").classed("mediumText",!0).text("Delete cache if your data has been updated since the last cache time. Otherwise, leave the cache as is to improve loading times."),t.append("button").classed("devlibButton",!0).text("Delete Entire Cache").on("click",()=>this.clearIDBCache("all"));const n=t.append("div").attr("style","display: flex; flex-direction: row");n.append("button").classed("devlibButton",!0).text("Delete Cached Tracks").on("click",()=>this.clearIDBCache("tracks")),n.append("button").classed("devlibButton",!0).text("Delete Cached Images").on("click",()=>this.clearIDBCache("images"))}}async clearIDBCache(t){if(this.dataStore){var e,n=this.data.Specification.googleDriveId;if("tracks"!==t&&"all"!==t||this.dataStore.delete("tracks",n),"images"===t||"all"===t)for(e of await this.dataStore.getAllKeys("images"))e.toString().includes(n)&&this.dataStore.delete("images",e)}this.toggleModalButton(-1)}onBaconClick(t){t=new CustomEvent("smoothCurveChange",{detail:!t});document.dispatchEvent(t)}OnResize(){}OnDataChange(){}Clone(t){return null}}n.Toolbar=a},{"../DataModel/DataEvents":104,"../devlib/DevlibTSUtil":116,"./BaseWidget":84,d3:42,idb:43}],97:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t("./CurveCollectionIterator");var r=t("./PointCollection");const a=t("./CurveListFactory");class o extends r.PointCollection{constructor(t,e){super(),this._length=t.curveList.length,this._curveList=t,this.Specification=e}CreateFilteredCurveList(){throw new Error("Method not implemented.")}ApplyDefaultFilters(){throw new Error("Method not implemented.")}get curveList(){return this._curveList}OnBrushChange(){}getFacetList(t){var e,t=a.CurveListFactory.CreateFacetedDatasets(this.curveList,t);for(e of t)e.data=e.data.curveCollection;return t}[Symbol.iterator](){return new i.CurveCollectionIterator(this.curveList)}}n.CurveCollection=o},{"./CurveCollectionIterator":98,"./CurveListFactory":101,"./PointCollection":111}],98:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.CurveCollectionIterator=class{constructor(t){this._index=0,this._curveList=t}get index(){return this._index}get curveList(){return this._curveList}next(){var t=this.curveList.curveList[this.index],e=this.index>=this.curveList.curveList.length;return++this._index,{value:t,done:e}}}},{}],99:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.CurveIterator=class{constructor(t){this._index=0,this._pointList=t}get index(){return this._index}get pointList(){return this._pointList}next(){var t=this.pointList[this.index],e=this.index>=this.pointList.length;return++this._index,{value:t,done:e}}}},{}],100:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const h=t("../devlib/DevlibAlgo"),i=t("./PointCollection"),r=t("./CurveListIterator"),f=t("./CurveCollection"),a=t("./CurveListFactory"),o=t("d3");class d extends i.PointCollection{constructor(t,e){super(),this._curveList=t;let n=this._length=0;this._curveLookup=new Map;for(var i of this.curveList){this.curveLookup.set(i.id,i),this._length+=i.length;for(var r of i)this[n]=r,++n}this._minMaxMap=new Map,this._inverseLocationMap=new Map,this._averageFilteredCurveCache=new Map,this._averageCurveCache=new Map,this._locationFrameSegmentLookup=new Map;const a=new Set;for(let e=0;e<this.length;e++){let t=this[e];var o=t.parent.get("Location ID");a.add(o),this._locationFrameSegmentLookup.has(o)||this._locationFrameSegmentLookup.set(o,new Map);const u=this._locationFrameSegmentLookup.get(o);o=t.get("Frame ID");u.has(o)||u.set(o,new Map);const c=u.get(o);o=t.get("segmentLabel");c.set(o,[t,e+1])}this._locationList=Array.from(a),this.locationList.sort(h.DevlibAlgo.sortAscend),this._curveCollection=new f.CurveCollection(this,e),this._curveBrushList=new Map,this.Specification=e,this._conditionFilterState=new Map;for(var s of this.defaultFacetAxisTicks.yAxisTicks){let t=new Map;for(var l of this.defaultFacetAxisTicks.xAxisTicks)t.set(l,!0);this.conditionFilterState.set(s,t)}}get curveList(){return this._curveList}get curveLookup(){return this._curveLookup}get curveCollection(){return this._curveCollection}set curveCollection(t){this._curveCollection=t}get minMaxMap(){return 0===this._minMaxMap.size&&this.updateMinMaxMap(),this._minMaxMap}get inverseLocationMap(){return 0===this._inverseLocationMap.size&&this.generateInverseLocationMap(),this._inverseLocationMap}getAverageCurve(t,e=!1,n=!1){let i=t;n&&(i+="-smoothed-out-real-nice-now");let r;if(r=e?this._averageFilteredCurveCache:this._averageCurveCache,r.has(i))return r.get(i);let a=new Map;for(var o of this){var s,l,u;e&&!o.inBrush||(s=o.get("Frame ID"),l=o.get(t),[u,o]=a.has(s)?a.get(s):[0,0],a.set(s,[u+l,o+1]))}let c=Array.from(a.keys()).sort((t,e)=>t-e),h=c.map(t=>{var[e,n]=a.get(t);return[t,e/n]});return n&&(h=d.medianFilter(h)),r.set(i,h),h}static medianFilter(i,r=3){return i.map((t,e)=>{var[n]=t,t=Math.max(0,e-r),e=Math.min(i.length,e+r+1),e=i.slice(t,e);return[n,o.median(e,t=>t[1])]})}get defaultFacetAxisTicks(){if(this._defaultFacetAxisTicks)return this._defaultFacetAxisTicks;var t=this.GetFacetOptions(),e=t[0],n=t[1],t=Object.keys(this.Specification.locationMaps[e.name]),n={xAxisTicks:Object.keys(this.Specification.locationMaps[n.name]),yAxisTicks:t,axisLabels:[e.name,n.name]};return this._defaultFacetAxisTicks=n}get defaultFacets(){if(this._defaultFacets)return this._defaultFacets;let t=this.GetFacetOptions()[0];var n,i,e=t.GetFacets();let r=new Map;for({name:n,data:i}of e){let t=i.GetFacetOptions()[1];var a,o=t.GetFacets();let e=new Map;for(a of o)e.set(a.name[0],a.data);r.set(n[0],e)}return this._defaultFacets=r,r}clearDefaultFacetCache(){for(var t of this.defaultFacets.values())for(var e of t.values())e._averageFilteredCurveCache.clear()}get locationList(){return this._locationList}CreateFilteredCurveList(){var t=this.curveList.filter(t=>t.inBrush);return new d(t,this.Specification)}ApplyDefaultFilters(){var t="Track Length",[,e]=this.curveCollection.getMinMax(t),e={key:t,bound:[e/2,e]};for(let t=1;t<this.defaultFacetAxisTicks.xAxisTicks.length;t+=2){var n,i=this.defaultFacetAxisTicks.xAxisTicks[t];for(n of this.defaultFacetAxisTicks.yAxisTicks)this.conditionFilterState.get(n).set(i,!1)}this.curveCollection.addBrushNoUpdate("default",e)}GetAllFilters(){let t=[];for(var[e,n]of this.curveBrushList.entries())t.push({type:"curve",filterKey:e,filter:n});for(var[i,r]of this.brushList.entries())for(var[a,o]of r.entries())t.push({type:"cell",filterKey:i,filter:{key:a,bound:o}});for(var[s,l]of this.curveCollection.brushList.entries())for(var[u,c]of l.entries())t.push({type:"track",filterKey:s,filter:{key:u,bound:c}});return t}ConsumeFilters(t){for(var[e,n]of t.curveBrushList.entries())this.curveBrushList.set(e+Date.now(),n);for(var[i,r]of t.brushList.entries()){var a,o,s=i+Date.now();for([a,o]of r.entries())this.addBrushNoUpdate(s,{key:a,bound:o})}for(var[l,u]of t.curveCollection.brushList.entries()){var c,h,f=l+Date.now();for([c,h]of u.entries())this.curveCollection.addBrushNoUpdate(f,{key:c,bound:h})}}ApplyNewFilter(){this.OnBrushChange();const t=this.generateInFilterLocations();for(var e of this.curveList){var n=e.get("Location ID");t.has(n)||(e.inBrush=!1)}}generateInFilterLocations(){const n=new Set;var e,[i,r]=this.defaultFacetAxisTicks.axisLabels;for(e of this.conditionFilterState.keys()){var a,o,s=this.Specification.locationMaps[i][e],l=d.numberRangeListToSet(s);let t=this.conditionFilterState.get(e);for([a,o]of t.entries())if(o){var u,c=this.Specification.locationMaps[r][a];let e=d.numberRangeListToSet(c);for(u of[...l].filter(t=>e.has(t)))n.add(u)}}return n}static numberRangeListToSet(t){const e=new Set;for(var[n,i]of t)for(let t=n;t<=i;t++)e.add(t);return e}GetCellsAtFrame(t,e){if(this._locationFrameSegmentLookup.has(t)){const r=this._locationFrameSegmentLookup.get(t);if(r.has(e)){const a=r.get(e);var n,i,e=a.values();let t=[];for([n,i]of e)t.push(n);return t}}return[]}GetCellFromLabel(t,e,n){if(this._locationFrameSegmentLookup.has(t)){const i=this._locationFrameSegmentLookup.get(t);if(i.has(e)){const r=i.get(e);if(r.has(n))return r.get(n)}}return[null,null]}get brushApplied(){return this._brushApplied}set brushApplied(t){this._brushApplied=t}get curveBrushList(){return this._curveBrushList}get conditionFilterState(){return this._conditionFilterState}getFacetList(t){return a.CurveListFactory.CreateFacetedDatasets(this,t)}OnBrushChange(){this.clearDefaultFacetCache(),this._averageFilteredCurveCache.clear();for(var t of this.curveList){t.inBrush=!0;for(var e of t.pointList)e.inBrush=!0}var n,i=this.SetBrushValues();for(n of this.curveList){let t=!0;for(var r of n.pointList)if(r.inBrush){t=!1;break}t&&(n.inBrush=!1)}var a=this.curveCollection.SetBrushValues(),o=this.setCurveBrushValues();this._brushApplied=i||o||a}setCurveBrushValues(){let e=!1;for(var n of this.curveList){let t=!0;for(var i of n.pointList)if(this.isPointInCurveBrushList(i)){t=!1;break}t&&(n.inBrush=!1,e=!0)}return e}isPointInCurveBrushList(t){for(var e of this.curveBrushList.values())for(var n of e)if(!i.PointCollection.IsInBrush(t,n))return!1;return!0}updateMinMaxMap(){for(var t of this.curveList)for(var e of t.pointList)for(var[n,i]of e.valueMap){var r,a=this._minMaxMap.get(n),o=e.get(n);void 0!==a?([r,a]=a,a=[Math.min(r,o),Math.max(a,o)],this._minMaxMap.set(n,a)):this._minMaxMap.set(n,[o,o])}}generateInverseLocationMap(){for(var t of Object.keys(this.Specification.locationMaps)){var e,n,i,r=this.Specification.locationMaps[t];for(e of Object.keys(r))for([n,i]of r[e])for(let t=n;t<=i;t++)this._inverseLocationMap.has(t)||this._inverseLocationMap.set(t,[]),this._inverseLocationMap.get(t).push(e)}}initValue(t,e){for(var n of this.curveList)n.addValue(t,e)}isKeySet(t){for(var e of this.curveList)if(void 0===e.get(t))return!1;return!0}removeCurveBrush(t){this.curveBrushList.delete(t),this.updateBrush()}addCurveBrush(t,e){this.curveBrushList.set(t,e),this.updateBrush()}sort(e,t=!0){t=h.DevlibAlgo.sortOnProperty(t=>t.get(e),t);this.curveList.sort(t)}getPointsAtInput(t){let e=[];for(var n of this.curveList){n=n.getPoint(t);n&&e.push(n)}return e}[Symbol.iterator](){return new r.CurveListIterator(this.curveList)}}n.CurveList=d},{"../devlib/DevlibAlgo":114,"./CurveCollection":97,"./CurveListFactory":101,"./CurveListIterator":102,"./PointCollection":111,d3:42}],101:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const v=t("./CurveList"),y=t("./CurveND"),b=t("./PointND");class _{static CreateFacetedDatasets(t,e){let n=new Map;for(var i of Object.keys(e)){var r=e[i];if(0===r.length)throw new Error("LocationMap valueList should have at least one entry");if("string"!=typeof r[0])for(var[a,o]of r)for(let t=+a;t<=+o;t++)n.set(t,i)}let s=new Map;for(var l of t.curveList){var u=l.get("Location ID"),u=n.get(u);s.has(u)||s.set(u,[]),s.get(u).push(l)}let c=[];for(var[h,f]of s){f=new v.CurveList(f,t.Specification),f={name:[h],data:f};c.push(f)}return c}static CreateCurveListFromPbObject(e,t,n,i,r=0,a=["Time (h)"]){const o=[];let s=null;for(var l of a)if(e.pointAttrNames.includes(l)){s=l;break}if(null==s)throw new Error("Dataset does not contain any tKey column. Allowed Keys: "+a.toString());for(var u of e.curveList){const g=new y.CurveND(u.id.toString());for(let t=0;t<e.curveAttrNames.length;t++){var c=e.curveAttrNames[t],h=u.valueList[t];g.addValue(c,h)}for(var f of u.pointList){const m=new b.PointND;for(let t=0;t<e.pointAttrNames.length;t++){var d=e.pointAttrNames[t],p=f.valueList[t];m.addValue(d,p)}g.addPoint(m)}_.calculateDerivedPointValues(g,n),_.calculateDerivedPointValues(g,t),o.push(g)}return new v.CurveList(o,i)}static calculateDerivedPointValues(t,e){for(var n of e)n(t)}}n.CurveListFactory=_},{"./CurveList":100,"./CurveND":103,"./PointND":112}],102:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t("./CurveIterator");n.CurveListIterator=class{constructor(t){this._curveList=t,this.updateCurveIterator(0)}get index(){return this._index}get curveList(){return this._curveList}get currentCurveIterator(){return this._currentCurveIterator}next(){var t=this.currentCurveIterator.next();if(!t.done)return t;t=this.index+1;return t>=this.curveList.length?{done:!0,value:void 0}:(this.updateCurveIterator(t),this.next())}updateCurveIterator(t){this._index=t;t=this.curveList[t];t&&(this._currentCurveIterator=new i.CurveIterator(t.pointList))}}},{"./CurveIterator":99}],103:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const h=t("./PointND"),f=t("../devlib/DevlibAlgo");var i=t("./PointCollection");const r=t("./CurveIterator");class a extends i.PointCollection{constructor(t){super(),this._id=t,this._valueMap=new Map,this._pointList=[],this._inBrush=!0}CreateFilteredCurveList(){throw new Error("Method not implemented.")}ApplyDefaultFilters(){throw new Error("Method not implemented.")}get id(){return this._id}get inputKey(){return this._inputKey}get valueMap(){return this._valueMap}get pointList(){return this._pointList}get inBrush(){return this._inBrush}set inBrush(t){this._inBrush=t;for(var e of this.pointList)e.inBrush=t}getFacetList(){throw new Error("Not Implemented.")}OnBrushChange(){}ConsumeFilters(t){}ApplyNewFilter(){}addValue(t,e){this.valueMap.set(t,e)}get(t){return this.valueMap.get(t)}getPointValue(t,e){var n=f.DevlibAlgo.compareProperty(t,t=>t.get(this.inputKey)),i=f.DevlibAlgo.BinarySearchIndex(this.pointList,n);if("number"==typeof i)return this.pointList[i].get(e);var[n,i]=i;if(void 0!==n&&void 0!==i){const r=this.pointList[n],a=this.pointList[i];n=r.get(e),i=a.get(e),e=r.get(this.inputKey);return n+(i-n)*((t-e)/(a.get(this.inputKey)-e))}}getPoint(e){var n=f.DevlibAlgo.compareProperty(e,t=>t.get(this.inputKey)),i=f.DevlibAlgo.BinarySearchIndex(this.pointList,n);if("number"==typeof i)return this.pointList[i];var[n,i]=i;if(void 0!==n&&void 0!==i){const u=this.pointList[n],c=this.pointList[i];var r,a,i=u.get(this.inputKey),o=(e-i)/(c.get(this.inputKey)-i);let t=new h.PointND;t.addValue(this.inputKey,e);for([r,a]of u.valueMap){var s=u.get(r),l=c.get(r);t.addValue(r,s+(l-s)*o)}return t.inBrush=u.inBrush&&c.inBrush,t}}getPointWeight(t){var e=Math.max(t-1,0),t=Math.min(t+1,this.pointList.length-1),e=this.pointList[e].get(this.inputKey);return(this.pointList[t].get(this.inputKey)-e)/2}addPoint(t){(t.parent=this)._pointList.push(t),this[this.length]=t,++this._length}sort(e){var t=f.DevlibAlgo.sortOnProperty(t=>t.get(e));this.pointList.sort(t),this._inputKey=e}[Symbol.iterator](){return new r.CurveIterator(this.pointList)}}n.CurveND=a},{"../devlib/DevlibAlgo":114,"./CurveIterator":99,"./PointCollection":111,"./PointND":112}],104:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),(n=n.DataEvents||(n.DataEvents={})).brushChange="brushChange",n.selectionToFilter="selectionToFilter",n.applyNewFilter="applyNewFilter"},{}],105:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.DerivedPointValueFunctions=class{static GetFunctionList(){let t=[];return t.push(t=>this.normAttr("Mass_norm","Mass (pg)",t,!1)),t.push(t=>this.normAttr("Time_norm","Time (h)",t)),t}static normAttr(e,n,t,i=!0){if(0!==t.pointList.length){var r,a=t.pointList[0].get(n);for(r of t.pointList){var o=r.get(n);let t;t=i?o-a:o/a,r.addValue(e,t)}}}}},{}],106:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.DerivedTrackValueFunctions=class{static GetFunctionList(){let t=[];t.push(this.trackLength);for(let e of["Mass (pg)","shape factor","Mass_norm","Mean Intensity","Area"])t.push(t=>this.averageAttribute("Avg. "+e,e,t));return t.push(this.growthRateStats),t}static trackLength(t){var e=t.pointList[0].get("Time (h)"),n=t.pointList[t.pointList.length-1].get("Time (h)");t.addValue("Track Length",n-e)}static averageAttribute(e,n,i){const t=i.pointList[0];if(t.valueMap.has(n)){let t=0;for(var r of i.pointList)t+=r.get(n);var a=t/i.pointList.length;i.addValue(e,a)}else i.addValue(e,null)}static growthRateStats(e){var n=["Growth Rate","Intercept","Initial Mass","Exponential Growth Constant","r_squared"];let t=0,i=0,r=0,a=0,o=0;var s=e.pointList.length;if(1!==s){for(var l of e.pointList){var u=l.get("Time (h)"),l=l.get("Mass (pg)");t+=u,i+=l,r+=l*l,a+=u*l,o+=u*u}var c=1/s,h=(a-c*t*i)/(o-c*t*t),f=c*(i-h*t),d=e.pointList[0].get("Time (h)")*h+f,p=h/d,s=c*a-c*t*c*i,c=Math.sqrt((c*o-c*t*c*t)*(c*r-c*i*c*i)),g=[h,f,d,p,Math.pow(s/c,2)];for(let t=0;t<n.length;t++){var m=n[t],v=g[t];e.addValue(m,v)}}else for(var y of n)e.addValue(y,NaN)}}},{}],107:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.ImageFrame=class{constructor(t){this._frameId=t,this._inBrush=!0}get inBrush(){return this._inBrush}set inBrush(t){this._inBrush=t}get inBrushCount(){return this._inBrushCount}set inBrushCount(t){this._inBrushCount=t}get totalCount(){return this._totalCount}set totalCount(t){this._totalCount=t}get inBrushPercent(){return 0===this.totalCount?0:this.inBrushCount/this.totalCount}get frameId(){return this._frameId}}},{}],108:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t("./ImageFrame"),r=t("../devlib/DevlibAlgo");n.ImageLocation=class{constructor(t){this._locationId=t,this._inBrush=!0,this._frameList=[],this._frameLookup=new Map}get inBrush(){return this._inBrush}set inBrush(t){this._inBrush=t}get inBrushCount(){return this._inBrushCount}set inBrushCount(t){this._inBrushCount=t}get totalCount(){return this._totalCount}set totalCount(t){this._totalCount=t}get inBrushPercent(){return this.inBrushCount/this.totalCount}get locationId(){return this._locationId}get frameList(){return this._frameList}get frameLookup(){return this._frameLookup}addFrame(t){var e;this.frameLookup.has(t)||(e=new i.ImageFrame(t),this.frameList.push(e),this.frameLookup.set(t,e))}sortFrames(){this.frameList.sort(r.DevlibAlgo.sortOnProperty(t=>t.frameId))}}},{"../devlib/DevlibAlgo":114,"./ImageFrame":107}],109:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const l=t("./ImageLocation");n.ImageMetaData=class s{constructor(){this._locationList=[],this._locationLookup=new Map}get locationList(){return this._locationList}get locationLookup(){return this._locationLookup}get locationIdKey(){return this._locationIdKey}get frameIdKey(){return this._frameIdKey}getBrushedLocations(){return this.locationList.filter(t=>t.inBrush).map(t=>t.locationId)}getBrushedImageCount(){let t=0;for(var e of this.locationList)t+=e.frameList.filter(t=>t.inBrush).length;return t}updateInBrushProp(t){this.resetAllToFalse();for(var n of t){var i=n.parent.get(this.locationIdKey),r=n.get(this.frameIdKey);let t=this.locationLookup.get(i),e=t.frameLookup.get(r);t.totalCount++,e.totalCount++,n.inBrush&&(t.inBrushCount++,t.inBrush=!0,e.inBrushCount++,e.inBrush=!0)}}resetAllToFalse(){for(var t of this.locationList){t.inBrush=!1,t.inBrushCount=0,t.totalCount=0;for(var e of t.frameList)e.inBrush=!1,e.inBrushCount=0,e.totalCount=0}}static fromPointCollection(t,e="Location ID",n="Frame ID"){let i=new s;i._locationIdKey=e,i._frameIdKey=n;for(var r of t){var a=r.parent.get(e),r=r.get(n);let t;i.locationLookup.has(a)?t=i.locationLookup.get(a):(t=new l.ImageLocation(a),i.locationList.push(t),i.locationLookup.set(a,t)),t.addFrame(r)}for(var o of i.locationList)o.sortFrames();return i.updateInBrushProp(t),i}}},{"./ImageLocation":108}],110:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const o=t("d3"),i=t("idb"),r=t("protobufjs");n.ImageStackDataRequest=class{constructor(t){this._driveId=t;t=`/data/${this.driveId}/imageMetaData.json`;this._jsonPromise=o.json(t),r.load("/static/protoDefs/RLE.proto",async(t,e)=>{if(t)throw t;this._imageLabelsMessage=e.lookupType("imageLabels.ImageLabels")}),i.openDB("loon-db").then(async t=>{this._dataStore=t}),this._labelCache=new Map,this._clearLabelCacheTimerKeys=new Map,this._blobCache=new Map,this._clearBlobCacheTimerKeys=new Map,this._cacheLifetime=3e5}async init(){this.driveId;var t=await this.jsonPromise;this.initImageMetaData(t)}initImageMetaData(t){this._tileWidth=t.tileWidth,this._tileHeight=t.tileHeight,this._numberOfColumns=t.numberOfColumns,this._tilesPerFile=t.tilesPerFile,t.scaleFactor?this._scaleFactor=t.scaleFactor:this._scaleFactor=1}get jsonPromise(){return this._jsonPromise}get driveId(){return this._driveId}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}get numberOfColumns(){return this._numberOfColumns}get tilesPerFile(){return this._tilesPerFile}get scaleFactor(){return this._scaleFactor}get blobCache(){return this._blobCache}get clearBlobCacheTimerKeys(){return this._clearBlobCacheTimerKeys}get labelCache(){return this._labelCache}get clearLabelCacheTimerKeys(){return this._clearLabelCacheTimerKeys}get cacheLifetime(){return this._cacheLifetime}get dataStore(){return this._dataStore}get imageLabelsMessage(){return this._imageLabelsMessage}async getImage(e,i,r){let[a,o]=this.getTileTopLeft(i),t=Math.floor(i/this.tilesPerFile),s=[e,t].join("-");if(this.clearCacheTimeout(this.clearBlobCacheTimerKeys,s),this.blobCache.has(s))this.runWithCachedImage(s,a,o,r);else{const l=`/data/${this.driveId}/img_${e}_${t}.jpg`;if(this.blobCache.set(s,{img:null,url:null}),this.dataStore){let t=this.dataStore.transaction("images","readonly").objectStore("images");i=await t.get(l);if(i){e=window.URL.createObjectURL(i);return this.blobCache.set(s,{img:i,url:e}),this.setCacheTimeout(s,this.blobCache,this.clearBlobCacheTimerKeys),void r(a,o,i,e)}}let n=new XMLHttpRequest;n.responseType="blob",n.onload=()=>{var t=n.response;this.dataStore&&0<t.size&&this.dataStore.put("images",t,l);var e=window.URL.createObjectURL(t);this.blobCache.set(s,{img:t,url:e}),this.setCacheTimeout(s,this.blobCache,this.clearBlobCacheTimerKeys),r(a,o,t,e)},n.onerror=t=>{console.warn("Error Fetching: "+l),console.warn(t)},n.open("GET",l),n.send()}}runWithCachedImage(t,e,n,i){var r=this.blobCache.get(t);r.img&&r.url?(this.setCacheTimeout(t,this.blobCache,this.clearBlobCacheTimerKeys),i(e,n,r.img,r.url)):setTimeout(()=>{this.runWithCachedImage(t,e,n,i)},50)}getImagePromise(t,n){return new Promise((r,e)=>{try{this.getImage(t,n,(t,e,n,i)=>{r([t,e,n,i])})}catch(t){console.error(t),e()}})}getTileTopLeft(t){var e=t%this.numberOfColumns*this.tileWidth;return[Math.floor(t%this.tilesPerFile/this.numberOfColumns)*this.tileHeight,e]}async getLabel(e,n,i){if(this.imageLabelsMessage){var r=n%this.tilesPerFile*this.tileHeight;let t=Math.floor(n/this.tilesPerFile);var a=[e,t].join("-");this.clearCacheTimeout(this.clearLabelCacheTimerKeys,a),this.labelCache.has(a)?this.runWithCachedLabel(a,r,i):await this.runWithoutCachedLabel(e,a,r,t,i)}else setTimeout(()=>{this.getLabel(e,n,i)},50)}async runWithoutCachedLabel(t,e,n,i,r){this.labelCache.set(e,null);i=`/data/${this.driveId}/label_${t}_${i}.pb`;let a;if(this.dataStore){let t=this.dataStore.transaction("images","readonly").objectStore("images");a=await t.get(i)}a||(a=await o.buffer(i),0<a.byteLength&&await this.dataStore.put("images",a,i));i=this.imageLabelsMessage.decode(new Uint8Array(a));this.labelCache.set(e,i),this.setCacheTimeout(e,this.labelCache,this.clearLabelCacheTimerKeys),r(i,n)}runWithCachedLabel(t,e,n){var i=this.labelCache.get(t);null!==i?(this.setCacheTimeout(t,this.labelCache,this.clearLabelCacheTimerKeys),n(i,e)):setTimeout(()=>{this.runWithCachedLabel(t,e,n)},50)}setCacheTimeout(t,e,n){var i=setTimeout(()=>{e.delete(t),n.delete(t)},this.cacheLifetime);n.set(t,i)}clearCacheTimeout(t,e){t.has(e)&&(clearTimeout(t.get(e)),t.delete(e))}getLabelPromise(e,i){return new Promise((n,t)=>{this.getLabel(e,i,(t,e)=>{n([t,e])})})}static getLabelValue(t,e,n){var i;for(i of n.rowList[t].row)if(i.start<=e&&e<i.start+i.length)return i.label;return 0}}},{d3:42,idb:43,protobufjs:46}],111:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t("./DataEvents");class a{constructor(t=[]){this._attributeList=[],this._length=t.length,this._Array=t,this._minMaxCache=new Map,this._brushList=new Map}get Specification(){return this._Specification}set Specification(t){this._Specification=t}get sourceKey(){return this._sourceKey}set sourceKey(t){this._sourceKey=t}get postfixKey(){return this._postfixKey}set postfixKey(t){this._postfixKey=t}get length(){return this._length}get attributeList(){return 0===this._attributeList.length&&this.initAttributeList(),this._attributeList}get Array(){return 0===this._Array.length&&(this._Array=Array.from(this)),this._Array}get minMaxCache(){return this._minMaxCache}get brushList(){return this._brushList}GetFacetOptions(){if(!this.Specification.locationMaps)return[];let e=[];for(var n of Object.keys(this.Specification.locationMaps)){let t=this.Specification.locationMaps[n];n={name:n,GetFacets:()=>this.getFacetList(t)};e.push(n)}return e}initAttributeList(){var e=[...this];if(0<e.length){let t=e[0];for(var n of t.valueMap.keys())this._attributeList.push(n)}}getMinMax(t){if(this.minMaxCache.has(t))return this.minMaxCache.get(t);let e=1/0,n=-1/0;for(var i of this){i=i.valueMap.get(t);i<e&&(e=i),i>n&&(n=i)}return this.minMaxCache.set(t,[e,n]),[e,n]}addBrush(t,...e){this.addBrushNoUpdate(t,...e),this.updateBrush()}addBrushNoUpdate(t,...e){this.brushList.has(t)||this.brushList.set(t,new Map);let n=this.brushList.get(t);for(var i of e)n.set(i.key,i.bound)}removeBrush(t){this.brushList.delete(t),this.updateBrush()}SetBrushValues(){let t=!1;for(var e of this)for(var n of this.brushList.values())for(var[i,r]of n){r={key:i,bound:r};a.IsInBrush(e,r)||(e.inBrush=!1,t=!0)}return t}static IsInBrush(t,e){var n=t.get(e.key),[t,e]=e.bound;return t<=n&&n<=e&&!isNaN(n)}updateBrush(){var t=new Event(i.DataEvents.brushChange);document.dispatchEvent(t)}}n.PointCollection=a},{"./DataEvents":104}],112:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.PointND=class{constructor(t){for(var e in this._valueMap=new Map,t){var n=+t[e];this._valueMap.set(e,n)}this._inBrush=!0,this._parent=null}get valueMap(){return this._valueMap}get inBrush(){return this._inBrush}set inBrush(t){this._inBrush=t}get parent(){return this._parent}set parent(t){this._parent=t}addValue(t,e){this.valueMap.set(t,e)}get(t){return this.valueMap.get(t)}}},{}],113:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const h=t("./types");n.LayoutFramework=class{constructor(t,e=!0){this._container=t,this._includeBorders=e}get container(){return this._container}get includeBorders(){return this._includeBorders}InitializeLayout(t){var e=new Map;return this.addFrame(this.container,t,e,!0),e}addFrame(t,e,n,i){t.classList.add("frame"),this.includeBorders&&!i&&t.classList.add("with-border");let r,a;e.direction===h.Direction.column?(r="dir-col",a="width"):e.direction===h.Direction.row&&(r="dir-row",a="height"),t.classList.add(r);let o="";if(void 0!==e.minSize&&(o+=`min-${a}: ${e.minSize}; `),void 0!==e.maxSize&&(o+=`max-${a}: ${e.maxSize}; `),e.wrap&&(o+="flex-wrap: wrap; "),e.overflowScroll&&(o+="overflow: auto; "),void 0===e.fraction&&(e.fraction=1),o+=`flex-grow: ${e.fraction}; `,t.setAttribute("style",o),e.inside instanceof Array){var s,l=e.inside[e.inside.length-1];for(s of e.inside){var u=document.createElement("div");t.appendChild(u);var c=s===l;this.addFrame(u,s,n,c)}}else n.set(t,e.inside)}}},{"./types":118}],114:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class o{static BinarySearchIndex(t,e){return 0===t.length?[void 0,void 0]:0<e(t[0])?[void 0,0]:e(t[t.length-1])<0?[t.length-1,void 0]:o.BinarySearchRecurse(t,e,0,t.length-1)}static BinarySearchRecurse(t,e,n,i){if(1===Math.abs(n-i))return[n,i];var r=Math.floor((n+i)/2),a=e(t[r]);return 0===a?r:0<a?o.BinarySearchRecurse(t,e,n,r):a<0?o.BinarySearchRecurse(t,e,r,i):void 0}static compareProperty(e,n){return t=>{t=n(t);return o.compareValues(t,e)}}static sortOnProperty(n,i=!0){return(t,e)=>{t=n(t),e=n(e);return i?o.sortAscend(t,e):o.sortDescend(t,e)}}static sortAscend(t,e){return o.compareValues(t,e)}static sortDescend(t,e){return o.compareValues(e,t)}static compareValues(t,e){let n=t-e;return 0<Math.abs(n)&&(n/=Math.abs(n)),n}}n.DevlibAlgo=o},{}],115:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class i{static sumN(...t){return t.reduce((t,e)=>t+e)}static sum(t){return i.sumN(...t)}static averageN(...t){return i.sum(t)/t.length}static average(t){return i.averageN(...t)}static meanSquaredError(t,e){t=t.map(t=>Math.pow(t-e,2));return i.average(t)}static varianceN(...t){var e=i.average(t);return i.meanSquaredError(t,e)}static variance(t){return i.varianceN(...t)}static randomInt(t,e){return Math.floor(Math.random()*(e+1))}static nChooseTwo(t){return t*(t-1)/2}static isNumber(t){return""!==t&&!isNaN(Number(t))}static clamp(t,[e,n]){return Math.min(Math.max(t,e),n)}}n.DevlibMath=i},{}],116:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class a{static async asyncSetTimeout(e,n){return new Promise(t=>{setTimeout(()=>{e(),t()},n)})}static async makeAsync(t){return a.asyncSetTimeout(t,0)}static getIconButton(t,e,n){let i=document.createElement("button");i.classList.add("basicIconButton");t=a.getFontAwesomeIcon(t);return n&&(n.endsWith(" ")||(n+=" "),i.append(n),i.classList.add("withText")),i.appendChild(t),i.onclick=e,i}static getFontAwesomeIcon(t){let e=document.createElement("i");return e.classList.add("fas"),e.classList.add("fa-"+t),e}static show(t){t.classList.remove("noDisp")}static hide(t){t.classList.add("noDisp")}static launchSpinner(){var r="loadingSpinnerContainer";if(!a.spinnerInDom()){let t=document.createElement("div");t.classList.add("spinnerOuter"),t.id=r;let e=document.createElement("div");e.classList.add("spinnerWrapper");let n=document.createElement("img");n.classList.add("spinner"),n.src="/spinner.gif",e.appendChild(n),t.appendChild(e);let i=document.createElement("a");i.classList.add("attributionLink"),i.href="https://loading.io/asset/442473",i.innerText="icon 'Double Ring' from loading.io",t.appendChild(i),document.body.appendChild(t)}a.spinnerSpinning()||a.show(document.getElementById(r))}static stopSpinner(){var t=document.getElementById("loadingSpinnerContainer");t&&a.hide(t)}static spinnerInDom(){return null!==document.getElementById("loadingSpinnerContainer")}static spinnerSpinning(){let t=document.getElementById("loadingSpinnerContainer");return!(!t||t.classList.contains("noDisp"))}}n.DevlibTSUtil=a},{}],117:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t("d3");var r=t("../src/DataModel/CurveListFactory");const a=t("../src/DataModel/DerivedTrackValueFunctions"),o=t("../src/DataModel/DerivedPointValueFunctions"),s=t("./App");let l=document.querySelector("#metaContainer");n=a.DerivedTrackValueFunctions.GetFunctionList(),t=o.DerivedPointValueFunctions.GetFunctionList();let u=new s.App(l,r.CurveListFactory.CreateCurveListFromPbObject,n,t);window.onresize=()=>u.OnWindowResize(),i.json("/static/layouts/defaultLayout.json").then(async t=>{await u.InitDataStore(),u.InitializeLayout(t);t=l.dataset.dataset;u.LoadDataset(t)})},{"../src/DataModel/CurveListFactory":101,"../src/DataModel/DerivedPointValueFunctions":105,"../src/DataModel/DerivedTrackValueFunctions":106,"./App":82,d3:42}],118:[function(t,e,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),(i=n.Direction||(n.Direction={})).row="row",i.column="col",(i=n.ComponentType||(n.ComponentType={})).Toolbar="Toolbar",i.Plot2dPathsWidget="Plot2dPathsWidget",i.MetricDistributionWidget="MetricDistributionWidget",i.ImageSelectionWidget="ImageSelectionWidget",i.ImageStackWidget="ImageStackWidget",i.DetailedDistribution="DetailedDistribution",(i=n.MetricDistributionSubComponentTypes||(n.MetricDistributionSubComponentTypes={})).BasisSelect="BasisSelect",i.ScatterplotSelect="ScatterplotSelect",i.DistributionPlot="DistributionPlot",i.Scatterplot="Scatterplot",i.Title="Title",(n=n.MetricDistributionCollectionLevel||(n.MetricDistributionCollectionLevel={})).Point="Point",n.Curve="Curve"},{}]},{},[117]);
//# sourceMappingURL=bundle.js.map
